<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Kafka on ‰∏ÄÂ±Ç</title><link>https://emerywan.github.io/blog/tags/kafka/</link><description>Recent content in Kafka on ‰∏ÄÂ±Ç</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 31 Mar 2023 08:08:08 +0800</lastBuildDate><atom:link href="https://emerywan.github.io/blog/tags/kafka/index.xml" rel="self" type="application/rss+xml"/><item><title>Ê∑±ÂÖ• Kafka</title><link>https://emerywan.github.io/blog/p/kafka/more/</link><pubDate>Fri, 31 Mar 2023 08:08:08 +0800</pubDate><guid>https://emerywan.github.io/blog/p/kafka/more/</guid><description>&lt;img src="https://emerywan.github.io/blog/p/kafka/more/kafka.webp" alt="Featured image of post Ê∑±ÂÖ• Kafka" />&lt;h2 id="-Ê∑±ÂÖ•-kafa">ü§ø Ê∑±ÂÖ• Kafa&lt;/h2>
&lt;h3 id="-ÈõÜÁæ§‰∏éÊéßÂà∂Âô®">üõ©Ô∏è ÈõÜÁæ§‰∏éÊéßÂà∂Âô®&lt;/h3>
&lt;p>Kafka ‰ΩøÁî® Zookeeper Êù•Áª¥Êä§ÈõÜÁæ§ÊàêÂëòÁöÑ‰ø°ÊÅØÔºåÊØè‰∏™ Broker ÈÉΩÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÊ†áËØÜÁ¨¶ÔºàÂèØ‰ª•Âú®ÈÖçÁΩÆ‰∏≠ÊåáÂÆöÊàñÈöèÊú∫ÁîüÊàêÔºâÔºåÂú® Broker ÂêØÂä®Êó∂ÔºåÈÄöËøáÂàõÂª∫‰∏¥Êó∂ËäÇÁÇπÂ∞ÜËá™Â∑±ÁöÑ ID Ê≥®ÂÜåÂà∞ Zookeeper„ÄÇ&lt;/p>
&lt;p>ÊéßÂà∂Âô®Êú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™ BrokerÔºåÂ§çÂà∂ÂàÜÂå∫È¢ÜÂØºÁöÑÈÄâ‰∏æÂ∑•‰Ωú„ÄÇÈõÜÁæ§ÁöÑÁ¨¨‰∏Ä‰∏™ÂêØÂä® Broker ÈÄöËøáÂú® Zookeeper ‰∏≠ÂàõÂª∫‰∏Ä‰∏™ /controller ‰∏¥Êó∂ËäÇÁÇπËÆ©Ëá™Â∑±Êàê‰∏∫ÊéßÂà∂Âô®ÔºåÂÖ∂‰ªñ Broker ÂêØÂä®Êó∂ÂÜçÂ∞ùËØïÂàõÂª∫Ôºå‰ºöÊî∂Âà∞ËäÇÁÇπÂ∑≤ÁªèÂ≠òÂú®ÂºÇÂ∏∏Ôºå‰ºöÂú®ÊéßÂà∂Âô®ËäÇÁÇπ‰∏äÂàõÂª∫ Zookeeper watch ÂØπË±°ÔºåÊé•ÂèóËäÇÁÇπÂèòÊõ¥ÈÄöÁü•ÔºåÁ°Æ‰øùÈõÜÁæ§‰∏≠Âè™‰ºöÊúâ‰∏Ä‰∏™ÊéßÂà∂Âô®Â≠òÂú®„ÄÇ&lt;/p>
&lt;h3 id="-Â§çÂà∂">‚úàÔ∏è Â§çÂà∂&lt;/h3>
&lt;p>Â§çÂà∂ÂäüËÉΩÂèØ‰ª•ËÆ© Kafka Âú®‰∏™Âà´ËäÇÁÇπÂ§±ÊïàÊó∂Ôºå‰ªçÁÑ∂‰øùËØÅ Kafka ÁöÑÂèØÁî®ÊÄßÂíåÊåÅ‰πÖÊÄß„ÄÇ&lt;/p>
&lt;p>Kafka ‰ΩøÁî® Topic ÁªÑÁªáÊï∞ÊçÆÔºõÊØè‰∏™ Topic Ë¢´ÂàÜ‰∏∫Ëã•Âπ≤‰∏™ PartitionÔºõÊØè‰∏™ Partition ÊúâÂ§ö‰∏™ÂâØÊú¨ÔºåË¢´‰øùÂ≠òÂú® Broker ‰∏ä„ÄÇÂâØÊú¨Êúâ‰∏§ÁßçÁ±ªÂûãÔºö&lt;/p>
&lt;ul>
&lt;li>
&lt;p>È¶ñÈ¢ÜÂâØÊú¨ &lt;code>leader&lt;/code>&lt;/p>
&lt;p>ÊØè‰∏™ Partition ÈÉΩÊúâ‰∏Ä‰∏™È¶ñÈ¢ÜÂâØÊú¨„ÄÇ‰∏∫‰∫Ü‰øùËØÅ‰∏ÄËá¥ÊÄßÔºåÈ¶ñÈ¢ÜÂâØÊú¨Â§çÂà∂ÊâÄÊúâÁöÑ Áîü‰∫ß &amp;amp; Ê∂àË¥πËØ∑Ê±Ç„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÂêåÊ≠•ÂâØÊú¨ &lt;code>follower&lt;/code>&lt;/p>
&lt;p>ÂêåÊ≠•ÂâØÊú¨‰∏çÂ§ÑÁêÜ‰ªª‰ΩïËØ∑Ê±ÇÔºåÂîØ‰∏ÄÁöÑ‰ªªÂä°Â∞±ÊòØ‰ªé Leader Â§çÂà∂Ê∂àÊÅØÔºå‰øùÊåÅ‰∏é leader ‰∏ÄËá¥ÁöÑÁä∂ÊÄÅ„ÄÇfollower Âêë leader ÂèëÈÄÅËé∑ÂèñÊï∞ÊçÆÁöÑËØ∑Ê±ÇÔºà‰∏éÊ∂àË¥πËÄÖËé∑ÂèñÊï∞ÊçÆÁöÑËØ∑Ê±ÇÁõ∏ÂêåÔºâÔºåleader Â∞ÜÊ∂àÊÅØÂìçÂ∫îÂèëÈÄÅÁªô followerÔºåÂåÖÂê´ÊåáÂÆöÂÅèÁßªÈáèÁöÑÊ∂àÊÅØÔºàÊúâÂ∫èÔºâ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-Â§ÑÁêÜËØ∑Ê±Ç">üõ´ Â§ÑÁêÜËØ∑Ê±Ç&lt;/h3>
&lt;p>Broker Â§ÑÁêÜÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±ÇÂπ∂ÂÅöÂá∫ÂìçÂ∫îÔºå‰ºöÊåâÁÖßËØ∑Ê±ÇËææÂà∞ÁöÑÈ°∫Â∫èËøõË°åÂ§ÑÁêÜÔºåËøôÁßç„ÄåÈ°∫Â∫èÊÄß‰øùËØÅËÆ© Kafka ÂÖ∑Â§á‰∫ÜÊ∂àÊÅØÈòüÂàóÁöÑÁâπÊÄß„ÄÇ„Äç&lt;/p>
&lt;p>Broker ‰ºöÂú®ÂÆÉÊâÄÁõëÂê¨ÁöÑÊØè‰∏Ä‰∏™Á´ØÂè£‰∏äËøêË°å‰∏Ä‰∏™ &lt;code>Acceptor&lt;/code> Á∫øÁ®ãÔºåÁõëÂê¨Âà∞ËææÁöÑËøûÊé•ÔºàIOÂ§öË∑ØÂ§çÁî®ÔºâÔºõÂΩìËØ∑Ê±ÇËææÂà∞Êó∂Ôºå‰ºöÂà©Áî® n ‰∏™ &lt;code>Processor&lt;/code> Á∫øÁ®ãËøõË°åÂ§ÑÁêÜÔºåÂ§çÂà∂‰ªéÂÆ¢Êà∑Á´ØËé∑ÂèñËØ∑Ê±ÇÊ∂àÊÅØÔºåÂπ∂ÊîæÂÖ•ËØ∑Ê±ÇÈòüÂàóÔºõÊîæÂÖ•ËØ∑Ê±ÇÈòüÂàóÁöÑÊ∂àÊÅØÔºå‰ºöÊúâ m ‰∏™ &lt;code>Handler&lt;/code> Á∫øÁ®ãËøõË°åÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/more/thread.png"
width="856"
height="299"
srcset="https://emerywan.github.io/blog/blog/p/kafka/more/thread_hua0b819faaccb7b1eb257047290f83afd_30393_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/more/thread_hua0b819faaccb7b1eb257047290f83afd_30393_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="286"
data-flex-basis="687px"
>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ÂÖÉÊï∞ÊçÆËØ∑Ê±Ç&lt;/p>
&lt;p>ÂÆ¢Êà∑Á´Ø‰ΩøÁî®„ÄåÂÖÉÊï∞ÊçÆËØ∑Ê±Ç„ÄçÔºåËé∑ÂèñÊâÄÊúâ‰∏ªÈ¢òÂàóË°®ÔºàÂàÜÂå∫„ÄÅÈ¶ñÈ¢Ü„ÄÅÂâØÊú¨Á≠âÊâÄÊúâ‰ø°ÊÅØÔºâÔºåÂπ∂Â∞ÜËøô‰∫õ‰ø°ÊÅØÁºìÂ≠òËµ∑Êù•Ôºå‰ª•Ê≠§Áü•ÈÅìÂêëÂì™ÈáåÂèëÈÄÅËØ∑Ê±Ç„ÄÇ&lt;/p>
&lt;p>ÂÖÉÊï∞ÊçÆËØ∑Ê±Ç‰ºöÂÆöÊó∂/ÈÅáÂà∞ÈîôËØØÊó∂ÔºåÂÆöÊó∂Âà∑Êñ∞„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Áîü‰∫ßËØ∑Ê±Ç&lt;/p>
&lt;p>Kafka ‰ΩøÁî® &lt;code>acks = 0/1/all&lt;/code> ÂÆ¢Êà∑Á´ØÈÖçÁΩÆÔºåÊåáÂÆö‰∫ÜÈúÄË¶ÅÂ§öÂ∞ë‰∏™ Broker Á°ÆËÆ§ÊâçÂèØ‰ª•ËÆ§‰∏∫‰∏Ä‰∏™Ê∂àÊÅØÊòØÂÜôÂÖ•ÊàêÂäüÁöÑ„ÄÇ&lt;/p>
&lt;p>Ê∂àÊÅØË¢´ Broker ÂÜôÂÖ•Êú¨Âú∞Á£ÅÁõò„ÄÇÂú® Linux Á≥ªÁªü‰∏äÔºåÊ∂àÊÅØ‰ºöË¢´ÂÜôÂà∞Êñá‰ª∂Á≥ªÁªüÁºìÂ≠ò Page Cache ÈáåÔºåÂπ∂‰∏ç‰øùËØÅ‰ªÄ‰πàÊòØÂê¶‰ºöË¢´Âà∑Êñ∞Âà∞Á£ÅÁõò‰∏ä„ÄÇKafka ‰æùËµñÂ§çÂà∂ÂäüËÉΩ‰øùÈöúÊ∂àÊÅØÁöÑÊåÅ‰πÖÊÄß„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ê∂àË¥πËØ∑Ê±Ç&lt;/p>
&lt;p>Consumer Âêë Broker ÂèëÈÄÅËØ∑Ê±ÇÔºå‰ªé‰∏ªÈ¢òÂàÜÂå∫ÈáåËé∑ÂèñÁâπÂÆöÂÅèÁßªÈáèÁöÑÊ∂àÊÅØÔºåÁ±ª‰ºº‰∫éËØ¥Ôºö‚ÄúËØ∑Êää‰∏ªÈ¢ò Test ÂàÜÂå∫ 0 ÂÅèÁßªÈáè‰ªé 53 ÂºÄÂßãÁöÑÊ∂àÊÅØÂèëÁªôÊàë‚Äù&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÂÖ∂‰ªñËØ∑Ê±Ç&lt;/p>
&lt;p>Âú®ÊóßÁâàÊú¨ÁöÑ Kafka ‰∏≠ÔºåÊ∂àË¥πËÄÖ‰ΩøÁî® Zookeeper Êù•Ë∑üË∏™ÂÅèÁßªÈáèÔºåÂú®Ê∂àË¥πËÄÖÂêØÂä®ÁöÑÊó∂ÂÄôÔºåÈÄöËøáÊ£ÄÊü•‰øùÊåÅÂú® Zookeeper ‰∏äÁöÑÂÅèÁßªÈáèÁü•ÈÅì‰ªéÂì™ÈáåÂºÄÂßãÂ§ÑÁêÜÊ∂àÊÅØ„ÄÇ&lt;/p>
&lt;p>Âú®Êñ∞ÁâàÊú¨‰∏≠ÔºåÂÅèÁßªÈáè offset ‰øùÂ≠òÂú®ÁâπÂÆöÁâàÊú¨ÁöÑ Kafka ‰∏ªÈ¢ò &lt;code>__consumer_offset&lt;/code> ‰∏ä„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-Áâ©ÁêÜÂ≠òÂÇ®">üí∫ Áâ©ÁêÜÂ≠òÂÇ®&lt;/h3>
&lt;p>Kafka ÁöÑÂü∫Êú¨Â≠òÂÇ®ÂçïÂÖÉÊòØÂàÜÂå∫ Partition„ÄÇ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Êñá‰ª∂ÁÆ°ÁêÜ&lt;/p>
&lt;p>‰øùÁïôÊï∞ÊçÆÊòØ Kafka ÁöÑ‰∏Ä‰∏™Âü∫Êú¨ÁâπÊÄßÔºåKafka ‰∏ç‰ºö‰∏ÄÁõ¥‰øùÁïôÊï∞ÊçÆÔºå‰πü‰∏ç‰ºöÁ≠âÂà∞ÊâÄÊúâÁöÑÊï∞ÊçÆÈÉΩÊ∂àË¥πÂÆåÊâçÂà†Èô§„ÄÇKafka ÂèØ‰ª•‰∏∫ÊØè‰∏™‰∏ªÈ¢òÈÖçÁΩÆÊï∞ÊçÆÁöÑ‰øùÁïôÊúüÈôêÔºåËßÑÂÆöÊï∞ÊçÆÂú®Âà†Èô§‰πãÂâçÂèØ‰ª•‰øùÁïôÂ§öÈïøÊó∂Èó¥ÔºåÊàñËÄÖÊ∏ÖÁêÜÊï∞ÊçÆ‰πãÂâçÂèØ‰ª•‰øùÁïôÁöÑÊï∞ÊçÆÂ§ßÂ∞è„ÄÇ&lt;/p>
&lt;p>Kafka ‰øùÂ≠òÁöÑÊï∞ÊçÆÈÄöÂ∏∏ÈÉΩÊòØÂæàÂ∫ûÂ§ßÁöÑÔºåÂú®‰∏Ä‰∏™Â§ßÊñá‰ª∂‰∏≠Êü•ÊâæÂíåÂà†Èô§Ê∂àÂ§±ÊòØÂæàË¥πÊó∂ÁöÑÔºå‰πüÂæàÂÆπÊòìÂá∫ÈîôÔºåÊâÄ‰ª•‰ºöÊääÊØè‰∏™ÂàÜÂå∫ÂàÜÊàêËã•Âπ≤‰∏™„ÄåÁâáÊÆµ„Äç&lt;code>Partition -&amp;gt; Segment&lt;/code>„ÄÇ
Âú® Broker Âêë Partition ÂÜôÂÖ•Êï∞ÊçÆÊó∂ÔºåÂ¶ÇÊûúËææÂà∞‰∏äÈôêÔºåÂ∞±ÂÖ≥Èó≠ÂΩìÂâçÊñá‰ª∂ÔºåÂπ∂ÊâìÂºÄ‰∏Ä‰∏™Êñ∞Êñá‰ª∂„ÄÇ&lt;/p>
&lt;p>ÂΩìÂâçÊ≠£Âú®ÂÜôÂÖ•Êï∞ÊçÆÁöÑÁâáÊÆµÂè´ÂÅöÊ¥ªË∑ÉÁâáÊÆµÔºå„ÄåÊ¥ªË∑ÉÁâáÊÆµÊ∞∏Ëøú‰∏ç‰ºöË¢´Âà†Èô§„Äç„ÄÇÔºàÂç≥‰ΩøÊ¥ªË∑ÉÁâáÊÆµ‰∏≠ÁöÑÊ∂àÊÅØË∂ÖËøá‰∫Ü‰øùÁïôÊó∂Èó¥ÔºåÁâáÊÆµÂú®Ë¢´ÂÖ≥Èó≠‰πãÂâçÊó†Ê≥ïË¢´Âà†Èô§Ôºâ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Êñá‰ª∂Ê†ºÂºè&lt;/p>
&lt;p>Kafka ÊääÊ∂àÊÅØÂíåÂÅèÁßªÈáè‰øùÂ≠òÂú®Êñá‰ª∂ÈáåÔºå‰øùÂ≠òÂú®Á£ÅÁõò‰∏äÁöÑÊï∞ÊçÆÊ†ºÂºè‰∏é‰ªéÁîü‰∫ßËÄÖÂèëÈÄÅÊù•ÊàñÂèëÈÄÅÁªôÊ∂àË¥πËÄÖÁöÑÊï∞ÊçÆÊ†ºÂºèÊòØ‰∏ÄÊ†∑ÁöÑÔºåKafka ‰∏ç‰ºöËøõË°åÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;p>Áîü‰∫ßËÄÖÂèëÈÄÅÁöÑÊòØË¢´ÂéãÁº©ËøáÁöÑÊ∂àÊÅØÔºåÂêå‰∏Ä‰∏™ÊâπÊ¨°ÁöÑÊ∂àÊÅØ‰ºöË¢´ÂéãÁº©Âú®‰∏ÄËµ∑ÔºåÂèëÈÄÅÁªô BrokerÔºåÁÑ∂Âêé Broker ÂÜçÂèëÈÄÅÁªôÊ∂àË¥πËÄÖ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/more/message.png"
width="897"
height="349"
srcset="https://emerywan.github.io/blog/blog/p/kafka/more/message_hu5179d63639435460e9b73156324f1016_483489_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/more/message_hu5179d63639435460e9b73156324f1016_483489_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="257"
data-flex-basis="616px"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Á¥¢Âºï&lt;/p>
&lt;p>Kafka ÁªôÊØè‰∏™ÂàÜÂå∫ÈÉΩÁª¥Êä§‰∫Ü‰∏Ä‰∏™Á®ÄÁñèÁöÑÂìàÂ∏åÁ¥¢ÂºïÔºåÊääÂÅèÁßªÈáèÊò†Â∞ÑÂà∞ÁâáÊÆµÊñá‰ª∂ÂíåÂÅèÁßªÈáèÂú®Êñá‰ª∂ÈáåÁöÑ‰ΩçÁΩÆ„ÄÇ&lt;/p>
&lt;p>Á¥¢ÂºïÂíå Partition ‰∏ÄÊ†∑Ë¢´ÂàÜ‰∏∫ÁâáÊÆµÔºåÊâÄ‰ª•Âú®Âà†Èô§Ê∂àÊÅØÊó∂Ôºå‰πü‰ºöÂà†Èô§Áõ∏Â∫îÁöÑÁ¥¢Âºï„ÄÇ&lt;/p>
&lt;p>Kafka ‰∏ç‰ºöÁª¥Êä§Á¥¢ÂºïÁöÑÊ†°È™åÂíåÔºåÁ¥¢ÂºïÂá∫Áé∞ÊçüÂùèÔºåÊàñÂà†Èô§‰∫ÜÁ¥¢ÂºïÔºàÂÆåÂÖ®ÂÆâÂÖ®ÔºâÔºåKafka ÈÉΩ‰ºöËá™Âä®ÈáçÊñ∞ÁîüÊàêÁ¥¢Âºï„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="-ÂèØÈù†Êï∞ÊçÆ‰º†ÈÄí">üëå ÂèØÈù†Êï∞ÊçÆ‰º†ÈÄí&lt;/h2>
&lt;p>Kafka ÁöÑÂèØÈù†ÊÄßÂπ∂‰∏çÊòØÂçïÊñπÈù¢ÁöÑ‰∫ãÊÉÖÔºåÂ∫îËØ•‰ªéÊï¥‰∏™Á≥ªÁªüÂ±ÇÈù¢Êù•ËÄÉËôëÂèØÈù†ÊÄßÁöÑÈóÆÈ¢òÔºåÂ¶ÇÂ∫îÁî®Êû∂ÊûÑ„ÄÅÁîü‰∫ßËÄÖÊ∂àË¥πËÄÖÁöÑÈÖçÁΩÆ„ÄÅ‰∏ªÈ¢òÈÖçÁΩÆ„ÄÅBroker ÈÖçÁΩÆ„ÄÇ&lt;/p>
&lt;p>Á≥ªÁªüÁöÑÂèØÈù†ÊÄßÈúÄË¶ÅÂú®ËÆ∏Â§öÊñπÈù¢ÂÅöÂá∫ÊùÉË°°ÔºåÂ¶ÇÂ§çÊùÇÊÄß„ÄÅÂèØÁî®ÊÄß„ÄÅÁ£ÅÁõòÁ©∫Èó¥‰ΩøÁî®Á≠â„ÄÇ&lt;/p>
&lt;h3 id="-ÂèØÈù†ÊÄß‰øùËØÅ">üöó ÂèØÈù†ÊÄß‰øùËØÅ&lt;/h3>
&lt;p>ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì‰ΩøÁî® &lt;code>ACID&lt;/code> Êú∫Âà∂Êù•‰øùÈöúÊï∞ÊçÆÁöÑÂèØÈù†ÊÄß„ÄÇ‰∏Ä‰∏™Á≥ªÁªüÁöÑ‰øùËØÅÊú∫Âà∂ÂØπ‰∫éÊûÑÂª∫ÂèØÈù†ÁöÑÂ∫îÁî®Á®ãÂ∫èÊù•ËØ¥Ëá≥ÂÖ≥ÈáçË¶Å„ÄÇ
Kafka ÂèØ‰ª•ÂÜç‰ª•‰∏ãÊñπÈù¢‰ΩúÂá∫‰øùËØÅÔºö&lt;/p>
&lt;ul>
&lt;li>
&lt;p>üõ∏ Kafka ÂèØ‰ª•‰øùËØÅ ÂàÜÂå∫ Partition Ê∂àÊÅØÁöÑÈ°∫Â∫è„ÄÇ&lt;/p>
&lt;p>‰ΩøÁî®Âêå‰∏Ä‰∏™Áîü‰∫ßËÄÖÂæÄÂêå‰∏Ä‰∏™ÂàÜÂå∫ÂÜôÂÖ•Ê∂àÊÅØ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>üõ∏ Âè™ÊúâÂΩìÊ∂àÊÅØË¢´ÂÜôÂÖ•ÂàÜÂå∫ÁöÑÊâÄÊúâÂêåÊ≠•ÂâØÊú¨Êó∂Ôºà‰∏ç‰∏ÄÂÆöË¶ÅÂÜôÂÖ•Á£ÅÁõòÔºâÔºåÊ∂àÊÅØÊâçË¢´ËÆ§‰∏∫ÊòØ‚ÄúÂ∑≤Êèê‰∫§‚ÄúÁöÑ„ÄÇ&lt;/p>
&lt;p>Áîü‰∫ßËÄÖÂèØ‰ª•ÈÄâÊã©Êé•Êî∂‰∏çÂêåÁ±ªÂûãÁöÑÁ°ÆËÆ§ÔºàacksÔºâ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>üõ∏ Âè™Ë¶ÅËøòÊúâ‰∏Ä‰∏™ÂâØÊú¨ÊòØÊ¥ªË∑ÉÁöÑÔºåÂ∑≤Êèê‰∫§ÁöÑÊ∂àÊÅØÂ∞±‰∏ç‰ºö‰∏¢Â§±„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>üõ∏ Ê∂àË¥πËÄÖÂè™ËÉΩËØªÂèñÂà∞Â∑≤Êèê‰∫§ÁöÑÊ∂àÊÅØ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá Kafka ÁöÑÁõ∏ÂÖ≥ÈÖçÁΩÆÂèÇÊï∞ÔºåÂØπÊâÄÈúÄË¶ÅÁöÑÂèØÈù†ÊÄßÂÅöÂá∫„ÄåÊùÉË°°„ÄçÔºöÊ∂àÊÅØÁöÑ„ÄåÂèØÈù†ÊÄß„ÄÅ‰∏ÄËá¥ÊÄß„ÄçÁöÑÈáçË¶ÅÁ®ãÂ∫¶‰∏é„ÄåÂèØÁî®ÊÄß„ÄÅÈ´òÂêûÂêêÈáè„ÄÅ‰ΩéÂª∂Ëøü„ÄÅÁ°¨‰ª∂ÊàêÊú¨„ÄçÁöÑÈáçË¶ÅÊÄß‰πãÈó¥ÁöÑÊùÉË°°„ÄÇ&lt;/p>
&lt;h3 id="-Â§çÂà∂ÁöÑÂèØÈù†">üöì Â§çÂà∂ÁöÑÂèØÈù†&lt;/h3>
&lt;p>Kafka ÁöÑÂ§çÂà∂Êú∫Âà∂ÂíåÂàÜÂå∫ÂâØÊú¨Êû∂ÊûÑÊòØ Kafka ÂèØÈù†ÊÄß‰øùËØÅÁöÑÊ†∏ÂøÉ„ÄÇ&lt;/p>
&lt;p>ÊääÊ∂àÊÅØÂÜôÂÖ•Â§ö‰∏™ÂâØÊú¨ÂèØ‰ª•‰Ωø Kafka Âú®ÂèëÁîüÂ¥©Ê∫ÉÊó∂Ôºå‰øùËØÅÊ∂àÊÅØÁöÑ„ÄåÊåÅ‰πÖÊÄß„Äç„ÄÇ&lt;/p>
&lt;p>Kafka ÁöÑ‰∏ªÈ¢ò Topic Ë¢´ÂàÜ‰∏∫Â§ö‰∏™ÂàÜÂå∫ PartitionÔºåÂàÜÂå∫ÊòØÊúÄÂü∫Êú¨ÁöÑÊï∞ÊçÆÂùó„ÄÇÂàÜÂå∫ÂèØ‰ª•ÊúâÂ§ö‰∏™ÂâØÊú¨ÔºåÂåÖÂê´‰∏Ä‰∏™È¶ñÈ¢Ü leader ÂíåÂ§ö‰∏™ÂêåÊ≠•ÂâØÊú¨ followerÔºåleader Ë¥üË¥£ËØª&amp;amp;ÂÜô‰∫ã‰ª∂ÔºåÂÖ∂‰ªñÂâØÊú¨Âè™ÈúÄË¶Å‰∏éÈ¶ñÈ¢Ü‰øùÊåÅÂêåÊ≠•ÔºåÂπ∂ÂèäÊó∂Â§çÂà∂ÊúÄÊñ∞ÁöÑ‰∫ã‰ª∂„ÄÇ&lt;/p>
&lt;h3 id="-broker-ÁöÑÂèØÈù†">üöï Broker ÁöÑÂèØÈù†&lt;/h3>
&lt;p>Broker Êúâ &lt;code>3&lt;/code> ‰∏™ÈÖçÁΩÆÂèÇÊï∞‰ºöÂΩ±Âìç Kafka Â≠òÂÇ®Ê∂àÊÅØÁöÑÂèØÈù†ÊÄß„ÄÇÔºàÂèØ‰ª•Â∫îÁî®Âú® broker Á∫ßÂà´ÔºåÊéßÂà∂ÊâÄÊúâ‰∏ªÈ¢òÁöÑË°å‰∏∫Ôºõ‰πüÂèØ‰ª•ÂçïÁã¨Â∫îÁî®Âú® Topic Á∫ßÂà´ÔºåÊéßÂà∂Âçï‰∏™‰∏ªÈ¢òÔºâ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>‚úíÔ∏è Â§çÂà∂Á≥ªÊï∞&lt;/p>
&lt;ul>
&lt;li>Broker Á∫ßÂà´Ôºö&lt;code>default.replication.factor&lt;/code>&lt;/li>
&lt;li>Topic Á∫ßÂà´Ôºö&lt;code>replication.factor&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Â§çÂà∂Á≥ªÊï∞Ë°®Á§∫ËØ• Topic ÁöÑ Partition ‰ºöË¢´Âá†‰∏™‰∏çÂêåÁöÑ Broker Â§çÂà∂„ÄÇ&lt;/p>
&lt;p>Â¶ÇÊûúÂ§çÂà∂Á≥ªÊï∞‰∏∫ NÔºåÂΩìÊúâ N-1 ‰∏™ Broker Â§±ÊïàÊó∂Ôºå‰ªçÁÑ∂ÂèØ‰ª•‰ªé Topic ËØªÂèñÊàñÂÜôÂÖ•Êï∞ÊçÆ„ÄÇ&lt;/p>
&lt;p>Êõ¥È´òÁöÑÂ§çÂà∂Á≥ªÊï∞ËÉΩÂ§üÂ∏¶Êù•Êõ¥È´òÁöÑÂèØÁî®ÊÄß„ÄÅÂèØÈù†ÊÄßÂíåÊõ¥Â∞ëÁöÑÊïÖÈöúÔºå‰ΩÜ‰ºöÂç†Áî®ÊàêÂÄçÁöÑÂ≠òÂÇ®Á©∫Èó¥ÔºåÈúÄË¶ÅÂú®ÂèØÁî®ÊÄßÂíåÂ≠òÂÇ®Á°¨‰ª∂Èó¥ÂÅöÂá∫Âπ≥Ë°°„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>‚úíÔ∏è ‰∏çÂÆåÂÖ®ÁöÑÈ¶ñÈ¢ÜÈÄâ‰∏æ&lt;/p>
&lt;ul>
&lt;li>Âè™Êúâ Broker Á∫ßÂà´ÔºåÈªòËÆ§‰∏∫ true Ôºö&lt;code>unclean.leader.election = true&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Âú®ÈÄâ‰∏æËøáÁ®ã‰∏≠Ê≤°Êúâ‰∏¢Â§±Êï∞ÊçÆÔºåËøô‰∏™ÈÄâ‰∏æÂ∞±ÊòØ‚ÄùÂÆåÂÖ®‚ÄúÁöÑÔºàÊèê‰∫§ÁöÑÊï∞ÊçÆÂêåÊó∂Â≠òÂú®‰∫éÊâÄÊúâÂêåÊ≠•ÂâØÊú¨‰∏äÔºâ„ÄÇ&lt;/p>
&lt;p>Â¶ÇÊûúËÆæÁΩÆ‰∏∫ trueÔºåÂÖÅËÆ∏‰∏çÂêåÊ≠•ÁöÑÂâØÊú¨Êàê‰∏∫È¶ñÈ¢ÜÔºåÈúÄË¶ÅÊâøÊãÖÊï∞ÊçÆ‰∏ç‰∏ÄËá¥Êàñ‰∏¢Â§±Êï∞ÊçÆÁöÑÈ£éÈô©„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>‚úíÔ∏è ÊúÄÂ∞ëÁöÑÂêåÊ≠•ÂâØÊú¨&lt;/p>
&lt;ul>
&lt;li>Broker / Topic Á∫ßÂà´Ôºö&lt;code>min.insync.replicas&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Ê∂àÊÅØÂè™ÊúâÂú®Ë¢´ÂÜôÂÖ•Âà∞ÊâÄÊúâÂêåÊ≠•ÂâØÊú¨‰πãÂêéÊâçË¢´ËÆ§‰∏∫ÊòØÂ∑≤Êèê‰∫§ÁöÑ„ÄÇ&lt;/p>
&lt;p>ÂΩì‰∏çÊª°Ë∂≥ÊúÄÂ∞ëÂêåÊ≠•ÂâØÊú¨Êó∂Ôºå‰ºöÂÅúÊ≠¢Êé•ÂèóÁîü‰∫ßËÄÖËØ∑Ê±ÇÔºåÂèòÊàêÂè™ËØªÁä∂ÊÄÅ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-Áîü‰∫ßËÄÖÁöÑÂèØÈù†">üõ∫ Áîü‰∫ßËÄÖÁöÑÂèØÈù†&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>üß≤ ÂèëÈÄÅÁ°ÆËÆ§&lt;/p>
&lt;p>‰∏âÁßçÁ°ÆËÆ§Ê®°ÂºèÔºö&lt;code>acks&lt;/code>: ÊåáÂÆö‰∫ÜÂøÖÈ°ªË¶ÅÊúâÂ§öÂ∞ë‰∏™ÂàÜÂå∫ÂâØÊú¨Êî∂Âà∞Ê∂àÊÅØÔºåÁîü‰∫ßËÄÖÊâç‰ºö‰ªªÂä°Ê∂àÊÅØÂÜôÂÖ•Êó∂ÊàêÂäüÁöÑ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>acks=0&lt;/code> ‰∏ç‰ºöÁ≠âÂæÖ‰ªªÂä°Êù•Ëá™ÊúçÂä°Âô®ÁöÑÂìçÂ∫î„ÄÇËææÂà∞ÊúÄÈ´òÁöÑÂêûÂêêÈáèÔºåÊó†Ê≥ïÂæóÁü•Ê∂àÊÅØÁä∂ÊÄÅ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>acks=1&lt;/code> Âè™Ë¶Å Partition Leader Êî∂Âà∞ÂìçÂ∫î„ÄÇÊ∂àÊÅØÂèØËÉΩ‰ºö‰∏¢Â§±ÔºåLeaderÂÆïÊú∫ÂêéÔºå‰∏Ä‰∏™Êú™ÂêåÊ≠•ÁöÑFllowerÊàê‰∏∫Êñ∞ÁöÑLeader„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>acks=all&lt;/code> Ê∂àÊÅØË¶ÅÂÖ®ÈÉ®ÂêåÊ≠•Âà∞ÊâÄÊúâÁöÑ Leader&amp;amp;Fllower„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>üß≤ ÈÖçÁΩÆÈáçËØïÂèÇÊï∞&lt;/p>
&lt;p>Áîü‰∫ßËÄÖÂêë Broker ÂèëÈÄÅÊ∂àÂ§±Êó∂Ôºå‰ºöËøîÂõû‰∏Ä‰∏™ÊàêÂäü/ÈîôËØØÂìçÂ∫îÁ†Å„ÄÇÂ¶ÇÊûú Broker ËøîÂõûÁöÑÈîôËØØÂèØ‰ª•ÈÄöËøá„ÄåÈáçËØï„ÄçÊù•Ëß£ÂÜ≥ÔºåÁîü‰∫ßËÄÖ‰ºöËá™Âä®Â§ÑÁêÜËøô‰∫õÈîôËØØ„ÄÇ&lt;/p>
&lt;p>ÈîôËØØÂìçÂ∫îÁ†ÅÂèØ‰ª•ÂàÜ‰∏∫‰∏§ÁßçÔºöÔºà1ÔºâÈáçËØï‰πãÂêéÂèØ‰ª•Ëß£ÂÜ≥ÁöÑÔºåÂèØÈáçËØïÈîôËØØ &lt;code>LEADER_NOT_AVAILABLE&lt;/code> Ôºà2ÔºâÊó†Ê≥ïÈÄöËøáÈáçËØïËß£ÂÜ≥ÁöÑÔºå‰∏çÂèØÈáçËØïÈîôËØØ &lt;code>INVALID_CONFIG&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Â¶ÇÊûúÊÉ≥Êäì‰ΩèÂºÇÂ∏∏Âπ∂Â§öÈáçËØïÂá†Ê¨°ÔºåÂèØ‰ª•Â∞ÜÈáçËØïÊ¨°Êï∞ËÆæÁΩÆÂ§ö‰∏ÄÁÇπÔºåËÆ©Áîü‰∫ßËÄÖÈáçËØï&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Â¶ÇÊûúÊÉ≥‰∏¢ÂºÉÊï∞ÊçÆÔºåÈáçËØïÂèÇÊï∞ÊØ´Êó†ÊÑè‰πâ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Â¶ÇÊûúÊÉ≥‰øùÂ≠òÊ∂àÊÅØÂà∞Êüê‰∏™Âú∞ÊñπÔºåÂêéÁª≠ËøõË°åÂ§ÑÁêÜÔºåÂèØ‰ª•ÂÅúÊ≠¢ÈáçËØï&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>‚ö†Ô∏è ÈáçËØï‰ºöÂ∏¶Êù•Ê∂àÊÅØÈáçÂ§çÁöÑÈ£éÈô©ÔºåÂèØ‰ª•Âú®Â∫îÁî®‰∏≠ÂêëÊ∂àÊÅØ‰∏≠Âä†ÂÖ•ÂîØ‰∏ÄÊ†áËØÜÁ¨¶ÔºåÁî®‰∫éÊ£ÄÊµãÈáçÂ§çÊ∂àÊÅØÔºàÊñ∞Áâà Kafka ËÉΩÂ§üËá™Âä®Â§ÑÁêÜÔºâÔºåÊ∂àË¥πËÄÖÂú®ËØªÂèñÊó∂ËøõË°åÊ∏ÖÁêÜÔºõÂú®‰∏öÂä°‰∏ä‰πüÂèØ‰ª•ÂÆûÁé∞ÂπÇÁ≠âÔºåÂç≥‰ΩøÂá∫Áé∞ÈáçÂ§çÊ∂àÊÅØÔºåÂØπÁªìÊûúÁöÑÂ§ÑÁêÜ‰πü‰∏ç‰ºöÈÄ†ÊàêË¥üÈù¢ÂΩ±Âìç„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>üß≤ È¢ùÂ§ñÁöÑÈîôËØØÂ§ÑÁêÜ&lt;/p>
&lt;p>ÈîôËØØÂ§ÑÁêÜÂô®ÁöÑ‰ª£Á†ÅÈÄªËæë‰∏éÂÖ∑‰ΩìÁöÑÂ∫îÁî®Á®ãÂ∫èÂèäÂÖ∂ÁõÆÊ†áÊúâÂÖ≥ÔºåÊ†πÊçÆÂÖ∑‰ΩìÁöÑÊû∂ÊûÑÂÜ≥ÂÆö„ÄÇÔºà‰∏¢ÂºÉÔºüËÆ∞ÂΩïÈîôËØØÔºü‰øùÂ≠òÂà∞Á£ÅÁõòÔºüÂõûË∞ÉÂè¶‰∏Ä‰∏™Â∫îÁî®ÔºüÔºâ&lt;/p>
&lt;p>Â¶ÇÊûúÈîôËØØÂ§ÑÁêÜÂè™ÊòØ‰∏∫‰∫ÜÈáçËØïÂèëÈÄÅÊ∂àÊÅØÔºåÊúÄÂ•ΩËøòÊòØ‰ΩøÁî®Áîü‰∫ßËÄÖÂÜÖÁΩÆÁöÑÈáçËØïÊú∫Âà∂„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-Ê∂àË¥πËÄÖÁöÑÂèØÈù†">üöô Ê∂àË¥πËÄÖÁöÑÂèØÈù†&lt;/h3>
&lt;p>Âè™ÊúâË¢´ÂÜôÂÖ•ÊâÄÊúâÂêåÊ≠•ÂâØÊú¨ÁöÑÊï∞ÊçÆÔºåÂØπÊ∂àË¥πËÄÖÊâçÊòØÂèØÁî®ÁöÑÔºåÊ∂àË¥πËÄÖÂæóÂà∞ÁöÑÊ∂àÊÅØÂ∑≤ÁªèÂÖ∑Â§á‰∫Ü‰∏ÄËá¥ÊÄß„ÄÇ&lt;/p>
&lt;p>Ê∂àË¥πËÄÖÈúÄË¶ÅÂÅöÁöÑÊòØË∑üË∏™Âì™‰∫õÊ∂àÊÅØÂ∑≤ÁªèËØªÂèñËøáÔºåÂì™‰∫õÊòØËøòÊ≤°ÊúâËØªÂèñËøáÁöÑÔºåÊòØÂú®ËØªÂèñÊ∂àÂ§±Êó∂‰∏ç‰∏¢Â§±Ê∂àÊÅØÁöÑÂÖ≥ÈîÆ„ÄÇ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>üìê Êèê‰∫§È¢ëÁéáÔºàÊòØÊÄßËÉΩÂíåÈáçÂ§çÊ∂àÊÅØ‰πãÈó¥ÁöÑÊùÉË°°Ôºâ&lt;/p>
&lt;p>ÂèØ‰ª•Âú®ËΩÆËØ¢ÂêéÁª¥Êä§Áä∂ÊÄÅÔºå‰πüÂèØ‰ª•Âú®‰∏Ä‰∏™Âæ™ÁéØÈáåÂ§öÊ¨°Êèê‰∫§ÂÅèÁßªÈáèÔºåÂÆåÂÖ®ÂèñÂÜ≥‰∫éÊÄßËÉΩÂíåÈáçÂ§çÂ§ÑÁêÜÊ∂àÊÅØ‰πãÈó¥ÂÅöÂá∫ÊùÉË°°„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>üìê Ê∂àË¥πËÄÖÈúÄË¶ÅÈáçËØï&lt;/p>
&lt;p>Âú®ËøõË°åËΩÆËØ¢ÂêéÔºåÊúâ‰∫õÊ∂àÊÅØ‰∏ç‰ºöË¢´ÂÆåÂÖ®Â§ÑÁêÜÔºåÈúÄË¶ÅÁ®çÂêéÈáçËØï„ÄÇÂ¶ÇËÆ∞ÂΩï #31 Â§ÑÁêÜÊàêÔºåËÆ∞ÂΩï #30 Â§ÑÁêÜÂ§±Ë¥•„ÄÇÊèê‰∫§ÂÅèÁßªÈáèÊó∂ÈúÄË¶ÅËøõË°åÂ§ÑÁêÜÔºà#31Ôºü/ #30Ôºâ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ÈÅáÂà∞ÂèØÈáçËØïÈîôËØØÊó∂ÔºåÊèê‰∫§ÊúÄÂêé‰∏Ä‰∏™Â§ÑÁêÜÊàêÂäüÁöÑÂÅèÁßªÈáèÔºåÂ∞ÜÊ≤°ÊúâÂ§ÑÁêÜÂ•ΩÁöÑÊ∂àÊÅØ‰øùÂ≠òÂà∞ÁºìÂÜ≤Âå∫‰∏≠ÔºåË∞ÉÁî®Ê∂àË¥πËÄÖÁöÑ pause() Á°Æ‰øùÂÖ∂‰ªñËΩÆËØ¢‰∏ç‰ºöËé∑ÂèñÊï∞ÊçÆÔºàÂÅúÊ≠¢Êé•Êî∂Ê∂àÊÅØÈò≤Ê≠¢ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÔºâÔºåÂú®‰øùÂ≠òËΩÆËØ¢Ôºà‰øùÊåÅÂøÉË∑≥ÔºâÁöÑÊÉÖÂÜµ‰∏ãÂ∞ùËØïÈáçÊñ∞Â§ÑÁêÜ„ÄÇÂ¶ÇÊûúÈáçËØïÊàêÂäüÊàñÈáçËØïÊ¨°Êï∞ËææÂà∞‰∏äÈôêÂπ∂ÂÜ≥ÂÆöÊîæÂºÉÔºåÂ∞ÜÁªìÊûúËÆ∞ÂΩï‰∏ãÊù•Ôºå‰ΩøÁî® resume() ÁªßÁª≠‰ªéËΩÆËØ¢‰∏≠Ëé∑ÂèñÊï∞ÊçÆ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÈÅáÂà∞ÂèØÈáçËØïÈîôËØØÔºåÊääÈîôËØØÂÜôÂÖ•Âà∞‰∏Ä‰∏™ÂçïÁã¨ÁöÑ‰∏ªÈ¢òÔºåÁªßÁª≠Â§ÑÁêÜ‰∏öÂä°„ÄÇ‰ΩøÁî®‰∏ìÈó®ÁöÑÊ∂àË¥πËÄÖ‰ªéËøô‰∏™ÂçïÁã¨ÁöÑ‰∏ªÈ¢ò‰∏äËØªÂèñÊ∂àÊÅØËøõË°åÈáçËØï„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>üìê ÈïøÊó∂Èó¥Â§ÑÁêÜÊ∂àÊÅØ&lt;/p>
&lt;p>ÊúâÊó∂Â§ÑÁêÜÊï∞ÊçÆÈúÄË¶ÅÂæàÈïøÁöÑÊó∂Èó¥„ÄÇ„ÄåÂç≥‰Ωø‰∏çÊÉ≥Ëé∑ÂèñÊõ¥Â§öÁöÑÊï∞ÊçÆÔºå‰πüË¶Å‰øùÊåÅËΩÆËØ¢ÔºåËøôÊ†∑ÂÆ¢Êà∑Á´ØÊâçËÉΩÂêë Broker ÂèëÈÄÅÂøÉË∑≥„ÄÇ„Äç&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Kafka Êìç‰ΩúÔºàDoingÔºâ</title><link>https://emerywan.github.io/blog/p/kafka/operation/</link><pubDate>Sun, 26 Mar 2023 08:08:08 +0800</pubDate><guid>https://emerywan.github.io/blog/p/kafka/operation/</guid><description>&lt;img src="https://emerywan.github.io/blog/p/kafka/operation/1.png" alt="Featured image of post Kafka Êìç‰ΩúÔºàDoingÔºâ" />&lt;h2 id="ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑">ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑&lt;/h2>
&lt;p>Kafka Êèê‰æõ‰∫Ü‰∏Ä‰∫õÂü∫‰∫éËÑöÊú¨ÁöÑÂëΩÂêçË°åÂ∑•ÂÖ∑ &lt;code>${dir}/bin/xxx.sh&lt;/code>ÔºåÁî®‰∫éÁÆ°ÁêÜÈõÜÁæ§„ÄÇËøô‰∫õÁÆ°ÁêÜÈÄöËøá Java Á±ªÂÆûÁé∞ÔºåÈÄöËøáËÑöÊú¨Ë∞ÉÁî®„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ÂêØÂä® Zookeeper ÊúçÂä°ÔºàÊñ∞ÁâàÂ∑≤ÂÜÖÁΩÆÔºâ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin/zookeeper-server-start.sh config/zeekeeper.properties
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ÂêØÂä® Kafka ÊúçÂä°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin/kafka-server-start.sh config/server.properties
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>üîç Êõ¥Â§ö CLI Êìç‰ΩúÔºö&lt;a class="link" href="https://www.conduktor.io/kafka/kafka-topics-cli-tutorial/" target="_blank" rel="noopener"
>üåê https://www.conduktor.io/kafka/kafka-topics-cli-tutorial/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h3 id="topic-Êìç‰Ωú">Topic Êìç‰Ωú&lt;/h3>
&lt;p>Kafka Â§ßÈÉ®ÂàÜÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑Áõ¥Êé•Êìç‰Ωú Zookeeper ‰∏äÁöÑÂÖÉÊï∞ÊçÆÔºåÂπ∂‰∏ç‰ºöÁõ¥Êé•ËøûÊé•Âà∞ Broker ‰∏äÔºåÈúÄË¶ÅÁ°Æ‰øùÊâÄ‰ΩøÁî®ÁöÑÂ∑•ÂÖ∑ÁâàÊú¨‰∏éÈõÜÁæ§‰∏≠ÁöÑ Broker ÁâàÊú¨Áõ∏ÂåπÈÖç„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>üéóÔ∏è&lt;/p>
&lt;p>Kafka 2.2+ ‰ΩøÁî® Kafka ÁöÑ hostname &amp;amp; port ËøõË°åÊìç‰Ωú &lt;code>--bootstrap-server 127.0.0.1:9092&lt;/code>&lt;/p>
&lt;p>ÊóßÁâàÊú¨‰ΩøÁî® Zookeeper ÁöÑ URL &amp;amp; port ËøõË°åÊìç‰Ωú &lt;code>--zookeeper 127.0.0.1:2181&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ÂàõÂª∫‰∏ªÈ¢ò&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 2.2 +&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kafka-topics.sh --bootstrap-server localhost:9092 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --create &lt;span class="se">\ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --topic first_topic &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --partitions &lt;span class="m">3&lt;/span> &lt;span class="se">\ &lt;/span> &lt;span class="c1"># ÂàÜÂå∫Êï∞Èáè&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --replication-factor &lt;span class="m">1&lt;/span> &lt;span class="c1"># ÂâØÊú¨Êï∞Èáè&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># old&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kafka-topics.sh --zookeeper localhost:2181 --topic first_topic --create --partitions &lt;span class="m">3&lt;/span> --replication-factor &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ÂàóÂá∫‰∏ªÈ¢ò&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 2.2 + &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kafka-topics.sh --bootstrap-server localhost:9092 --list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ËØ¶ÁªÜ‰ø°ÊÅØ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kafka-topics.sh --bootstrap-server localhost:9092 --describe --topic first_topic
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ‰øÆÊîπ‰∏ªÈ¢ò&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kafka-topics.sh --bootstrap-server localhost:9092 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --alter &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --topic first_topic &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --partitions &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="Áîü‰∫ß--Ê∂àË¥π">Áîü‰∫ß &amp;amp; Ê∂àË¥π&lt;/h3>
&lt;blockquote>
&lt;p>üéóÔ∏è Producer&lt;/p>
&lt;p>Kafka 2.5+ ‰ΩøÁî® &lt;code>--bootstrap-server&lt;/code>&lt;/p>
&lt;p>ÊóßÁâàÊú¨ Kafka ‰ΩøÁî® &lt;code>--broker-list&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Áîü‰∫ß&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kafka-console-producer.sh --bootstrap-server localhost:9092 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --topic first_topic
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>üéóÔ∏è Consumer&lt;/p>
&lt;p>‰ΩøÁî® &lt;code>--bootstrap-server&lt;/code>ÔºåËá™ v0.10 ÂºÄÂßã &lt;code>--zookeeper&lt;/code> Â∑≤Ë¢´Â∫üÂºÉ&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">kafka-console-consumer.sh --bootstrap-server localhost:9092 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --topic first_topic
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="-producer">ü§≤ Producer&lt;/h2>
&lt;h3 id="-Áîü‰∫ßËÄÖ">üêà Áîü‰∫ßËÄÖ&lt;/h3>
&lt;ul>
&lt;li>üß© &lt;code>ProducerRecord&lt;/code> ÂØπË±°ÂåÖÂê´ÁõÆÊ†á‰∏ªÈ¢ò Topic ÂíåÈúÄË¶ÅÂèëÈÄÅÁöÑÂÜÖÂÆπ ValueÔºåÂèØ‰ª•ÂèØ‰ª•ÊåáÂÆöÂàÜÂå∫ Partition ÂíåÈîÆÂÄº KeyÔºàÊ∂àÊÅØÁöÑÈôÑÂä†‰ø°ÊÅØÔºåÂèØ‰ª•Áî®Êù•ÂÜ≥ÂÆöÊ∂àÊÅØË¢´ÂÜôÂÖ•Âì™‰∏™ÂàÜÂå∫ÔºåÁõ∏Âêå Key ÁöÑÊ∂àÊÅØ‰ºöÂÜôÂÖ•Âêå‰∏Ä‰∏™ÂàÜÂå∫Ôºâ&lt;/li>
&lt;li>üß© ÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåÁîü‰∫ßËÄÖÈúÄË¶ÅÂ∞Ü &lt;code>ProducerRecord&lt;/code> ÂØπË±°Â∫èÂàóÂåñ‰∏∫Â≠óËäÇÊï∞ÁªÑÔºåÂú®ÁΩëÁªú‰∏ä‰º†Ëæì&lt;/li>
&lt;li>üß© Êï∞ÊçÆË¢´‰º†ÈÄÅÁªôÂàÜÂå∫Âô® &lt;code>Partitioner&lt;/code>ÔºåÂ¶ÇÊûúÊåáÂÆö‰∫ÜÂàÜÂå∫Ôºå‰ºöÁõ¥Êé•ËøîÂõûÔºõÊ≤°ÊúâÊåáÂÆöÔºåÊ†πÊçÆ Key ÈÄâÊã©‰∏Ä‰∏™ÂàÜÂå∫ÔºõÊ≤°ÊúâÊåáÂÆö KeyÔºå‰ºöÊ†πÊçÆ Value ËøõË°åÊï£ÂàóÔºåÊ†πÊçÆÊï£ÂàóÂÄºÊääÊ∂àÊÅØÊò†Â∞ÑÂà∞Áõ∏Â∫îÁöÑÂàÜÂå∫&lt;/li>
&lt;li>üß© ËøôÊù°ËÆ∞ÂΩïÈÄâÂ•ΩÂàÜÂå∫ÂêéÔºå‰ºöË¢´Ê∑ªÂä†Âà∞‰∏Ä‰∏™ËÆ∞ÂΩïÊâπÊ¨°‰∏≠ÔºåËøô‰∏™ÊâπÊ¨°ÁöÑÊâÄÊúâÊ∂àÊÅØ‰ºöË¢´ÂèëÈÄÅÂà∞Áõ∏ÂêåÁöÑ‰∏ªÈ¢òÂíåÂàÜÂå∫‰∏äÔºàÊâπÂ§ÑÁêÜÔºâÔºåÁã¨Á´ãÁöÑ &lt;code>Processer&lt;/code> Á∫øÁ®ã‰ºöË¥üË¥£ÊääËøô‰∫õÊï∞ÊçÆÂèëÈÄÅÂà∞ÂØπÂ∫îÁöÑ broker ‰∏ä&lt;/li>
&lt;li>üß© Broker Êî∂Âà∞Ê∂àÊÅØÊó∂‰ºöËøîÂõû‰∏Ä‰∏™ÂìçÂ∫î
&lt;ul>
&lt;li>Ê∂àÊÅØÊàêÂäüÂÜôÂÖ• KafkaÔºåËøîÂõû‰∏Ä‰∏™ &lt;code>RecordMetaData&lt;/code> ÂØπË±°ÔºåÂåÖÂê´‰∏ªÈ¢òÂíåÂàÜÂå∫ÁöÑ‰ø°ÊÅØ&lt;/li>
&lt;li>ÂÜôÂÖ•Â§±Ë¥•Ôºå‰ºöËøîÂõû‰∏Ä‰∏™ÈîôËØØÔºåÁîü‰∫ßËÄÖÊî∂Âà∞ÈîôËØØ‰πãÂêé‰ºöÂ∞ùËØïÈáçÊñ∞ÂèëÈÄÅÔºåÂ§öÊ¨°Â§±Ë¥•Áõ¥Êé•ËøîÂõûÈîôËØØ‰ø°ÊÅØ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/operation/producer.webp"
width="780"
height="678"
srcset="https://emerywan.github.io/blog/blog/p/kafka/operation/producer_huebfba9d061e763283d9c37fc8487b94d_24528_480x0_resize_q75_h2_box_2.webp 480w, https://emerywan.github.io/blog/blog/p/kafka/operation/producer_huebfba9d061e763283d9c37fc8487b94d_24528_1024x0_resize_q75_h2_box_2.webp 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="115"
data-flex-basis="276px"
>&lt;/p>
&lt;h4 id="ÈáçË¶ÅÈÖçÁΩÆ">ÈáçË¶ÅÈÖçÁΩÆ&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>&lt;code>acks&lt;/code>&lt;/p>
&lt;p>ÊåáÂÆö‰∫ÜÂøÖÈ°ªË¶ÅÊúâÂ§öÂ∞ë‰∏™ÂàÜÂå∫ÂâØÊú¨Êî∂Âà∞Ê∂àÊÅØÔºåÁîü‰∫ßËÄÖÊâç‰ºö‰ªªÂä°Ê∂àÊÅØÂÜôÂÖ•Êó∂ÊàêÂäüÁöÑ&lt;/p>
&lt;ul>
&lt;li>&lt;code>acks=0&lt;/code> ‰∏ç‰ºöÁ≠âÂæÖ‰ªªÂä°Êù•Ëá™ÊúçÂä°Âô®ÁöÑÂìçÂ∫î„ÄÇËææÂà∞ÊúÄÈ´òÁöÑÂêûÂêêÈáèÔºåÊó†Ê≥ïÂæóÁü•Ê∂àÊÅØÁä∂ÊÄÅ„ÄÇ&lt;/li>
&lt;li>&lt;code>acks=1&lt;/code> Âè™Ë¶Å Partition Leader Êî∂Âà∞ÂìçÂ∫î„ÄÇÊ∂àÊÅØÂèØËÉΩ‰ºö‰∏¢Â§±ÔºåLeaderÂÆïÊú∫ÂêéÔºå‰∏Ä‰∏™Êú™ÂêåÊ≠•ÁöÑFllowerÊàê‰∏∫Êñ∞ÁöÑLeader„ÄÇ&lt;/li>
&lt;li>&lt;code>acks=all&lt;/code> Ê∂àÊÅØË¶ÅÂÖ®ÈÉ®ÂêåÊ≠•Âà∞ÊâÄÊúâÁöÑ Leader&amp;amp;Fllower„ÄÇ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>retries&lt;/code>&lt;/p>
&lt;p>Áîü‰∫ßËÄÖÂèØ‰ª•ÈáçÂèëÊ∂àÊÅØÁöÑÊ¨°Êï∞&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>max.in.flight.requests.per.connection&lt;/code>&lt;/p>
&lt;p>Áîü‰∫ßËÄÖÂú®Êî∂Âà∞ÊúçÂä°Âô®ÂìçÂ∫îÂâçÂèØ‰ª•ÂèëÈÄÅÂ§öÂ∞ë‰∏™Ê∂àÊÅØ„ÄÇ&lt;/p>
&lt;p>Kafka ÂèØ‰ª•‰øùËØÅÂêå‰∏Ä‰∏™ÂàÜÂå∫ÈáåÁöÑÊ∂àÊÅØÊòØÊúâÂ∫èÁöÑÔºå&lt;code>max.in.flight.requests.per.connection=1&lt;/code>ÔºåÂç≥‰ΩøÂèëÈÄÅ‰∫ÜÈáçËØïÔºåÊ∂àÊÅØ‰æùÊóßÊúâÂ∫èÔºå‰ΩÜÊòØ‰ºö‰∏•ÈáçÂΩ±ÂìçÁîü‰∫ßËÄÖÁöÑÂêûÂêêÈáè„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-ÂêåÊ≠•ÂèëÈÄÅ">üêà‚Äç‚¨õ ÂêåÊ≠•ÂèëÈÄÅ&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="n">Future&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">RecordMetadata&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="nf">send&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">K&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">V&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>‰ΩøÁî® &lt;code>send()&lt;/code> ÊñπÊ≥ïÂèëÈÄÅÊ∂àÊÅØÔºå‰ºöËøîÂõû‰∏Ä‰∏™ Future ÂØπË±°ÔºåË∞ÉÁî® &lt;code>get()&lt;/code> ÊñπÊ≥ïËøõË°åÁ≠âÂæÖÔºåÂ∞±ÂèØ‰ª•Áü•ÈÅìÊ∂àÊÅØÊòØÂê¶ÂèëÈÄÅÊàêÂäü„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Áõ∏ÂÖ≥ÈÖçÁΩÆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">String&lt;/span> &lt;span class="n">bootstrapServers&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;127.0.0.1:9092&amp;#34;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Properties&lt;/span> &lt;span class="n">properties&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Properties&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ProducerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">BOOTSTRAP_SERVERS_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">bootstrapServers&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ProducerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">KEY_SERIALIZER_CLASS_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">StringSerializer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">());&lt;/span> &lt;span class="c1">// Â∫èÂàóÂåñÊñπÂºè
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ProducerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">VALUE_SERIALIZER_CLASS_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">StringSerializer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ÂàõÂª∫ Producer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">KafkaProducer&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">producer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">KafkaProducer&lt;/span>&lt;span class="o">&amp;lt;&amp;gt;(&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ÂàõÂª∫Ê∂àÊÅØ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">producerRecord&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&amp;gt;(&lt;/span>&lt;span class="s">&amp;#34;demo_topic&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;hello world!&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ÂèëÈÄÅÊ∂àÊÅØ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">try&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">producer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">send&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">record&lt;/span>&lt;span class="o">).&lt;/span>&lt;span class="na">get&lt;/span>&lt;span class="o">();&lt;/span> &lt;span class="c1">// get() ÂêåÊ≠•
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">Exception&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="c1">// ÂèëÁîü‰∫ÜÊó†Ê≥ïËß£ÂÜ≥ÁöÑÈîôËØØ Êàñ ÈáçËØïË∂ÖËøáÊúÄÂ§ßÊ¨°Êï∞
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">printStackTrace&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="-ÂºÇÊ≠•ÂèëÈÄÅ">üêÖ ÂºÇÊ≠•ÂèëÈÄÅ&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="n">Future&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">RecordMetadata&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="nf">send&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">K&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">V&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">Callback&lt;/span> &lt;span class="n">callback&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ë∞ÉÁî® &lt;code>send()&lt;/code> ÊñπÊ≥ïÔºåÂπ∂ÊåáÂÆö‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞ÔºåÊúçÂä°Âô®Âú®ËøîÂõûÂìçÂ∫îÊó∂Ë∞ÉÁî®ËØ•ÂáΩÊï∞„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="n">producer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">send&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">producerRecord&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Callback&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">onCompletion&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">RecordMetadata&lt;/span> &lt;span class="n">recordMetadata&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">Exception&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ÂèëÈÄÅÂ§±Ë¥•
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ÂØπÂ∫îÁöÑ‰∏öÂä°Â§ÑÁêÜÈÄªËæë
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="-Â∫èÂàóÂåñÂô®">üêÜ Â∫èÂàóÂåñÂô®&lt;/h3>
&lt;p>Â∏∏ËßÅÁöÑÂ∫èÂàóÂåñ&amp;amp;ÂèçÂ∫èÂàóÂåñÂô®Êúâ Avro„ÄÅThrift„ÄÅProtobuf Á≠â„ÄÇ&lt;/p>
&lt;p>Apache &lt;a class="link" href="https://zhuanlan.zhihu.com/p/370519371" target="_blank" rel="noopener"
>Avro&lt;/a> ÊòØ‰∏ÄÁßç‰∏éÁºñÁ®ãËØ≠Ë®ÄÊó†ÂÖ≥ÁöÑÂ∫èÂàóÂåñÊ†ºÂºè„ÄÇ&lt;/p>
&lt;p>Avro ÈÄöËøá‰∏éËØ≠Ë®ÄÊó†ÂÖ≥ÁöÑ schema Êù•ÂÆö‰πâÔºå‰ΩøÁî® JSON Êù•ÊèèËø∞ÔºåÊï∞ÊçÆ‰ºöË¢´Â∫èÂàóÂåñ‰∏∫‰∫åËøõÂà∂Êñá‰ª∂Êàñ JSON Êñá‰ª∂„ÄÇ&lt;/p>
&lt;p>Êª°Ë∂≥ Avro ÂÖºÂÆπÂéüÂàô‰∏ãÔºåÂÜôÂÖ•ÁöÑÊ∂àÊÅØÊîπÂä® schema ÂÜôÂÖ•‰∫ÜÊñ∞ÁöÑÊï∞ÊçÆÔºåË¥üË¥£ËØªÊ∂àÊÅØÁöÑÂ∫îÁî®Á®ãÂ∫èÂèØ‰ª•ÁªßÁª≠Â§ÑÁêÜËÄåÊó†ÈúÄÂÅö‰ªª‰ΩïÊõ¥Êîπ„ÄÇ&lt;/p>
&lt;h3 id="-ÂàÜÂå∫">üêï ÂàÜÂå∫&lt;/h3>
&lt;p>&lt;code>ProducerRecord&lt;/code> ÂØπË±°ÂèØ‰ª•ÂåÖÂê´ topic„ÄÅpartition„ÄÅkey„ÄÅvalue Á≠âÔºåÈÄöÂ∏∏Êàë‰ª¨‰ºöÊåáÂÆö keyÔºå‰Ωú‰∏∫ÈôÑÂä†Ê∂àÊÅØÔºåÂÜ≥ÂÆöÊ∂àÊÅØËØ•Ë¢´ÂÜôÂÖ•Âì™‰∏™ÂàÜÂå∫ÔºåÊã•ÊúâÁõ∏Âêå key ÁöÑÊ∂àÊÅØ‰ºöË¢´ÂÜôÂÖ•Âêå‰∏Ä‰∏™ÂàÜÂå∫„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// topic: CustomerCountry
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// key: Laboratory Equipment
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// value: USA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&amp;gt;(&lt;/span>&lt;span class="s">&amp;#34;CustomerConuntry&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;Laboratory Equipment&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;USA&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ÂàõÂª∫ key-&amp;gt;null ÁöÑÊ∂àÊÅØ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ProducerRecord&lt;/span>&lt;span class="o">&amp;lt;&amp;gt;(&lt;/span>&lt;span class="s">&amp;#34;CustomerCountry&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;USA&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂΩì key ‰∏∫ null Êó∂ÔºåKafka ‰ºöÂØπÈîÆËøõË°åÊï£ÂàóÔºàKafka Ëá™Â∑±ÁöÑÊï£ÂàóÁÆóÊ≥ïÔºâÔºåÁÑ∂ÂêéÊ†πÊçÆÊï£ÂàóÂÄºÊò†Â∞ÑÂà∞ÁâπÊÆäÁöÑÂàÜÂå∫„ÄÇ&lt;/p>
&lt;h4 id="Ëá™ÂÆö‰πâÂàÜÂå∫Á≠ñÁï•">Ëá™ÂÆö‰πâÂàÜÂå∫Á≠ñÁï•&lt;/h4>
&lt;p>ÈÄöËøáÂÆûÁé∞ &lt;code>interface Partitioner&lt;/code> ÂÆûÁé∞Ëá™ÂÆö‰πâÂàÜÂå∫Á≠ñÁï•Ôºå‰∏ªË¶ÅÂåÖÂê´Ôºö&lt;/p>
&lt;ul>
&lt;li>&lt;code>void configure(Map&amp;lt;String, ?&amp;gt; configs)&lt;/code>
&lt;ul>
&lt;li>ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåÂ∫îÈÄöËøáËØ•ÊñπÊ≥ï‰º†ÂÖ•Áõ∏ÂÖ≥‰ø°ÊÅØ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>void partition(String topic, Object key, byte[] keyBytes, Object value, byte[] valueBytes, Cluster cluster)&lt;/code>&lt;/li>
&lt;li>&lt;code>void close()&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">BananaPartitioner&lt;/span> &lt;span class="kd">implements&lt;/span> &lt;span class="n">Partitioner&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">configure&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Map&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="o">?&amp;gt;&lt;/span> &lt;span class="n">configs&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Ëá™ÂÆö‰πâÂàÜÂå∫Á≠ñÁï•
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">partition&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span> &lt;span class="n">topic&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">Object&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">byte&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">keyBytes&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">Object&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">byte&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">valueBytes&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">Cluster&lt;/span> &lt;span class="n">cluster&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">List&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">PartitionInfo&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">partitions&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cluster&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">partitionsForTopic&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">topic&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">numPartitions&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">partition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">size&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">((&lt;/span>&lt;span class="n">keyBytes&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="o">(!(&lt;/span>&lt;span class="n">key&lt;/span> &lt;span class="n">instanceOf&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">)))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">throw&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">InvalidRecordException&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;We expect all messages to have customer name as key&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(((&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="o">).&lt;/span>&lt;span class="na">equals&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Banana&amp;#34;&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="c1">// Banana ÊÄªÊòØË¢´ÂàÜÈÖçÂà∞ÊúÄÂêé‰∏Ä‰∏™ÂàÜÂå∫
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">numPartitions&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ÂÖ∂ÂÆÉËÆ∞ÂΩïË¢´Êï£ÂàóÂà∞ÂÖ∂‰ªñÂàÜÂå∫
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">((&lt;/span>&lt;span class="n">Math&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">abs&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Utils&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">murmur2&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">keyBytes&lt;/span>&lt;span class="o">)))&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">numPartitions&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="o">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="-consumer">üëå Consumer&lt;/h2>
&lt;h3 id="-Ê∂àË¥πËÄÖÁªÑ">ü¶ú Ê∂àË¥πËÄÖÁªÑ&lt;/h3>
&lt;h3 id="-Ê∂àÊÅØËΩÆËØ¢">ü¶ö Ê∂àÊÅØËΩÆËØ¢&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ÈÖçÁΩÆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">String&lt;/span> &lt;span class="n">bootstrapServers&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;127.0.0.1:9092&amp;#34;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">String&lt;/span> &lt;span class="n">groupId&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;demo_groupId&amp;#34;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">String&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;demo_topic&amp;#34;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Properties&lt;/span> &lt;span class="n">properties&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Properties&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">BOOTSTRAP_SERVERS_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">bootstrapServers&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">KEY_DESERIALIZER_CLASS_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">StringDeserializer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">VALUE_DESERIALIZER_CLASS_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">StringDeserializer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">GROUP_ID_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">groupId&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setProperty&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerConfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">AUTO_OFFSET_RESET_CONFIG&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;earliest&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ÂàõÂª∫Ê∂àË¥πËÄÖ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">KafkaConsumer&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">consumer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">KafkaConsumer&lt;/span>&lt;span class="o">&amp;lt;&amp;gt;(&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ËÆ¢ÈòÖ‰∏ªÈ¢ò
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">subscribe&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Arrays&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">asList&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">topic&lt;/span>&lt;span class="o">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ËΩÆËØ¢
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">while&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ConsumerRecords&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">records&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">poll&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Duration&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">ofMillis&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">100&lt;/span>&lt;span class="o">));&lt;/span> &lt;span class="c1">// 100 -&amp;gt; Ë∂ÖÊó∂Êó∂Èó¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">records&lt;/span>&lt;span class="o">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ‰∏öÂä°Â§ÑÁêÜ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">info&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Key: &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">key&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;, Value: &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">value&lt;/span>&lt;span class="o">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">info&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Partition: &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">partition&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;, Offset:&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">offset&lt;/span>&lt;span class="o">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ê∂àÊÅØËΩÆËØ¢ÊòØÊ∂àË¥πËÄÖ API ÁöÑÊ†∏ÂøÉÔºå‰∏ÄÊó¶Ê∂àË¥πËÄÖËÆ¢ÈòÖÁöÑ‰∏ªÈ¢òÔºåËΩÆËØ¢‰ºöÂ§ÑÁêÜÊâÄÊúâÁöÑÁªÜËäÇ„ÄÇ
&lt;code>poll()&lt;/code> ‰ºöË¥üË¥£Êü•Êâæ GroupCordinatorÔºåÂä†ÂÖ•Áæ§ÁªÑÔºåÊé•ÂèóÂàÜÈÖçÁöÑÂàÜÂå∫ÔºåÂèëÈÄÅÂøÉË∑≥ÂíåËé∑ÂèñÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúÂèëÁîü‰∫ÜÂÜçÂùáË°°Ôºå‰πüÊòØËøô‰∏™ËΩÆËØ¢ÊúüÈó¥ËøõË°åÁöÑ„ÄÇ&lt;/p>
&lt;p>‚ö†Ô∏è Ê∂àË¥πËÄÖÁªÑ‰∏≠ÁöÑ‰∏Ä‰∏™Ê∂àË¥πËÄÖÂè™ËÉΩËøêË°åÂú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂ§ö‰∏™Á∫øÁ®ãÂ§ÑÁêÜ‰∏Ä‰∏™ Patition ‰∏≠ÁöÑÊ∂àÊÅØÔºåÂèØ‰ª•Â∞ÜËøô‰∏™Ê∂àË¥πËÄÖËé∑ÂèñÁöÑ‰∏ÄÊâπÊï∞ÊçÆÔºåÂèØ‰ª•‰ΩøÁî® ExecutorService ÂêØÂä®Â§ö‰∏™Á∫øÁ®ãÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;h3 id="-ÂÅèÁßªÈáè">ü¶â ÂÅèÁßªÈáè&lt;/h3>
&lt;p>Kafka ‰ΩøÁî®ÂÅèÁßªÈáè offset ËøΩË∏™Ê∂àÊÅØÂú®ÂàÜÂå∫‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇ&lt;/p>
&lt;p>Consumer Âêë‰∏Ä‰∏™ÁâπÊÆäÁöÑ‰∏ªÈ¢ò &lt;code>_consumer_offset&lt;/code> ÂèëÈÄÅÊ∂àÊÅØÔºåÊõ¥Êñ∞ÂàÜÂå∫ÂΩìÂâçÁöÑ‰ΩçÁΩÆ„ÄÇ&lt;/p>
&lt;ul>
&lt;li>Â¶ÇÊûúÊèê‰∫§ÁöÑ offset„ÄåÂ∞è‰∫é„ÄçÂÆ¢Êà∑Á´ØÂ§ÑÁêÜÁöÑÊúÄÂêé‰∏Ä‰∏™Ê∂àÊÅØÂÅèÁßªÈáèÔºåÈÇ£‰πà„Äå‰∏§‰∏™ÂÅèÁßªÈáè‰πãÈó¥ÁöÑÊ∂àÊÅØ‰ºöË¢´ÈáçÂ§çÂ§ÑÁêÜ„Äç&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/operation/offset1.png"
width="978"
height="422"
srcset="https://emerywan.github.io/blog/blog/p/kafka/operation/offset1_hu7de55e7adbd4de02cc42f3a04ca7fa88_35082_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/operation/offset1_hu7de55e7adbd4de02cc42f3a04ca7fa88_35082_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="231"
data-flex-basis="556px"
>&lt;/p>
&lt;ul>
&lt;li>Â¶ÇÊûúÊèê‰∫§ÁöÑ offset„ÄåÂ§ß‰∫é„ÄçÂÆ¢Êà∑Á´ØÂ§ÑÁêÜÁöÑÊúÄÂêé‰∏Ä‰∏™Ê∂àÊÅØÂÅèÁßªÈáèÔºåÈÇ£‰πà„Äå‰∏§‰∏™ÂÅèÁßªÈáè‰πãÈó¥ÁöÑÊ∂àÊÅØ‰ºö‰∏¢Â§±„Äç&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/operation/offset2.png"
width="979"
height="485"
srcset="https://emerywan.github.io/blog/blog/p/kafka/operation/offset2_hu389bebeaa08efdc7ddfc7a71cffd3a76_34010_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/operation/offset2_hu389bebeaa08efdc7ddfc7a71cffd3a76_34010_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="201"
data-flex-basis="484px"
>&lt;/p>
&lt;h4 id="Ëá™Âä®Êèê‰∫§">Ëá™Âä®Êèê‰∫§&lt;/h4>
&lt;p>Â¶ÇÊûú &lt;code>enable.auto.commit = true&lt;/code>ÔºåÊ∂àË¥πËÄÖ‰ºöËá™Âä®Êää‰ªé &lt;code>poll()&lt;/code> ÊñπÊ≥ïÊé•Êî∂Âà∞ÁöÑÊúÄÂ§ßÂÅèÁßªÈáèÊèê‰∫§‰∏äÂéª„ÄÇÊèê‰∫§ÁöÑÊó∂Èó¥Èó¥ÈöîÁî± &lt;code>auto.commit.interval.ms&lt;/code> ÊéßÂà∂ÔºåÈªòËÆ§‰∏∫ 5s„ÄÇ&lt;/p>
&lt;p>Ëá™Âä®Êèê‰∫§ÂèëÁîüÂú®ÊØèÊ¨°ËΩÆËØ¢Êó∂ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊèê‰∫§ÂÅèÁßªÈáèÔºå‰ºöÊää‰∏ä‰∏ÄÊ¨°Ë∞ÉÁî®ËøîÂõûÁöÑÂÅèÁßªÈáèÊèê‰∫§‰∏äÂéªÔºå„Äå‰∏çËÉΩ‰øùËØÅËøô‰∫õÊ∂àÊÅØÂ∑≤ÁªèË¢´‰∏öÂä°Â§ÑÁêÜ‰∫Ü„Äç„ÄÇ&lt;/p>
&lt;p>‚ö†Ô∏è Â¶ÇÊûúËÆæÁΩÆÈªòËÆ§Êèê‰∫§Êó∂Èó¥‰∏∫ 5sÔºåÂú®Êèê‰∫§Âêé 3s ÂèëÁîü‰∫ÜÂÜçÂùáË°°Ôºå‰πãÂêéÁöÑÊ∂àË¥πËÄÖ‰ºöÂÜçÊ¨°Ëé∑ÂèñÂà∞ 3s ÂâçÊèê‰∫§ÁöÑÂÅèÁßªÈáèÔºåËøô‰∫õÊ∂àÊÅØ‰ºöË¢´ÈáçÂ§çÂ§ÑÁêÜÔºå„ÄåÊó†Ê≥ïÈÅøÂÖçËøôÁßçÊÉÖÂÜµ„ÄçÔºåÂè™ËÉΩÁº©Â∞èÊèê‰∫§ÁöÑÊó∂Èó¥Èó¥ÈöîÊõ¥È¢ëÁπÅÂú∞Êèê‰∫§ offsetÔºå„ÄåKafka ‰πüÊ≤°Êúâ‰∏∫Ëá™Âä®Êèê‰∫§È¢ÑÁïôÈÅøÂÖçÈáçÂ§çÂ§ÑÁêÜÊ∂àÊÅØÁöÑÊñπÊ≥ï„Äç„ÄÇ&lt;/p>
&lt;p>ÈÄÇÂêà‰∫é‰∏çÈáçË¶ÅÁöÑÊ∂àÊÅØÂú∫ÊôØÔºåÂ¶ÇÊó•ÂøóÈááÈõÜ„ÄÇ&lt;/p>
&lt;h4 id="ÂêåÊ≠•Êèê‰∫§">ÂêåÊ≠•Êèê‰∫§&lt;/h4>
&lt;p>ËÆæÁΩÆ &lt;code>auto.commit.offset = false&lt;/code>ÔºåÂèØ‰ª•ËÆ©Â∫îÁî®Á®ãÂ∫èÂÜ≥ÂÆöÂú®‰ªÄ‰πàÊó∂ÂÄôÊèê‰∫§ÂÅèÁßªÈáè„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ConsumerRecords&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">records&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">poll&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">100&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">records&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Â§ÑÁêÜ‰∏öÂä°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commitSync&lt;/span>&lt;span class="o">();&lt;/span> &lt;span class="c1">// ÊâãÂä®Êèê‰∫§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">CommitFailedException&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">error&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;commit failed&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Âè™Ë¶ÅÊ≤°ÊúâÂèëÁîü‰∏çÂèØÊÅ¢Â§çÁöÑÈîôËØØÔºå&lt;code>commitSync()&lt;/code> ÊñπÊ≥ï‰ºö„Äå‰∏ÄÁõ¥Â∞ùËØïÁõ¥Âà∞Êèê‰∫§ÊàêÂäü‰∏∫Ê≠¢„Äç„ÄÇÂ¶ÇÊûúÊèê‰∫§Â§±Ë¥•ÔºåÂàôÊäõÂá∫ÂºÇÂ∏∏„ÄÇ&lt;/p>
&lt;h4 id="ÂºÇÊ≠•Êèê‰∫§">ÂºÇÊ≠•Êèê‰∫§&lt;/h4>
&lt;p>‰ΩøÁî®ÂºÇÊ≠•Êèê‰∫§ APIÔºåÂè™ÁÆ°ÂèëÈÄÅÊèê‰∫§ËØ∑Ê±ÇÔºåÊó†ÈúÄÁ≠âÂæÖ Broker ÁöÑÂìçÂ∫î„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commitAsync&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂêåÊ≠•Êèê‰∫§ &lt;code>commitSync()&lt;/code> ‰ºö‰∏ÄÁõ¥ÈáçËØïÔºå‰ΩÜÊòØÂºÇÊ≠•Êèê‰∫§ &lt;code>commitAsync()&lt;/code>„Äå‰∏ç‰ºöÈáçËØï„Äç„ÄÇ‰∏çËøõË°åÈáçËØïÔºåÊòØÂõ†‰∏∫Âú®Êî∂Âà∞ÊúçÂä°Âô®ÂìçÂ∫îÁöÑÊó∂ÂÄôÔºåÂèØËÉΩÊúâ‰∏Ä‰∏™Êõ¥Â§ßÁöÑ offset Â∑≤ÁªèÊèê‰∫§ÊàêÂäü„ÄÇ&lt;/p>
&lt;p>ÂºÇÊ≠•Êèê‰∫§ÂêåÊ†∑ÊîØÊåÅÂõûË∞É„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commitAsync&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">OffsetCommitCallback&lt;/span>&lt;span class="o">())&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">onComplete&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Map&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">TopicPartition&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">OffsetAndMetadata&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">offsets&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">Exception&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ÂºÇÊ≠•Êèê‰∫§Â§±Ë¥•
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ... ‰∏öÂä°Â§ÑÁêÜ / ÈáçËØï
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂºÇÊ≠•Êèê‰∫§ÈáçËØïÔºåÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™ÂçïË∞ÉÈÄíÂ¢ûÁöÑÂ∫èÂàóÂè∑Áª¥Êä§ÂºÇÊ≠•Êèê‰∫§ÁöÑÈ°∫Â∫è„ÄÇÂú®ËøõË°åÈáçËØïÂâçÔºåÂÖàÊ£ÄÊü•ÂõûË∞ÉÂ∫èÂàóÂè∑‰∏éÁª¥Êä§ÁöÑÂ∫èÂàóÂè∑ÁöÑÂ§ßÂ∞èÔºåÂ¶ÇÊûúÂõûË∞ÉÂ∫èÂàóÂè∑ËæÉÂ§ßÔºåËØ¥ÊòéÊúâ‰∏Ä‰∏™Êñ∞ÁöÑÊèê‰∫§Â∑≤ÁªèÂèëÈÄÅÔºå‰∏çÂ∫îËØ•ÈáçËØï„ÄÇ&lt;/p>
&lt;h4 id="ÁªÑÂêàÊèê‰∫§">ÁªÑÂêàÊèê‰∫§&lt;/h4>
&lt;p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÂÅ∂Â∞îÁöÑÊèê‰∫§Â§±Ë¥•‰∏çËøõË°åÈáçËØïÊ≤°ÊúâÂ§™Â§ßÈóÆÈ¢òÔºåÂè™Ë¶ÅÂêéÁª≠ÊúâÊõ¥Â§ßÁöÑ offset ÊàêÂäüÊèê‰∫§ÔºåÂ∞±‰∏ç‰ºöÊúâÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;p>ÊâÄ‰ª•ÔºåÂú®Ê∂àË¥πËÄÖÂÖ≥Èó≠ÂâçÔºåÂèØ‰ª•ÁªÑÂêà‰ΩøÁî®‰∏§ÁßçÊèê‰∫§ÊñπÂºè„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="k">try&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Ê∂àË¥πÊ∂àÊÅØ‰∏öÂä°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">comsumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commitAsync&lt;/span>&lt;span class="o">();&lt;/span> &lt;span class="c1">// ÂºÇÊ≠•Êèê‰∫§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">Exception&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">error&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Unexpected error&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span> &lt;span class="k">finally&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commitSync&lt;/span>&lt;span class="o">();&lt;/span> &lt;span class="c1">// ÂêåÊ≠•Ôºå‰ºö‰∏çÊñ≠ÈáçËØï
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">}&lt;/span> &lt;span class="k">finally&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">close&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="Êèê‰∫§ÁâπÂÆöÂÅèÁßªÈáè">Êèê‰∫§ÁâπÂÆöÂÅèÁßªÈáè&lt;/h4>
&lt;p>ÊØèÊ¨°Ê∂àË¥πËÄÖ &lt;code>poll()&lt;/code> ÁöÑÈÉΩÊòØ‰∏ÄÊâπÊï∞ÊçÆÔºå&lt;code>commitSync() / commitAsync()&lt;/code> ÊØèÊ¨°Êèê‰∫§ÈÉΩÊòØËøô‰∏™ÊâπÊ¨°ÊúÄÂêéÁöÑ offsetÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÂú®ÊâπÊ¨°‰∏≠Èó¥Êèê‰∫§ÂÅèÁßªÈáèÔºåÂèØ‰ª•‰º†ÂÖ•„ÄåÂ∏åÊúõÊèê‰∫§ÁöÑÂàÜÂå∫ÂíåÂÅèÁßªÈáèÁöÑ map„Äç„ÄÇ&lt;/p>
&lt;p>‰ΩÜÊòØÔºåÊ∂àË¥πËÄÖÂèØËÉΩ‰∏çÁü•ËØªÂèñ‰∏Ä‰∏™ÂàÜÂå∫ÔºåËøôÊ†∑ÂÅöÈúÄË¶Å„ÄåË∑üË∏™ÊâÄÊúâÂàÜÂå∫ÁöÑÂÅèÁßªÈáè„ÄçÔºåÈÄöÂ∏∏‰ºö‰Ωø‰ª£Á†ÅÂèòÂæóÂæàÂ§çÊùÇ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="n">Map&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">TopicPartition&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">OffsetAndMetadata&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">currentOffsets&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">HashMap&lt;/span>&lt;span class="o">&amp;lt;&amp;gt;();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">count&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ConsumerRecords&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">records&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">poll&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">100&lt;/span>&lt;span class="o">);&lt;/span> &lt;span class="c1">// ÂÅáËÆæÊØè‰∏™ÊâπÊ¨° 10000 Êù°Êï∞ÊçÆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">ConsumerRecord&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">record&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">records&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ‰∏öÂä°Â§ÑÁêÜ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">currentOffsets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">put&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">TopicPartition&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">topic&lt;/span>&lt;span class="o">(),&lt;/span> &lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">partition&lt;/span>&lt;span class="o">()),&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">OffsetAndMetadata&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">record&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">offset&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;no metadata&amp;#34;&lt;/span>&lt;span class="o">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">count&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">1000&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="c1">// Âú®ÊØè‰∏™ÊâπÊ¨°‰∏≠ÔºåÊ≤°Â§ÑÁêÜ 1000 Êù°Êï∞ÊçÆÊèê‰∫§‰∏ÄÊ¨° offset
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commitAsync&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">currentOffsets&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">count&lt;/span>&lt;span class="o">++;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="-ÁâπÂÆöoffsetÂºÄÂßãÂ§ÑÁêÜ">ü¶© ÁâπÂÆöoffsetÂºÄÂßãÂ§ÑÁêÜ&lt;/h3>
&lt;p>Â¶ÇÊûúÊÉ≥Ë¶Å‰ªéÂàÜÂå∫ÁöÑËµ∑Âßã/Êú´Â∞æ‰ΩçÁΩÆËØªÂèñÊ∂àÊÅØÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® &lt;code>seekToBeginning(Collection&amp;lt;TopicPartition&amp;gt; tp)&lt;/code> Âíå &lt;code>seekToEnd(Collection&amp;lt;TopicPartition&amp;gt;)&lt;/code>&lt;/p>
&lt;p>ÊúâÊó∂ÔºåÂú®‰∏öÂä°‰∏äÈúÄË¶Å‰ªéÁâπÂÆöÁöÑ offset ÂºÄÂßãËØªÂèñÊ∂àÊÅØÔºåÂèØ‰ª•‰ΩøÁî® &lt;code>seek()&lt;/code> ËøõË°åÊü•Êâæ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// class KafkaConsumer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">seek&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">TopicPartition&lt;/span> &lt;span class="n">partition&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">long&lt;/span> &lt;span class="n">offset&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">seek&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">TopicPartition&lt;/span> &lt;span class="n">partition&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">OffsetAndMetadata&lt;/span> &lt;span class="n">offsetAndMetadata&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÊØîÂ¶ÇÂú®‰∏Ä‰∫õ‰∏öÂä°‰∏≠ÔºåÂØπÊâÄÊúâÁöÑÊìç‰ΩúÈÉΩË¶ÅËøõË°åÂ§ÑÁêÜÔºå‰∏çËÉΩ‰∏¢Â§±Ê∂àÊÅØÔºåÂ§ÑÁêÜÊ∂àÂ§±ÂêéË¶ÅÂ∞ÜÁªìÊûúËÆ∞ÂΩïÂà∞Êï∞ÊçÆÂ∫ì„ÄÅNoSQL Â≠òÂÇ®ÂºïÊìéÁ≠âÂú∞ÊñπÔºåÈúÄË¶ÅÂ∞Ü„Äå‰øùÂ≠òËÆ∞ÂΩï„Äç„ÄåÂÅèÁßªÈáè„ÄçÊîæÂú®‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÈáåÂÆåÊàêÔºåË¶Å‰πàÂÖ®ÈÉ®ÊàêÂäüÔºåË¶Å‰πàÂÖ®ÈÉ®Â§±Ë¥•„ÄÇÂèØ‰ª•Â∞ÜËÆ∞ÂΩïÂíåÂÅèÁßªÈáèÈÉΩ‰øùÂ≠òÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÁî®‰∏Ä‰∏™‰∫ãÂä°Êìç‰ΩúÔºå‰øùËØÅÂéüÂ≠êÊÄß„ÄÇÂΩìÊ∂àË¥πËÄÖÂàÜÈÖçÊñ∞ÂàÜÂå∫Êó∂ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî® &lt;code>seek()&lt;/code> Êü•Êâæ‰øùÂ≠òÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊåáÂÆöoffet‰∫ÜÔºå‰∏ç‰ºö‰∏¢Â§±Êï∞ÊçÆÂíåÈáçÂ§çÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;h2 id="-connect">üñáÔ∏è Connect&lt;/h2>
&lt;h2 id="-stream">üí¶ Stream&lt;/h2>
&lt;!-- raw HTML omitted --></description></item><item><title>Kafka</title><link>https://emerywan.github.io/blog/p/kafka/</link><pubDate>Sat, 04 Mar 2023 11:14:45 +0800</pubDate><guid>https://emerywan.github.io/blog/p/kafka/</guid><description>&lt;img src="https://emerywan.github.io/blog/p/kafka/kafka.webp" alt="Featured image of post Kafka" />&lt;blockquote>
&lt;p>Apache Kafka is an open-source distributed event streaming platform.&lt;/p>
&lt;p>Kafka ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºè‰∫ã‰ª∂ÊµÅÂπ≥Âè∞„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;h2 id="-Âü∫Êú¨Ê¶ÇÂøµ">üìë Âü∫Êú¨Ê¶ÇÂøµ&lt;/h2>
&lt;h3 id="productor--consumer">Productor &amp;amp; Consumer&lt;/h3>
&lt;p>ÊääÊ∂àÊÅØÊîæÂà∞ÈòüÂàóÈáåÈù¢ÁöÑÂè´„ÄåÁîü‰∫ßËÄÖ„ÄçÔºõ‰ªéÈòüÂàó‰∏≠Ê∂àË¥πÊ∂àÊÅØÁöÑÂè´„ÄåÊ∂àË¥πËÄÖ„Äç„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/productor-consumer.png"
width="1482"
height="182"
srcset="https://emerywan.github.io/blog/blog/p/kafka/productor-consumer_hu2c5c2f226caa4e26dde9bd9923036917_30803_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/productor-consumer_hu2c5c2f226caa4e26dde9bd9923036917_30803_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="814"
data-flex-basis="1954px"
>&lt;/p>
&lt;h3 id="topic">Topic&lt;/h3>
&lt;p>Producer Â∞ÜÊ∂àÊÅØÂèëÈÄÅÂà∞ÁâπÂÆöÁöÑ‰∏ªÈ¢ò &lt;code>Topic&lt;/code>ÔºåConsumer ÈÄöËøáËÆ¢ÈòÖÁâπÂÆöÁöÑ‰∏ªÈ¢ò &lt;code>Topic&lt;/code> Êù•Ê∂àË¥πÊ∂àÊÅØ„ÄÇ&lt;/p>
&lt;p>Âπ∂ÈùûÊâÄÊúâÁöÑÊ∂àË¥πËÄÖÈÉΩÊÉ≥Ë¶ÅÂÖ®ÈÉ®ÁöÑÊ∂àÊÅØÔºåÊ∂àË¥πËÄÖÂè™ÂØπËá™Â∑±ÊÑüÂÖ¥Ë∂£ÁöÑ Topic ËøõË°åËÆ¢ÈòÖÔºå‰ªéÊåáÂÆöÁöÑ Topic Êù•Ëé∑ÂèñÊ∂àÊÅØ„ÄÇ
Ëøô‰∏™ÂèëÈÄÅÈóÆÈ¢òÁî± Áîü‰∫ßËÄÖ &lt;code>Product&lt;/code> Êù•Ëß£ÂÜ≥ÔºåÁîü‰∫ßËÄÖÂú®ÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåÂØπÊ∂àÊÅØËøõË°åÈÄªËæë‰∏äÁöÑÂàÜÁ±ªÔºåÂ∞ÜÊ∂àÊÅØÂèëÈÄÅÂà∞ÊåáÂÆöÁöÑ &lt;code>Topic&lt;/code>„ÄÇÔºàÂèëÂ∏É-ËÆ¢ÈòÖÊ®°ÂûãÔºâ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/topic.png"
width="1702"
height="464"
srcset="https://emerywan.github.io/blog/blog/p/kafka/topic_huc74fa2ac18b398764e9e6113e92396e7_102693_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/topic_huc74fa2ac18b398764e9e6113e92396e7_102693_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="366"
data-flex-basis="880px"
>&lt;/p>
&lt;h3 id="offset">offset&lt;/h3>
&lt;p>Â§ö‰∏™Ê∂àË¥πËÄÖÂèØËÉΩÂØπÂêå‰∏Ä‰∏™‰∏ªÈ¢òÊÑüÂÖ¥Ë∂£ÔºåÂç≥Â§ö‰∏™Ê∂àË¥πËÄÖ &lt;code>Consumer&lt;/code> ËÆ¢ÈòÖÂêå‰∏Ä‰∏™‰∏ªÈ¢ò &lt;code>Topic&lt;/code>„ÄÇ&lt;/p>
&lt;p>Ëøô‰∏™Ê∂àË¥πÈóÆÈ¢òÁî± Ê∂àË¥πËÄÖ &lt;code>Consumer&lt;/code> Êù•Ëß£ÂÜ≥„ÄÇ
Kafka Â∞ÜÊâÄÊúâÁöÑÊ∂àÊÅØËøõË°åÊåÅ‰πÖÂåñÂ≠òÂÇ®ÔºåËÆ©Ê∂àË¥πËÄÖÂêÑÂèñÊâÄÈúÄÔºåÊÉ≥ÂèñÂì™‰∏™Ê∂àÊÅØÔºåÊÉ≥‰ªÄ‰πàÊó∂ÂÄôÂèñÈÉΩË°åÔºåÂè™ÈúÄË¶Å‰º†ÈÄí‰∏Ä‰∏™Ê∂àÊÅØÁöÑ &lt;code>offset&lt;/code> Âç≥ÂèØ„ÄÇ&lt;/p>
&lt;p>Kafka Â∞ÜÊ∂àÊÅØ‰ª•Ê∂àÊÅØÊó•ÂøóÁöÑÊñπÂºèËøΩÂä†ÂÜôÂú®Á£ÅÁõò‰∏≠ÔºàÈ°∫Â∫èÁ£ÅÁõò IOÔºâ„ÄÇ&lt;/p>
&lt;p>&lt;code>offset&lt;/code> Ë°®Á§∫‰∫ÜÊ∂àË¥πËÄÖÁöÑÊ∂àË¥πËøõÂ∫¶„ÄÇÊØè‰∏ÄÊù°Ê∂àÊÅØÈÉΩ‰ºöÊ†πÊçÆÊó∂Èó¥ÂÖàÂêéÈ°∫Â∫èÊúâ‰∏Ä‰∏™ÈÄíÂ¢ûÁöÑÂ∫èÂè∑ÔºåÁî® offset Êù•Ë°®Á§∫Ê∂àË¥πËÄÖÁöÑÊ∂àË¥πËøõÂ∫¶Âà∞Âì™‰∫ÜÔºåÊØè‰∏™Ê∂àË¥πËÄÖ‰ºöÈÉΩÊúâËá™Â∑±ÁöÑ offset„ÄÇ&lt;/p>
&lt;p>ÊØèÊ¨°Ê∂àË¥πÊ∂àÊÅØÁöÑÊó∂ÂÄôÔºåÈÉΩË¶ÅÊèê‰∫§Ëøô‰∏™ &lt;code>offset&lt;/code>ÔºåKafka ÂèØ‰ª•ÈÄâÊã©„ÄåËá™Âä®Êèê‰∫§„ÄçÊàñËÄÖ„ÄåÊâãÂä®Êèê‰∫§„Äç„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/offset.png"
width="1702"
height="882"
srcset="https://emerywan.github.io/blog/blog/p/kafka/offset_hub631ed3146c750d7a1db077a25e92c8f_157136_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/offset_hub631ed3146c750d7a1db077a25e92c8f_157136_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="192"
data-flex-basis="463px"
>&lt;/p>
&lt;h3 id="partition">Partition&lt;/h3>
&lt;p>&lt;code>Partition&lt;/code> ÊòØ Kafka „ÄåÊúÄÂü∫Êú¨ÁöÑÈÉ®ÁΩ≤ÂçïÂÖÉ„Äç„ÄÇ&lt;/p>
&lt;p>ÂØπ‰∫éÊµ∑ÈáèÊï∞ÊçÆÔºåÂçïÊú∫ÁöÑÂ≠òÂÇ®ÂÆπÈáèÂíåËØªÂÜôÊÄßËÉΩËÇØÂÆöÊúâÈôêÔºå‰∏ÄÁßçÂ∏∏ËßÅÁöÑÂ≠òÂÇ®ÊñπÊ°àÂ∞±ÊòØ„ÄåÂØπÊï∞ÊçÆËøõË°åÂàÜÁâáÂ≠òÂÇ®„Äç„ÄÇ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>‰æãÂ¶ÇÂú® MySQL ‰∏≠ÔºåÂçïË°®ÁöÑÊï∞ÈáèËææÂà∞Âá†ÂçÉ‰∏á„ÄÅ‰∏ä‰∫øÊó∂Ôºå‰ºöËøõË°åÂàÜÂ∫ì„ÄÅÂàÜË°®Êìç‰Ωú&lt;/p>
&lt;/li>
&lt;li>
&lt;p>‰æãÂ¶ÇÂú® Redis ‰∏≠ÔºåÂΩìÂçï‰∏™ÂÆû‰æãÁöÑÊï∞ÊçÆÈáèËææÂà∞Âá†ÂçÅGÂºïÂèëÊÄßËÉΩÁì∂È¢àÊó∂Ôºå‰ºöËøõË°åÂàÜÁâáÈõÜÁæ§&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Âú® Kafka ‰∏≠ÔºåÂêåÊ†∑ÈááÂèñ‰∫ÜÊ∞¥Âπ≥ÊãÜÂàÜÁöÑÊñπÊ°àÔºåÂ∞ÜÊãÜÂàÜÂêéÁöÑÊï∞ÊçÆÂ≠êÈõÜÁß∞‰∏∫ &lt;code>Partition&lt;/code> ÂàÜÂå∫„ÄÇÂêÑ‰∏™ÂàÜÂå∫ÁöÑÊï∞ÊçÆÈõÜÂêàÂç≥‰∏∫ÂÖ®ÈáèÊï∞ÊçÆ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/partition.png"
width="1902"
height="862"
srcset="https://emerywan.github.io/blog/blog/p/kafka/partition_hu6f8e653e05b83b30cced1268a2afdec4_169756_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/partition_hu6f8e653e05b83b30cced1268a2afdec4_169756_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="220"
data-flex-basis="529px"
>&lt;/p>
&lt;p>ÂàÜÂå∫Ë∑ØÁî±ÂèØ‰ª•ÁÆÄÂçïÂú∞ÁêÜËß£‰∏∫‰∏Ä‰∏™ Hash ÂáΩÊï∞ÔºåÁîü‰∫ßËÄÖÂú®ÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåÂèØ‰ª•Ëá™ÂÆö‰πâËøô‰∏™ÂáΩÊï∞ÁöÑËßÑÂàôÂÜ≥ÂÆöÂèëÂæÄÁöÑÂàÜÂå∫„ÄÇÂ∞ÜÂàÜÂå∫ËßÑÂàôËÆæËÆ°ÁöÑÂêàÁêÜÔºåÂèØ‰ª•Â∞ÜÊ∂àÊÅØÂùáÂåÄÂú∞ÂàÜÈÖçÂà∞‰∏çÂêåÁöÑÂàÜÂå∫‰∏ä„ÄÇ&lt;/p>
&lt;p>Áîü‰∫ßËÄÖ &lt;code>Productor&lt;/code> ÂèëÈÄÅ‰∏ÄÊù°Ê∂àÊÅØÔºåÂÖàÈÄöËøá &lt;code>Topic&lt;/code> ÂØπÊ∂àÊÅØËøõË°åÈÄªËæëÂàÜÁ±ªÔºåÂú®ÈÄöËøá &lt;code>Partition&lt;/code> Ëøõ‰∏ÄÊ≠•ÂÅöÁâ©ÁêÜÂàÜÁâáÔºåÊúÄÁªàÂ§ö‰∏™ Partition ‰ºöÂùáÂåÄÂú∞ÂàÜÂ∏ÉÂú®ÈõÜÁæ§ÁöÑÊØèÂè∞Êú∫Âô®‰∏äÔºå‰ªéËÄåÂæàÂ•ΩÂú∞Ëß£ÂÜ≥‰∫ÜÂ≠òÂÇ®Êâ©Â±ïÊÄßÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;h3 id="broker">Broker&lt;/h3>
&lt;p>‰∏ÄÂè∞ Kafka ÊúçÂä°Âô®Ë¢´Áß∞‰∏∫ &lt;code>Broker&lt;/code>ÔºåKafka ÈõÜÁæ§Áî±Â§öÂè∞ Kafka ÊúçÂä°Âô®ÁªÑÊàê„ÄÇ&lt;/p>
&lt;p>Kafka ÊòØ„ÄåÂ§©ÁÑ∂ÂàÜÂ∏ÉÂºè„ÄçÁöÑ„ÄÇ&lt;/p>
&lt;p>‰∏Ä‰∏™ &lt;code>Topic&lt;/code> ‰ºöË¢´ÂàÜ‰∏∫Â§ö‰∏™ &lt;code>Partition&lt;/code>ÔºåËøô‰∫õ Partition ‰ºöÂàÜÂ∏ÉÂú®‰∏çÂêåÁöÑ &lt;code>Broker&lt;/code> ‰∏≠„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/broker.png"
width="2744"
height="1204"
srcset="https://emerywan.github.io/blog/blog/p/kafka/broker_huddafab0296be063dc2cfa60773db7d44_193217_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/broker_huddafab0296be063dc2cfa60773db7d44_193217_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="227"
data-flex-basis="546px"
>&lt;/p>
&lt;h3 id="leader--follower">leader &amp;amp; follower&lt;/h3>
&lt;p>Âú® Kafka ÈõÜÁæ§‰∏≠ÔºåÊØèÂè∞Êú∫Âô®ÈÉΩ‰ºöÂ≠òÂÇ®‰∏Ä‰∫õ PartitionÔºå‰∏∫‰∫ÜÈò≤Ê≠¢Êú∫Âô®ÂÆïÊú∫Êó∂ÔºåËøôÈÉ®ÂàÜÊï∞ÊçÆÊó†Ê≥ïËÆøÈóÆÁöÑÈóÆÈ¢òÔºàÊåÅ‰πÖÂåñ‰øùËØÅÊï∞ÊçÆ‰∏ç‰∏¢Â§±Ôºâ„ÄÇ
ÈúÄË¶Å Kafka ÂÖ∑Â§áÊïÖÈöúËΩ¨ÁßªËÉΩÂäõÔºåÂΩìÊüêÂè∞Êú∫Âô®ÂÆïÊú∫ÂêéÔºåËÉΩÂ§üÁªßÁª≠‰øùËØÅÊúçÂä°ÂèØÁî®„ÄÇ&lt;/p>
&lt;p>‰∏é Reids Cluster Á±ª‰ººÔºåKafka ÈÄöËøá„ÄåPartition Â§öÂâØÊú¨„ÄçÁöÑÊñπÂºèÔºåËß£ÂÜ≥‰∫ÜÈ´òÂèØÁî®ÈóÆÈ¢ò„ÄÇ
Âú® Kafka ÈõÜÁæ§‰∏≠ÔºåÊØè‰∏™ Partition ÈÉΩÊúâÂ§ö‰∏™ÂâØÊú¨Ôºå‰øùÂ≠ò‰∫ÜÁõ∏ÂêåÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/p>
&lt;p>ÂâØÊú¨‰πãÈó¥ÊòØ „Äå‰∏Ä‰∏ªÂ§ö‰ªé„ÄçÁöÑÂÖ≥Á≥ªÔºö&lt;/p>
&lt;ul>
&lt;li>&lt;code>leader&lt;/code> ÂâØÊú¨Ë¥üË¥£ËØªÂÜôÊï∞ÊçÆ&lt;/li>
&lt;li>&lt;code>follower&lt;/code> ÂâØÊú¨Ë¥üË¥£ÂêåÊ≠•Ê∂àÊÅØÔºåÂè™Ë¥üË¥£ÂæÖÂëΩ&lt;/li>
&lt;/ul>
&lt;p>ÂΩì leader ÂâØÊú¨ÂèëÈÄÅÊïÖÈöúÊó∂ÔºåÈÄâ‰∏æ follower ÂâØÊú¨Êàê‰∏∫Êñ∞ÁöÑ leader ÂØπÂ§ñÊèê‰æõÊúçÂä°„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/leader_follwer.png"
width="1642"
height="982"
srcset="https://emerywan.github.io/blog/blog/p/kafka/leader_follwer_hud0b2c7f759aaa7a9577276a758bf8076_131159_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/leader_follwer_hud0b2c7f759aaa7a9577276a758bf8076_131159_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="167"
data-flex-basis="401px"
>&lt;/p>
&lt;h3 id="consumer-group">Consumer Group&lt;/h3>
&lt;p>Kafka ÊòØ‰∏™È´òÂπ∂ÂèëÁöÑÁ≥ªÁªüÔºåÊ∂àÊÅØÁöÑÊãâÂèñÂêåÊ†∑ÊòØÂπ∂Ë°åÁöÑÔºåÂ§ö‰∏™Ê∂àË¥πËÄÖÂéªÊ∂àË¥π Topic Ê∂àÊÅØ„ÄÇ&lt;/p>
&lt;p>Kafka ÂºïÂÖ•‰∫ÜÊ∂àË¥πËÄÖÁªÑ &lt;code>Consumer Group&lt;/code> ÁöÑÊ¶ÇÂøµÔºåÊØè‰∏Ä‰∏™Ê∂àË¥πËÄÖÈÉΩÊúâ‰∏Ä‰∏™ÂØπÂ∫îÁöÑÊ∂àË¥πËÄÖÁªÑ„ÄÇÁªÑÈó¥ËøõË°åÂπøÊí≠Ê∂àË¥πÔºåÁªÑÂÜÖËøõË°åÈõÜÁæ§Ê∂àË¥π„ÄÇÂêåÊó∂ÈôêÂÆöÔºö„ÄåÊØè‰∏™ Partition Âè™ËÉΩÁî±Ê∂àË¥πËÄÖÁªÑ‰∏≠ÁöÑ‰∏Ä‰∏™Ê∂àË¥πËÄÖËøõË°åÊ∂àË¥π„Äç„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/consumer_group.png"
width="1952"
height="1378"
srcset="https://emerywan.github.io/blog/blog/p/kafka/consumer_group_hu7674cf08adee570cc4acecde56b2e047_315635_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/consumer_group_hu7674cf08adee570cc4acecde56b2e047_315635_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="141"
data-flex-basis="339px"
>&lt;/p>
&lt;p>ÂΩìÈúÄË¶ÅÂä†Âø´Ê∂àÊÅØÁöÑÂ§ÑÁêÜÈÄüÂ∫¶ÔºåÔºàÂ¶ÇÊ∂àË¥πËÄÖÁªÑBÔºâÂè™ÈúÄË¶ÅÂ¢ûÂä†Êñ∞ÁöÑÊ∂àË¥πËÄÖÂç≥ÂèØÔºåKafka ‰ºö‰ª• Patition ‰∏∫Âçï‰ΩçÈáçÊñ∞ÂÅöË¥üËΩΩÂùáË°°„ÄÇ&lt;/p>
&lt;p>‰∏Ä‰∏™Ê∂àË¥πËÄÖÁªÑÂèØ‰ª•Ê∂àË¥π Topic ÁöÑÂÖ®ÈÉ®Êï∞ÊçÆÔºåÊ∂àË¥πËÄÖÁªÑÂú®ÈÄªËæë‰∏äÊòØÁõ∏‰∫íÁã¨Á´ãÁöÑ„ÄÇ&lt;/p>
&lt;h2 id="-Â≠òÂÇ®ÁªìÊûÑ">üó≥Ô∏è Â≠òÂÇ®ÁªìÊûÑ&lt;/h2>
&lt;p>Kafka ‰ΩøÁî®„ÄåÊó•ÂøóÊñá‰ª∂ Logging„ÄçÁöÑÊñπÂºèÊù•Â≠òÂÇ®Ê∂àÊÅØÔºõ‰ΩøÁî®„ÄåÁ®ÄÁñèÂìàÂ∏åÁ¥¢Âºï„ÄçÊù•Âä†Âø´Êü•ËØ¢„ÄÇ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Kafka Â≠òÂÇ®ÁöÑ‰∏ªË¶ÅÊòØÊ∂àÊÅØÊµÅÔºàÊñáÊú¨„ÄÅËá™ÂÆö‰πâÊ†ºÂºèÔºâÔºåÂØπ‰∫é Broker Êù•ËØ¥ÔºåÂè™ÈúÄË¶ÅÂÖ≥Ê≥®Ê∂àÊÅØÁöÑÊäïÈÄíÔºåÊó†ÈúÄÂÖ≥Ê≥®ÂÜÖÂÆπÊú¨Ë∫´&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÂÜôÂÖ•ÊñπÈù¢ÔºåÊï∞ÊçÆÈáèÁ∫ßÈùûÂ∏∏Â§ßÔºåÈÉΩÊòØÊåâÈ°∫Â∫èÂÜôÂÖ•ÔºàÈòüÂàóÔºâÔºå‰∏îÊó†ÈúÄËÄÉËôëÊõ¥Êñ∞&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÈúÄÊ±ÇÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÊåâÁÖß offset Êü•ËØ¢Ê∂àÊÅØÂç≥ÂèØ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Âú®‰∏∫‰∫ÜÊª°Ë∂≥ÂÖ∂ÂÜôÂÖ•ÈúÄÊ±ÇÔºàÈáèÁ∫ßÂ§ß„ÄÅ‰∏çÊõ¥Êñ∞ÔºâÔºåÈááÁî® Append ËøΩÂä†Êó•ÂøóÁöÑÊñπÂºèÊúÄÁêÜÊÉ≥ÔºåÂèØ‰ª•ÂÖÖÂàÜÂà©Áî®„ÄåÁ£ÅÁõòÈ°∫Â∫è IO„Äç„ÄÇ&lt;/p>
&lt;p>Âú®Êü•ËØ¢Êó∂ÔºåÂè™ÈúÄË¶ÅÈÄöËøá offset ÂÆö‰ΩçÊ∂àÊÅØÔºåÂú®ÂÜÖÂ≠ò‰∏≠Áª¥Êä§‰∫Ü‰∏Ä‰∏™„Äå‰ªé offset Âà∞Êó•ÂøóÊñá‰ª∂ÁöÑÂÅèÁßªÈáè„ÄçÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÔºåÊØèÊ¨°
Êü•ËØ¢Êó∂ÔºåÂÖàÊ†πÊçÆ offset ÊâæÂà∞Êó•ÂøóÊñá‰ª∂ÁöÑÂÅèÁßªÈáèÔºåÂç≥ÂèØÂø´ÈÄüËØªÂèñÂà∞Êó•ÂøóÊ∂àÊÅØ„ÄÇ&lt;/p>
&lt;p>‰∏∫‰∫ÜÈÅøÂÖçÂìàÂ∏åÁ¥¢ÂºïÂ∏∏È©ªÂÜÖÂ≠òÊ∂àËÄóËøáÂ§öÁ©∫Èó¥ÁöÑÈóÆÈ¢òÔºåÂ∞ÜÊ∂àÊÅØÂàíÂàÜ‰∏∫Ëã•Âπ≤‰∏™Âùó blockÔºåÊØè‰∏™Á¥¢ÂºïÈúÄË¶ÅÂÆö‰Ωç block Âùó‰∏≠ÁöÑÁ¨¨‰∏ÄÊù°Ê∂àÊÅØÁöÑ offset Âç≥ÂèØÔºàÁ®ÄÁñèÁ¥¢ÂºïÔºâÔºå
ÁÑ∂ÂêéÂú® block ‰∏≠È°∫Â∫èÊü•Êâæ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/hash.png"
width="702"
height="486"
srcset="https://emerywan.github.io/blog/blog/p/kafka/hash_hu74f0171d0dcbf8a19203c6a91442ff0f_91411_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/hash_hu74f0171d0dcbf8a19203c6a91442ff0f_91411_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="144"
data-flex-basis="346px"
>&lt;/p>
&lt;h2 id="-kafka-ÁöÑÈ´òÊÄßËÉΩ">üî• Kafka ÁöÑÈ´òÊÄßËÉΩ&lt;/h2>
&lt;p>&lt;img src="https://emerywan.github.io/blog/blog/p/kafka/performance.png"
width="725"
height="662"
srcset="https://emerywan.github.io/blog/blog/p/kafka/performance_hu3423f3489c82f749f8bb253d443fb73a_35239_480x0_resize_box_3.png 480w, https://emerywan.github.io/blog/blog/p/kafka/performance_hu3423f3489c82f749f8bb253d443fb73a_35239_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="109"
data-flex-basis="262px"
>&lt;/p>
&lt;h3 id="-Áîü‰∫ßÊ∂àÊÅØ">üìë Áîü‰∫ßÊ∂àÊÅØ&lt;/h3>
&lt;p>Kafka ÂÆ¢Êà∑Á´Ø‰∏é‰º†ÁªüÁöÑÊï∞ÊçÆÂ∫ìÊàñÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰∏çÂêåÔºåÂú®Â∞ÜÊ∂àÊÅØÂèëÈÄÅÁªô Broker ‰πãÂâçÔºåÂú® Client Á´ØÂÖàÂÆåÊàêÂ§ßÈáèÁöÑÂ∑•‰Ωú‰πãÂêéÊâçÂèëÈÄÅÊ∂àÊÅØÔºåÂàÜÊëä Broker ÁöÑËÆ°ÁÆóÂéãÂäõ„ÄÇ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ü´ß ÊâπÈáèÂèëÈÄÅ&lt;/p>
&lt;p>Kafka ÈÄöËøáÂØπÂ§öÊù°Ê∂àÊÅØÊåâÁÖßÂàÜÂå∫ËøõË°åÂàÜÁªÑÔºåÊØèÊ¨°ÂèëÈÄÅ‰∏Ä‰∏™Ê∂àÊÅØÈõÜÂêàÔºå‰ªéËÄåÂáèÂ∞ëÁΩëÁªú‰º†ËæìÁöÑÂºÄÈîÄ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ü´ß Ê∂àÊÅØÂéãÁº©&lt;/p>
&lt;p>Âú®ÊâπÈáèÂèëÈÄÅÁöÑÂâçÊèê‰∏ãÔºåÂØπÊ∂àÊÅØËøõË°åÂéãÁº©ÔºàÊï∞ÊçÆÈáèË∂äÂ§ßÔºåÂéãÁº©ÊïàÊûúÊõ¥Â•ΩÔºâ„ÄÇÂêåÊó∂ÂØπÂ§öÊù°Ê∂àÊÅØËøõË°åÂéãÁº©ÔºåËÉΩÂ§ßÂπÖÂáèÂ∞ëÊï∞ÊçÆÈáèÔºå
ÂêåÊó∂ÂáèÂ∞ëÁΩëÁªú„ÄÅÁ£ÅÁõòIOÂºÄÈîÄ„ÄÇÊ∂àÊÅØÊåÅ‰πÖÂåñÂà∞ Broker ÁöÑÁ£ÅÁõòÊó∂Ôºå‰æùÊóßÊòØÂéãÁº©Áä∂ÊÄÅÔºåÊúÄÁªàÊòØÂú® Consumer Á´ØËøõË°åËß£Âéã„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ü´ß È´òÊïàÂ∫èÂàóÂåñ&lt;/p>
&lt;p>Kafka ÁöÑ Key Âíå ValueÔºåÈÉΩÊîØÊåÅËá™ÂÆö‰πâÁ±ªÂûãÔºåÂè™ÈúÄË¶ÅÊèê‰æõÁõ∏Â∫îÁöÑÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÂô®Âç≥ÂèØ„ÄÇÂèØ‰ª•Ê†πÊçÆÊÉÖÂÜµÈÄâÂèñÂØπÂ∫îÁöÑÂ∫èÂàóÂåñÊñπÂºè„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;/li>
&lt;li>
&lt;p>ü´ß ÂÜÖÂ≠òÊ±†Â§çÁî®&lt;/p>
&lt;p>Kafka ÊèêÂá∫‰∫Ü„ÄåÂÜÖÂ≠òÊ±†Êú∫Âà∂„ÄçÔºåÊèêÈ´òÂ§çÁî®ÔºåÂáèÂ∞ëÈ¢ëÁπÅÁöÑÂàõÂª∫ÂíåÂõûÊî∂„ÄÇÔºàÊú¨Ë¥®‰∏ä‰∏éËøûÊé•Ê±†„ÄÅÁ∫øÁ®ãÊ±†‰∏ÄÊ†∑Ôºâ„ÄÇ&lt;/p>
&lt;p>Productor Âú®ÂàõÂª∫Êó∂Ôºå‰ºöÂç†Áî®‰∏ÄÂùóÂõ∫ÂÆöÂ§ßÂ∞èÁöÑÂÜÖÂ≠òÂå∫ÂüüÔºåÂàíÂàÜ‰∏∫Ëã•Âπ≤‰∏™ÂùóÔºà‰æãÂ¶Ç 16KBÔºâ„ÄÇÂΩìÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂèëÈÄÅ Batch Êó∂ÔºåÁõ¥Êé•‰ªéÂÜÖÂ≠ò‰∏≠ÂèñÂá∫‰∏Ä‰∏™ÂùóÔºå
‰ªé‰∏≠‰∏çÊñ≠Âú∞ÂÜôÂÖ•Ê∂àÊÅØÔºàÂÜôÊª°ÊàñÂà∞ÊåáÂÆöÈòàÂÄºÊó∂Èó¥Êó∂ÔºâÔºåÂ∞ÜËøô‰∏™ Batch ÂèëÈÄÅÁªô BrokerÔºå‰πãÂêéÂÜÖÂ≠òÂùóÂ∞±‰ºöÂõûÂà∞ÁºìÂ≠òÊ±†‰∏≠ÁªßÁª≠Â§çÁî®„ÄÇ
‰∏ç‰ºöÊ∂âÂèä JVM ÁöÑÂÜÖÂ≠òÂõûÊî∂Ôºå‰ª•Â∫îÂØπ Kafka ÁöÑÈ´òÂπ∂ÂèëÂú∫ÊôØ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-Â≠òÂÇ®Ê∂àÊÅØ">üìá Â≠òÂÇ®Ê∂àÊÅØ&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>ü´ß IO Â§öË∑ØÂ§çÁî®&lt;/p>
&lt;p>‰ΩøÁî® &lt;code>1&lt;/code> ‰∏™ &lt;code>Acceptor&lt;/code> Á∫øÁ®ãÔºåÂ§ÑÁêÜÊñ∞ÁöÑËøûÊé•Ôºõ‰ΩøÁî® &lt;code>N&lt;/code> ‰∏™ &lt;code>Processor&lt;/code> Á∫øÁ®ãÔºåËØªÂèñËØ∑Ê±ÇÔºõ‰ΩøÁî® &lt;code>M&lt;/code> ‰∏™ &lt;code>Handler&lt;/code> Á∫øÁ®ãÔºåÂ§ÑÁêÜ‰∏öÂä°ÈÄªËæë„ÄÇ&lt;/p>
&lt;p>&lt;code>1&lt;/code> ‰∏™ &lt;code>Acceptor&lt;/code> Á∫øÁ®ãÔºöÁî®‰∫éÁõëÂê¨ÁΩëÁªúÂ•óÊé•Â≠óÔºåÊé•ÂèóËØ∑Ê±ÇÔºåÁÑ∂ÂêéÂ∞ÜËØ∑Ê±ÇÊ¥æÂèëÁªô Processor Á∫øÁ®ãÊ±†‰∏≠ÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÊù•Â§ÑÁêÜ„ÄÇ
‰∏é Redis Áõ∏ÂêåÔºåIO Â§öË∑ØÂ§çÁî®ÂÖÅËÆ∏ÂÜÖÊ†∏‰∏≠ÂêåÊó∂ÁÆ°ÁêÜÂ§ö‰∏™ scoket ËøûÊé•ÔºåÂÜÖÊ†∏‰ºö‰∏ÄÁõ¥ÁõëÂê¨Ëøô‰∫õËøûÊé•Ôºå‰∏ÄÊó¶ÊúâËØ∑Ê±ÇÂà∞ËææÔºåÂ∞±‰ºöÈÄöÁü•Â§ÑÁêÜÁ∫øÁ®ãÔºåËææÂà∞‰∏Ä‰∏™Á∫øÁ®ãÂ§ÑÁêÜÂ§ö‰∏™ËØ∑Ê±ÇÁöÑÊïàÊûú„ÄÇ&lt;/p>
&lt;p>&lt;code>N&lt;/code> ‰∏™ &lt;code>Processor&lt;/code> Á∫øÁ®ãÔºöKafka ‰ºöÁª¥Êä§‰∏Ä‰∏™Á∫øÁ®ãÊ±†ÔºåÂ∞ÜËØ∑Ê±ÇÂàÜÂèëÁªôÂèØÁî®ÁöÑ Processor Á∫øÁ®ãÂ§ÑÁêÜ„ÄÇ‰∏ªË¶ÅË¥üË¥£‰ªéÂ•óÊé•Â≠óËØªÂèñÊ∂àÊÅØÔºåËß£ÊûêÂ§ÑÁêÜÔºåÂπ∂Â∞ÜÂìçÂ∫îÂèëÈÄÅÁªôÂÆ¢Êà∑Á´Ø„ÄÇËææÂà∞ÊâπÈáèÊìç‰ΩúÔºåÊèêÈ´òÂêûÂêêÈáè„ÄÇ&lt;/p>
&lt;p>&lt;code>M&lt;/code> ‰∏™ &lt;code>Handler&lt;/code> Á∫øÁ®ãÔºöÁª¥Êä§ÁöÑÁ∫øÁ®ãÊ±†ÔºåË¥üË¥£ËØªÂèñ Kafka Topic ‰∏≠ÁöÑÊ∂àÊÅØÔºåÂπ∂Â∞ÜÂÖ∂Êèê‰∫§Âà∞ÂØπÂ∫îÁöÑ Consumer Group„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ü´ß Á£ÅÁõòÈ°∫Â∫è IO&lt;/p>
&lt;p>Kafka ÈááÁî®Êó•ÂøóÊñá‰ª∂ÁöÑÊñπÂºèÊåÅ‰πÖÂåñÊó•ÂøóÔºå‰ª• Append Only ÁöÑÊñπÂºèËøΩÂä†Âà∞Êñá‰ª∂Êú´Â∞æÔºåÈ°∫Â∫è IO ‰ΩøÂÜôÂÖ•ÈÄüÂ∫¶ÈùûÂ∏∏Âø´„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ü´ß Page Cache&lt;/p>
&lt;p>Âà©Áî®‰∫ÜÊìç‰ΩúÁ≥ªÁªüÊú¨Ë∫´ÁöÑÁºìÂ≠òÊäÄÊúØÔºåÂú®ËØªÂÜôÁ£ÅÁõòÊñá‰ª∂Êó∂ÔºåÂÖ∂ÂÆûÊìç‰ΩúÁöÑÈÉΩÊòØÂÜÖÂ≠òÔºåÁî±Êìç‰ΩúÁ≥ªÁªüÂÜ≥ÂÆö‰ªÄ‰πàÊó∂ÂÄôÂ∞Ü Page Cache ‰∏≠ÁöÑÊï∞ÊçÆÁúüÊ≠£Âà∑ÂÖ•Á£ÅÁõò„ÄÇ&lt;/p>
&lt;p>Page Cache ÁºìÂ≠ò‰∏≠‰øùÂ≠òÁöÑÊòØÊúÄËøëÂèØËÉΩË¢´‰ΩøÁî®ÁöÑÁ£ÅÁõòÊï∞ÊçÆÔºåÂÖ∑ÊúâÊó∂Èó¥Â±ÄÈÉ®ÊÄßÔºàÊúÄËøëËÆøÈóÆÁöÑÊï∞ÊçÆÂèØËÉΩÂÜçÊ¨°ËÆøÈóÆÔºâÂíå Á©∫Èó¥Â±ÄÈÉ®ÊÄßÔºàËÆøÈóÆÁöÑÊï∞ÊçÆÁöÑÂë®ËæπÊï∞ÊçÆË¢´ËÆøÈóÆÁöÑÊ¶ÇÁéáÊûÅÈ´òÔºâ„ÄÇ
‰Ωú‰∏∫È°∫Â∫èÂÜôÂÖ•ÁöÑÊ∂àÊÅØÈòüÂàóÔºåÂ¶ÇÊûúÁîü‰∫ßÂíåÊ∂àË¥πÂú∞ÁâπÂà´Âø´ÔºåÂà©Áî® Broker Page CacheÔºåÁîöËá≥ÂèØ‰ª•‰∏çÁªèËøáÁ£ÅÁõòÂÆåÊàêÊìç‰Ωú„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;/li>
&lt;li>
&lt;p>ü´ß ÂàÜÂå∫ÂàÜÊÆµÁªìÊûÑ&lt;/p>
&lt;p>Kafka ÁöÑ Topic ‰ºöË¢´ÂàÜÂå∫‰∏∫Â§ö‰∏™ PartitionÔºåÂú®Â§öÂè∞ Broker ‰∏≠Ôºå‰ΩøÁî®Â§ö‰∏™ÊúçÂä°Êù•Êé•ÂèóÊ∂àÊÅØ„ÄÇ&lt;/p>
&lt;p>ÂêåÊó∂ÊØè‰∏™ÂàÜÂå∫ Partition ‰ºöË¢´ÂàÜ‰∏∫Â§ö‰∏™ÊÆµ Segment Êù•ÁÆ°ÁêÜÔºåÊØè‰∏™ÊÆµÂÜÖÈÉΩÊòØÈ°∫Â∫èÂÜôÔºåÈÅøÂÖçÂàÜÂå∫ËøáÂ§ßÔºåÂà©‰∫éÁÆ°ÁêÜ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="-Ê∂àË¥πÊ∂àÊÅØ">üìÆ Ê∂àË¥πÊ∂àÊÅØ&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>ü´ß Á®ÄÁñèÁ¥¢Âºï&lt;/p>
&lt;p>Kafka Êü•ËØ¢Âú∫ÊôØÈùûÂ∏∏ÁÆÄÂçïÔºåÊåâÁÖß offset Êü•ËØ¢Ê∂àÊÅØÂç≥ÂèØ„ÄÇ‰∏∫‰∫ÜÂä†Âø´ËØªÊìç‰ΩúÔºåÂè™ÈúÄË¶ÅÂú®ÂÜÖÂ≠ò‰∏≠Áª¥Êä§‰∏Ä‰∏™ offset Âà∞Êó•ÂøóÊñá‰ª∂ÁöÑÂÅèÁßªÈáèÁöÑÊò†Â∞ÑÂÖ≥Á≥ª &lt;code>Map&lt;/code> Âç≥ÂèØ„ÄÇ
ÊØèÊ¨°Êü•ÊâæÊ∂àÊÅØÔºåÂÖà‰ªéÂìàÂ∏åË°®‰∏≠Êü•Âà∞Êñá‰ª∂ÂÅèÁßªÈáèÔºåÂÜçÂéªËØªÊó•ÂøóÊñá‰ª∂„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ü´ß mmap&lt;/p>
&lt;p>&lt;code>memory mapped files&lt;/code>&lt;/p>
&lt;p>ÈááÁî® mmap Êò†Â∞ÑÁ¥¢ÂºïÊñá‰ª∂ÔºåÂä†Âø´Á¥¢ÂºïÁöÑÊü•ÊâæËøáÁ®ã„ÄÇÂ∞ÜÁ£ÅÁõòÊñá‰ª∂‰∏éÂÜÖÂ≠òËôöÊãüÂú∞ÂùÄÂÅö‰∫ÜÊò†Â∞ÑÔºå‰∏çÈúÄË¶ÅÊìç‰ΩúÁ£ÅÁõòIOÔºåËøõÁ®ãÂèØ‰ª•‰ΩøÁî®ÊåáÈíàÁöÑÊñπÂºèÊìç‰ΩúËøô‰∏ÄÂùóÂÜÖÂ≠òÔºåÁ≥ªÁªü‰ºöËá™Âä®Â∞ÜËÑèÈ°µÂÜôÂÖ•Âà∞ÂØπÂ∫îÁöÑÁ£ÅÁõòÊñá‰ª∂‰∏ä„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;/li>
&lt;li>
&lt;p>ü´ß Èõ∂Êã∑Ë¥ù&lt;/p>
&lt;p>ÈááÁî®‰∫ÜÈõ∂Êã∑Ë¥ùÔºåÂ∞ÜÊï∞ÊçÆ‰ªéÂÜÖÂ≠ò‰∏≠ÁöÑÁºìÂ≠òÂå∫Áõ¥Êé•Êã∑Ë¥ùÂà∞ÁΩëÂç°ËÆæÂ§áÔºåÊó†ÈúÄÁªèËøáÂ∫îÁî®Á®ãÂ∫èÔºåÂáèÂ∞ë‰∫ÜÊï∞ÊçÆÁöÑÊã∑Ë¥ùÂíåÂÜÖÊ†∏ÊÄÅ‰∏éÁî®Êà∑ÊÄÅÁöÑÂàáÊç¢„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;/li>
&lt;li>
&lt;p>ü´ß ÊâπÈáèÊãâÂèñ&lt;/p>
&lt;p>‰∏éÂèëÈÄÅÊ∂àÊÅØÂØπÂ∫îÔºåÊ∂àË¥πÊ∂àÊÅØ‰πüÊòØÊâπÈáèÊãâÂèñÁöÑÔºåÊØèÊ¨°ÊãâÂèñ‰∏Ä‰∏™Ê∂àÊÅØÈõÜÂêàÔºåÂáèÂ∞ëÁΩëÁªúÁöÑÂºÄÈîÄ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="ÂèÇËÄÉ">ÂèÇËÄÉ&lt;/h2>
&lt;ul>
&lt;li>&lt;a class="link" href="https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;amp;mid=2247490102&amp;amp;idx=1&amp;amp;sn=68d55b3c5ac74038c76d6837b862a11c&amp;amp;chksm=fc78c51acb0f4c0cd5a1d6ceedb9948f82d48791ab789e9edfd6e83e34fbad1ace5749bee203&amp;amp;scene=21#wechat_redirect" target="_blank" rel="noopener"
>https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;mid=2247490102&amp;idx=1&amp;sn=68d55b3c5ac74038c76d6837b862a11c&amp;chksm=fc78c51acb0f4c0cd5a1d6ceedb9948f82d48791ab789e9edfd6e83e34fbad1ace5749bee203&amp;scene=21#wechat_redirect&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;amp;mid=2247490102&amp;amp;idx=1&amp;amp;sn=68d55b3c5ac74038c76d6837b862a11c&amp;amp;chksm=fc78c51acb0f4c0cd5a1d6ceedb9948f82d48791ab789e9edfd6e83e34fbad1ace5749bee203&amp;amp;cur_album_id=1763234202604388353&amp;amp;scene=189#wechat_redirect" target="_blank" rel="noopener"
>https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;mid=2247490102&amp;idx=1&amp;sn=68d55b3c5ac74038c76d6837b862a11c&amp;chksm=fc78c51acb0f4c0cd5a1d6ceedb9948f82d48791ab789e9edfd6e83e34fbad1ace5749bee203&amp;cur_album_id=1763234202604388353&amp;scene=189#wechat_redirect&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;amp;mid=2247491055&amp;amp;idx=1&amp;amp;sn=14bc485f91ec2629cc9e8bf7a36ad8f4&amp;amp;chksm=fc78c2c3cb0f4bd566d5ca2534805839420ad3dc67210bc8f2b7ef05283785b02b8ddef640a8&amp;amp;cur_album_id=1763234202604388353&amp;amp;scene=189#wechat_redirect" target="_blank" rel="noopener"
>https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;mid=2247491055&amp;idx=1&amp;sn=14bc485f91ec2629cc9e8bf7a36ad8f4&amp;chksm=fc78c2c3cb0f4bd566d5ca2534805839420ad3dc67210bc8f2b7ef05283785b02b8ddef640a8&amp;cur_album_id=1763234202604388353&amp;scene=189#wechat_redirect&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;amp;mid=2247491168&amp;amp;idx=1&amp;amp;sn=bd37f96692b3f7cecdaf3172abdb7a8c&amp;amp;chksm=fc78c14ccb0f485a451f70c7ffbf5b05d0f500dfef6321703e7cdebdc0de902d9d77a547d469&amp;amp;cur_album_id=1763234202604388353&amp;amp;scene=189#wechat_redirect" target="_blank" rel="noopener"
>https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;mid=2247491168&amp;idx=1&amp;sn=bd37f96692b3f7cecdaf3172abdb7a8c&amp;chksm=fc78c14ccb0f485a451f70c7ffbf5b05d0f500dfef6321703e7cdebdc0de902d9d77a547d469&amp;cur_album_id=1763234202604388353&amp;scene=189#wechat_redirect&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;amp;mid=2247491507&amp;amp;idx=1&amp;amp;sn=f1bec356c94cd0101809dc11dcf27ba2&amp;amp;chksm=fc78c09fcb0f49898f6cc9b80499aeb871a80f95ab4fbe12c32567cab6a3521a6c33b61dd807&amp;amp;cur_album_id=1763234202604388353&amp;amp;scene=189#wechat_redirect" target="_blank" rel="noopener"
>https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;mid=2247491507&amp;idx=1&amp;sn=f1bec356c94cd0101809dc11dcf27ba2&amp;chksm=fc78c09fcb0f49898f6cc9b80499aeb871a80f95ab4fbe12c32567cab6a3521a6c33b61dd807&amp;cur_album_id=1763234202604388353&amp;scene=189#wechat_redirect&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;amp;mid=2247491763&amp;amp;idx=1&amp;amp;sn=cc60a6ba13e5cf4384e623819c621e0d&amp;amp;chksm=fc7b3f9fcb0cb6897be67103d91854831b71909c0d12385fb52b2f1d011fca5d1844b3892019&amp;amp;cur_album_id=1763234202604388353&amp;amp;scene=190#rd" target="_blank" rel="noopener"
>https://mp.weixin.qq.com/s?__biz=MzU2MTM4NDAwMw==&amp;mid=2247491763&amp;idx=1&amp;sn=cc60a6ba13e5cf4384e623819c621e0d&amp;chksm=fc7b3f9fcb0cb6897be67103d91854831b71909c0d12385fb52b2f1d011fca5d1844b3892019&amp;cur_album_id=1763234202604388353&amp;scene=190#rd&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>