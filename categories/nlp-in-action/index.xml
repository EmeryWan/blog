<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NLP in action on ‰∏ÄÂ±Ç</title><link>https://blog.letout.cn/categories/nlp-in-action/</link><description>Recent content in NLP in action on ‰∏ÄÂ±Ç</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Sat, 01 Jan 2022 01:00:00 +0800</lastBuildDate><atom:link href="https://blog.letout.cn/categories/nlp-in-action/index.xml" rel="self" type="application/rss+xml"/><item><title>Long Shorter Term Memory</title><link>https://blog.letout.cn/p/nlp-in-action/long-short-term-memory/</link><pubDate>Sat, 19 Mar 2022 20:36:14 +0800</pubDate><guid>https://blog.letout.cn/p/nlp-in-action/long-short-term-memory/</guid><description>&lt;img src="https://nlp.letout.cn/img/banner.png" alt="Featured image of post Long Shorter Term Memory" />&lt;p>Ëøô‰∏ÄËäÇÔºåÂ∞Ü‰ªãÁªç &lt;code>LSTM (Long Shorter Term Memory)&lt;/code>Ôºå‰ª•ÂèäÁî® &lt;code>pytorch&lt;/code> ÂÆûÁé∞ &lt;code>LSTM &lt;/code>„ÄÇ&lt;/p>
&lt;p>&lt;code>LSTM&lt;/code> ÊòØ‰∏ÄÁßç &lt;code>RNN&lt;/code> Ê®°ÂûãÔºåÊòØÂØπ &lt;code>simple RNN&lt;/code> ÁöÑÊîπËøõÔºå&lt;code>LSTM&lt;/code> ÂèØ‰ª•ÈÅøÂÖçÊ¢ØÂ∫¶Ê∂àÂ§±ÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•ÊúâÊõ¥ÈïøÁöÑËÆ∞ÂøÜ„ÄÇ&lt;code>LSTM&lt;/code> ÁöÑËÆ∫ÊñáÂú® 1997 Âπ¥ÂèëË°®„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>Hochreiter and Schmidhuber. Long short-term memory. Neural computation, 1997.&lt;/p>
&lt;/blockquote>
&lt;h2 id="-lstm">üîñ LSTM&lt;/h2>
&lt;p>&lt;code>LSTM&lt;/code> ‰πüÊòØ‰∏ÄÁßçÂæ™ÁéØÁ•ûÁªèÁΩëÁªúÔºåÂéüÁêÜË∑ü &lt;code>simple RNN&lt;/code> Â∑Æ‰∏çÂ§öÔºåÊØèÂΩìËØªÂèñ‰∏Ä‰∏™Êñ∞ÁöÑËæìÂÖ• $x$ÔºåÂ∞±‰ºöÊõ¥Êñ∞Áä∂ÊÄÅ $h$„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/1.png"
loading="lazy"
alt="1"
>&lt;/p>
&lt;p>&lt;code>LSTM&lt;/code> ÁöÑÁªìÊûÑÊØî &lt;code>simple RNN&lt;/code> Ë¶ÅÂ§çÊùÇÂæàÂ§öÔºå&lt;code>simple RNN&lt;/code> Âè™Êúâ‰∏Ä‰∏™ÂèÇÊï∞Áü©ÈòµÔºå &lt;code>LSTM&lt;/code> ÊúâÂõõ‰∏™ÂèÇÊï∞Áü©Èòµ„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨ÂÖ∑‰ΩìÊù•ÁúãÁúã &lt;code>LSTM&lt;/code> ÁöÑÂÜÖÈÉ®ÁªìÊûÑ„ÄÇ&lt;/p>
&lt;h3 id="-‰º†ÈÄÅÂ∏¶">üö† ‰º†ÈÄÅÂ∏¶&lt;/h3>
&lt;p>&lt;code>LSTM&lt;/code> ÊúÄÈáçË¶ÅÁöÑËÆæËÆ°ÊòØËøô‰∏™‰º†ÈÄÅÂ∏¶ &lt;code>Conveyor belt&lt;/code>ÔºåÂç≥‰∏∫ÂêëÈáè $C$„ÄÇËøáÂéªÁöÑ‰ø°ÊÅØÈÄöËøá‰º†ÈÄÅÂ∏¶ÔºåÁõ¥Êé•ÈÄÅÂà∞‰∏ã‰∏Ä‰∏™Êó∂ÂàªÔºå‰∏ç‰ºöÂèëÁîüÂ§™Â§ßÁöÑÂèòÂåñ„ÄÇ&lt;code>LSTM&lt;/code> Â∞±ÊòØÈù†‰º†ÈÄÅÂ∏¶Êù•ÈÅøÂÖçÊ¢ØÂ∫¶Ê∂àÂ§±ÁöÑÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/2.png"
loading="lazy"
alt="2"
>&lt;/p>
&lt;p>&lt;code>LSTM&lt;/code> ‰∏≠ÊúâÂæàÂ§ö‰∏™Èó® &lt;code>gate&lt;/code>ÔºåÂèØ‰ª•ÊúâÈÄâÊã©ÁöÑËÆ©‰ø°ÊÅØÈÄöËøá„ÄÇ&lt;/p>
&lt;h3 id="-forgate-gate">üö™ Forgate Gate&lt;/h3>
&lt;p>È¶ñÂÖà‰ªãÁªç &lt;code>forget gate&lt;/code> ÈÅóÂøòÈó®„ÄÇÈÅóÂøòÈó®Áî± ‚òòÔ∏è &lt;code>sigmoid&lt;/code> ÂáΩÊï∞ÔºåÂíå üçÄ ÂÖÉÁ¥†ÁßØ &lt;code>element wise multiplication&lt;/code> ‰∏§ÈÉ®ÂàÜÁªÑÊàê„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/3.png"
loading="lazy"
alt="3"
>&lt;/p>
&lt;p>üåº ËæìÂÖ• &lt;code>sigmoid&lt;/code> ÁöÑÊòØ‰∏Ä‰∏™ÂêëÈáè $a$Ôºå&lt;code>sigmoid&lt;/code> ‰ΩúÁî®Âà∞ÂêëÈáè $a$ ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†‰∏äÔºåÊääÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩÂéãÂà∞ &lt;code>0&lt;/code> Âíå &lt;code>1&lt;/code> ‰πãÈó¥„ÄÇ&lt;/p>
&lt;p>‰∏æ‰∏™‰æãÂ≠êÔºåÂÅáÂ¶ÇÂêëÈáè $a$ ÊòØÔºö&lt;code>[1, 3, 0, -2]&lt;/code>ÔºåÈÇ£‰πàÔºå&lt;code>sigmoid&lt;/code> ÂáΩÊï∞Â∞ÜÂàÜÂà´‰ΩúÁî®Âú®ËøôÂõõ‰∏™ÂÖÉÁ¥†‰∏ä„ÄÇÁÑ∂ÂêéÂàÜÂà´ËæìÂá∫Ôºö&lt;code>[0.73, 0.95, 0.5, 0.12]&lt;/code> „ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/4.png"
loading="lazy"
alt="4"
>&lt;/p>
&lt;p>ËæìÂÖ•ÁöÑÂêëÈáè $a$Ôºå‰∏éËæìÂá∫ÁöÑÂêëÈáè $f$ Â∫îËØ•ÊúâÁõ∏ÂêåÁöÑÁª¥Â∫¶ÔºåËøô‰∏™‰æãÂ≠êÈáåÔºåÂêëÈáè $a$ ÊòØÂõõÁª¥ÁöÑÔºåÂêëÈáè $f$ ‰πü‰ºöÊòØÂõõÁª¥ÁöÑ„ÄÇ&lt;/p>
&lt;p>üå∏ ÁÆóÂá∫ $f$ ÂêëÈáè‰πãÂêéÔºåËÆ°ÁÆó‰º†ÈÄÅÂ∏¶ÂêëÈáè $c$ ‰∏éÈÅóÂøòÈó®ÂêëÈáè $f$ ÁöÑÂÖÉÁ¥†ÁßØ„ÄÇÂÖÉÁ¥†ÁßØ &lt;code>element wise multiplication&lt;/code> ÊòØËøôÊ†∑ÁÆóÁöÑÔºö&lt;/p>
&lt;p>$c$ Âíå $f$ ÈÉΩÊòØÂõõÁª¥ÁöÑÂêëÈáèÔºåÂ∞ÜÂÆÉ‰ª¨ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÂàÜÂà´Áõ∏‰πò„ÄÇÊâÄ‰ª•ÂÖÉÁ¥†ÁßØÁöÑÁªìÊûú‰πüÊòØ‰∏™ÂõõÁª¥ÁöÑÂêëÈáè„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/5.png"
loading="lazy"
alt="5"
>&lt;/p>
&lt;p>Ëøô‰∏™ÈÅóÂøòÈó® $f$ÔºåÊúâÈÄâÊã©ÁöÑËÆ©‰º†ÈÄÅÂ∏¶ $c$ ÁöÑÂÄºÈÄöËøáÔºö&lt;/p>
&lt;ul>
&lt;li>
&lt;p>üå∞ ÂÅáÂ¶Ç $f$ ÁöÑ‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØ $0$ÔºåÈÇ£‰πà $c$ ÂØπÂ∫îÁöÑÂÖÉÁ¥†‰∏çËÉΩÈÄöËøáÔºåÂØπÂ∫îÁöÑËæìÂá∫ÊòØ $0$Ôºõ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>üå∞ ÂÅáÂ¶Ç $f$ ÁöÑ‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØ $1$ÔºåÈÇ£‰πà $c$ ÂØπÂ∫îÁöÑÂÖÉÁ¥†Â∞±ÂÖ®ÈÉ®ÈÄöËøáÔºåÂØπÂ∫îÁöÑËæìÂá∫ÊòØ $c$ Êú¨Ë∫´„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ÈÅóÂøòÈó® $f$ ÂÖ∑‰ΩìÊòØËøô‰πàÁÆóÂá∫Êù•ÁöÑÔºöÈ¶ñÂÖàÁúãËøôÂº†ÁªìÊûÑÂõæÔºå$f_t$ ÊòØ‰∏ä‰∏Ä‰∏™Áä∂ÊÄÅ $h_{t-1}$Ôºå‰∏éÂΩìÂâçËæìÂÖ• $x$ ÁöÑÂáΩÊï∞„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/6.png"
loading="lazy"
alt="6"
>&lt;/p>
&lt;p>ÊääÁä∂ÊÄÅ $h_{t-1}$ ‰∏éËæìÂÖ• $x_t$ ÂÅöÊãºÊé• &lt;code>concatnation&lt;/code>ÔºåÂæóÂà∞Êõ¥È´òÁª¥Â∫¶ÁöÑÂêëÈáè„ÄÇÁÑ∂ÂêéËÆ°ÁÆóÁü©Èòµ $w_f$ ‰∏éËøô‰∏™ÂêëÈáèÁöÑ‰πòÁßØÔºåÂæóÂà∞‰∏Ä‰∏™ÂêëÈáèÔºåÂÜçÁî® &lt;code>sigmoid&lt;/code> ÂáΩÊï∞ÔºåÂæóÂà∞ÂêëÈáè $f_t$Ôºå$f_t$ ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩ‰ªã‰∫é &lt;code>0&lt;/code> Âíå &lt;code>1&lt;/code> ‰πãÈó¥ÔºåÈÅóÂøòÈó®Êúâ‰∏Ä‰∏™ÂèÇÊï∞Áü©Èòµ $w_f$ÔºåÈúÄË¶ÅÈÄöËøá &lt;strong>ÂèçÂêë‰º†Êí≠&lt;/strong> ‰ªéËÆ≠ÁªÉÊï∞ÊçÆÈáåÂ≠¶‰π†„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/7.png"
loading="lazy"
alt="7"
>&lt;/p>
&lt;h3 id="-input-gate">üö™ Input Gate&lt;/h3>
&lt;p>ÂàöÊâçËÆ≤‰∫ÜÈÅóÂøòÈó®ÔºåÁé∞Âú®Êù•Áúã‰∏ÄÁúã &lt;code>input gate&lt;/code> ËæìÂÖ•Èó®„ÄÇÂú®ËøôÂº†ÁªìÊûÑÂõæÈáåÔºåËæìÂÖ•Èó® $i_t$Ôºå‰æùËµñ‰∫éÊóßÁöÑÁä∂ÊÄÅÂêëÈáè $h_{t-1}$ÔºåÂíåÊñ∞ÁöÑËæìÂÖ• $x_t$„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/8.png"
loading="lazy"
alt="8"
>&lt;/p>
&lt;p>ËæìÂÖ•Èó® $i_t$ ÁöÑËÆ°ÁÆóÁ±ª‰ºº‰∫éÈÅóÂøòÈó®ÔºåÊääÊóßÁöÑÁä∂ÊÄÅ $h_{t-1}$Ôºå‰∏éÊñ∞ÁöÑËæìÂÖ• $x_t$ ÂÅöÊãºÊé• &lt;code>concatnation&lt;/code>ÔºåÂæóÂà∞Êõ¥È´òÁª¥ÁöÑÂêëÈáè„ÄÇ&lt;/p>
&lt;p>ÁÑ∂ÂêéËÆ°ÁÆóÁü©Èòµ $w_i$ ‰∏éËøô‰∏™ÂêëÈáèÁöÑ‰πòÁßØÂæóÂà∞‰∏Ä‰∏™ÂêëÈáèÔºåÊúÄÂêé‰ΩøÁî®ÊøÄÊ¥ªÂáΩÊï∞ &lt;code>sigmod&lt;/code>ÔºåÂæóÂà∞ÂêëÈáè $i_t$Ôºà$i_t$ ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩ‰ªã‰∫é $0$ Âíå $1$ ‰πãÈó¥Ôºâ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/9.png"
loading="lazy"
alt="8"
>&lt;/p>
&lt;p>ËæìÂÖ•Èó®‰πüÊúâËá™Â∑±ÁöÑÂèÇÊï∞Áü©ÈòµÔºåËÆ°‰Ωú $W_i$Ôºå$W_i$ ‰πüÈúÄË¶Å‰ªéËÆ≠ÁªÉÊï∞ÊçÆ‰∏≠Â≠¶‰π†„ÄÇ&lt;/p>
&lt;h3 id="-new-value">üÜï New Value&lt;/h3>
&lt;p>ËøòÈúÄË¶ÅËÆ°ÁÆóÊñ∞ÁöÑËæìÂÖ•ÂÄº &lt;code>new value&lt;/code> $\widetilde{c}_t$Ôºå$\widetilde{c}_t$ ÊòØ‰∏™ÂêëÈáèÔºåËÆ°ÁÆóÊñπÊ≥ïË∑üÈÅóÂøòÈó®ÂíåËæìÂÖ•Èó®ÈÉΩÂæàÂÉè„ÄÇ‰πüÊòØÊääÊóßÁä∂ÊÄÅ $h_{t-1}$Ôºå‰∏éÊñ∞ËæìÂÖ• $x_t$ ÂÅöÊãºÊé•ÔºåÂÜç‰πòÂà∞ÂèÇÊï∞Áü©Èòµ‰∏ä„ÄÇ&lt;/p>
&lt;p>Âå∫Âà´Âú®‰∫éÊøÄÊ¥ªÂáΩÊï∞‰∏çÊòØ &lt;code>sigmoid&lt;/code>ÔºåËÄåÊòØÂèåÊõ≤Ê≠£ÂàáÂáΩÊï∞ &lt;code>tanh&lt;/code>ÔºåÊâÄ‰ª•ÁÆóÂá∫ÁöÑÂêëÈáè $\widetilde{c}_t$ ÁöÑÂÖÉÁ¥†ÈÉΩ‰ªã‰∫é &lt;code>(-1, +1)&lt;/code>„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/10.png"
loading="lazy"
alt="8"
>&lt;/p>
&lt;p>ËÆ°ÁÆó &lt;code>new value&lt;/code> $\widetilde{c}_t$Ôºå‰πüÈúÄË¶Å‰∏Ä‰∏™ÂçïÁã¨ÁöÑÂèÇÊï∞Áü©ÈòµÁü©Èòµ $w_c$„ÄÇ&lt;/p>
&lt;h3 id="-Êõ¥Êñ∞-‰º†ËæìÂ∏¶">üöÇ Êõ¥Êñ∞ ‰º†ËæìÂ∏¶&lt;/h3>
&lt;p>Êàë‰ª¨Â∑≤ÁªèÁÆóÂá∫‰∫ÜÈÅóÂøòÈó® $f_t$ÔºåËæìÂÖ•Èó® $i_t$Ôºå‰ª•ÂèäÊñ∞ÁöÑËæìÂÖ•ÂÄº $\widetilde{c}_t$ÔºåÊàë‰ª¨ËøòÁü•ÈÅì‰º†ÈÄÅÂ∏¶ÊóßÁöÑÂÄº $c_{t-1}$ÔºåÁé∞Âú®ÂèØ‰ª•Êõ¥Êñ∞‰º†ÈÄÅÂ∏¶ $c$ ‰∫Ü„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/11.png"
loading="lazy"
alt="8"
>&lt;/p>
&lt;p>1Ô∏è‚É£ ËÆ°ÁÆóÈÅóÂøòÈó® $f_t$ Âíå‰º†ÈÄÅÂ∏¶ÊóßÁöÑÂÄº $c_{t-1}$ ÁöÑÂÖÉÁ¥†ÁßØ„ÄÇ&lt;/p>
&lt;p>ÈÅóÂøòÈó® $f_t$ÔºåÂíå‰º†ÈÄÅÂ∏¶ $c_{t-1}$ ÊòØÁª¥Â∫¶Áõ∏ÂêåÁöÑÂêëÈáèÔºåÁÆóÂá∫ÁöÑ‰πòÁßØ‰πüÊòØ‰∏™ÂêëÈáè„ÄÇÈÅóÂøòÈó® $f_t$ÔºåÂèØ‰ª•ÈÄâÊã©ÊÄßÁöÑÈÅóÂøò $c_{t-1}$ ‰∏≠ÁöÑ‰∏Ä‰∫õÂÖÉÁ¥†ÔºåÂ¶ÇÊûú $f_t$ ‰∏≠ÁöÑ‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØ $0$ÔºåÈÇ£‰πà $c_{t-1}$ Áõ∏Â∫îÁöÑÂÖÉÁ¥†Â∞±‰ºöË¢´ÈÅóÂøò„ÄÇ&lt;/p>
&lt;p>‰∏ä‰∏ÄÊ≠•ÈÄöËøá üö™ ÈÅóÂøòÈó® ÈÄâÊã©ÊÄßÂà†Èô§Êéâ‰∫Ü‰º†ÈÄÅÂ∏¶ $c_{t-1}$ ÁöÑ‰∏Ä‰∫õÂÖÉÁ¥†ÔºåÁé∞Âú®Ë¶ÅÂæÄ‰º†ÈÄÅÂ∏¶‰∏äÊ∑ªÂä†Êñ∞ÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/p>
&lt;p>2Ô∏è‚É£ ËÆ°ÁÆóËæìÂÖ•Èó® $i_t$ÔºåÂíåÊñ∞ÁöÑËæìÂÖ•ÂÄº $\widetilde{c}_t$ ÁöÑÂÖÉÁ¥†ÁßØ„ÄÇ&lt;/p>
&lt;p>ËæìÂÖ•Èó® $i_t$ ÂíåÊñ∞ÁöÑÂÄº $\widetilde{c}_t$ ÈÉΩÊòØÁª¥Â∫¶Áõ∏ÂêåÁöÑÂêëÈáèÔºå‰ªñ‰ª¨ÁöÑ‰πòÁßØ‰πüÊòØÁª¥Â∫¶Áõ∏ÂêåÁöÑÂêëÈáèÔºåÊää‰πòÁßØÂä†Âà∞‰º†ÈÄÅÂ∏¶‰∏äÔºåËøôÊ†∑Â∞±ÂÆåÊàê‰∫ÜÂØπ‰º†ÈÄÅÂ∏¶ÁöÑ‰∏ÄËΩÆÊõ¥Êñ∞„ÄÇ&lt;/p>
&lt;p>Áî®ÈÅóÂøòÈó®Âà†Èô§‰∫Ü‰º†ÈÄÅÂ∏¶‰∏äÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØÔºåÁÑ∂ÂêéÁî®ÈÅóÂøòÈó®ËæìÂÖ•Âä†ÂÖ•Êñ∞ÁöÑ‰ø°ÊÅØÔºåÂæóÂà∞‰∫Ü‰º†ÈÄÅÂ∏¶Êñ∞ÁöÑÂÄº $c_t$ÔºåÂà∞Áé∞Âú®ÔºåÂ∑≤ÁªèÊõ¥Êñ∞ÂÆå‰º†ÈÄÅÂ∏¶ $c$ „ÄÇ&lt;/p>
&lt;h3 id="-output-gate">üö™ Output Gate&lt;/h3>
&lt;p>ÊúÄÂêé‰∏ÄÊ≠•ÊòØËÆ°ÁÆó &lt;code>LSTM&lt;/code> ÁöÑËæìÂá∫Ôºå‰πüÂ∞±ÊòØÁä∂ÊÄÅÂêëÈáè $h_t$„ÄÇ&lt;/p>
&lt;p>$h_t$ ÊòØËøô‰πàËÆ°ÁÆóÁöÑÔºöÈ¶ñÂÖàËÆ°ÁÆóËæìÂá∫Èó® $o_t$ÔºåËæìÂá∫Èó® $o_t$ Ë∑üÂâçÈù¢ÁöÑÈÅóÂøòÈó®ÔºåËæìÂÖ•Èó®ÁöÑËÆ°ÁÆóÂü∫Êú¨‰∏ÄÊ†∑„ÄÇ&lt;/p>
&lt;p>ÊääÊóßÁöÑÁä∂ÊÄÅ $h_{t-1}$Ôºå‰∏éÊñ∞ÁöÑËæìÂÖ• $x_t$ ÂÅöÊãºÊé•ÔºåÂæóÂà∞Êõ¥È´òÁª¥ÁöÑÂêëÈáèÔºåÁÑ∂ÂêéÁÆóÁü©Èòµ $W_o$ ‰∏éËøô‰∏™ÂêëÈáèÁöÑ‰πòÁßØÔºåÂæóÂà∞‰∏Ä‰∏™ÂêëÈáèÔºåÊúÄÂêé‰ΩøÁî®ÊøÄÊ¥ªÂáΩÊï∞ &lt;code>sigmod&lt;/code> ÂæóÂà∞ÂêëÈáè $o_t$„ÄÇ$o_t$ ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩ‰ªã‰∫é &lt;code>(0, 1)&lt;/code>ÔºåËæìÂá∫Èó®‰πüÊúâËá™Â∑±ÁöÑÂèÇÊï∞ÂêëÈáè $W_o$Ôºå$W_o$ ‰πüÈúÄË¶Å‰ªéËÆ≠ÁªÉÊï∞ÊçÆ‰∏≠Â≠¶‰π†„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/12.png"
loading="lazy"
alt="12"
>&lt;/p>
&lt;p>Áé∞Âú®ËÆ°ÁÆóÁä∂ÊÄÅÂêëÈáè $h_t$ÔºåÂØπ‰º†ÈÄÅÂ∏¶ $c_t$ ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†Ê±ÇÂèåÊõ≤Ê≠£Âàá&lt;code>tanh&lt;/code>ÔºåÊääÂÖÉÁ¥†ÂÖ®ÈÉΩÂéãÂà∞ &lt;code>(-1, +1)&lt;/code> Âå∫Èó¥„ÄÇ&lt;/p>
&lt;p>ÁÑ∂ÂêéÔºåÊ±ÇËøô‰∏§‰∏™ÂêëÈáèÁöÑÂÖÉÁ¥†ÁßØÔºåËøô‰∏™Á∫¢Ëâ≤ÂêëÈáèÊòØÂàöÂàöÊ±ÇÂá∫ÁöÑËæìÂá∫Èó® $o_t$ÔºåËøôÊ†∑Â∞±ÂæóÂà∞‰∫ÜÁä∂ÊÄÅÂêëÈáè $h_t$„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/13.png"
loading="lazy"
alt="13"
>&lt;/p>
&lt;p>Áúã‰∏Ä‰∏ãÁªìÊûÑÂõæÔºå$h_t$ ‰ªñÊúâ‰∏§‰ªΩ &lt;code>copys&lt;/code>Ôºå$h_t$ ÁöÑ‰∏Ä‰ªΩ &lt;code>copy&lt;/code> ‰º†ËæìÂà∞‰∫Ü‰∏ã‰∏ÄÊ≠•ÔºåÂè¶‰∏Ä‰ªΩ &lt;code>copy&lt;/code> Êàê‰∫Ü &lt;code>LSTM&lt;/code> ÁöÑËæìÂá∫„ÄÇ&lt;/p>
&lt;p>Âà∞Á¨¨ &lt;code>t&lt;/code> Ê≠•‰∏∫Ê≠¢Ôºå‰∏ÄÂÖ±Êúâ &lt;code>t&lt;/code> ‰∏™ÂêëÈáè $x$ Ë¢´ËæìÂÖ•‰∫Ü &lt;code>LSTM&lt;/code>ÔºåÊàë‰ª¨ÂèØ‰ª•ËÆ§‰∏∫ÊâÄÊúâËøô‰∫õ $x$ ÂêëÈáèÁöÑ‰ø°ÊÅØÔºåÈÉΩÁßØÁ¥ØÂú®‰∫ÜÁä∂ÊÄÅ $h_t$ ÈáåÈù¢„ÄÇ&lt;/p>
&lt;h2 id="-lstm-ÁöÑÂèÇÊï∞Êï∞Èáè">üßÆ LSTM ÁöÑÂèÇÊï∞Êï∞Èáè&lt;/h2>
&lt;p>Êàë‰ª¨Êù•ÁÆó‰∏Ä‰∏ã &lt;code>LSTM&lt;/code> ÁöÑÂèÇÊï∞Êï∞ÈáèÔºå&lt;code>LSTM&lt;/code> Êúâ ‚ù∂ ÈÅóÂøòÈó®Ôºõ‚ù∑ ËæìÂÖ•Èó®Ôºõ‚ù∏ Êñ∞ÁöÑËæìÂÖ•Ôºõ‚ùπ ËæìÂá∫Èó®„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/04/14.png"
loading="lazy"
alt="14"
>&lt;/p>
&lt;p>ËøôÂõõ‰∏™Ê®°ÂùóÈÉΩÊúâÂêÑËá™ÁöÑÂèÇÊï∞Áü©Èòµ $w$ÔºåÊâÄ‰ª•‰∏ÄÂÖ±Êúâ &lt;code>4&lt;/code> ‰∏™ÂèÇÊï∞Áü©ÈòµÔºåÁü©ÈòµÁöÑË°åÊï∞ÊòØÔºö$shape(h)$ÔºåÂàóÊï∞ÊòØÔºö $shape(h)+shape(x)$&lt;/p>
&lt;p>ÊâÄ‰ª•Ôºå&lt;code>LSTM&lt;/code> ÂèÇÊï∞ÁöÑÊï∞ÈáèÊòØÔºö&lt;/p>
&lt;p>$4 * shape(h) * [ shape(h) + shape(x)]$&lt;/p>
&lt;h2 id="-ÂÆûÁé∞-lstm">üõ† ÂÆûÁé∞ LSTM&lt;/h2>
&lt;p>&lt;strong>Doing&lt;/strong>&lt;/p>
&lt;h2 id="-ÊÄªÁªì">üéê ÊÄªÁªì&lt;/h2>
&lt;p>ÊÄªÁªì‰∏Ä‰∏ãËøô‰∏ÄËäÇÁöÑÂÜÖÂÆπÔºåËøôËäÇ‰ªãÁªç‰∫Ü &lt;code>LSTM&lt;/code> Ê®°ÂûãÂíåÁî® &lt;code>PyTorch&lt;/code> ÁöÑÂÆûÁé∞„ÄÇ&lt;/p>
&lt;p>&lt;code>LSTM&lt;/code> Âíå &lt;code>simple RNN&lt;/code> ‰∏ªË¶ÅÁöÑÂå∫Âà´ÔºåÊòØÁî®‰∫Ü‰∏ÄÊù°‰º†ÈÄÅÂ∏¶ÔºåËÆ©ËøáÂéªÁöÑ‰ø°ÊÅØÂèØ‰ª•ÂæàÂÆπÊòì‰º†ËæìÂà∞‰∏ã‰∏ÄÊó∂ÂàªÔºåËøôÊ†∑Â∞±Êúâ‰∫ÜÊõ¥ÈïøÁöÑËÆ∞ÂøÜ„ÄÇ&lt;/p>
&lt;p>&lt;code>LSTM&lt;/code> ÁöÑË°®Áé∞ÊÄªÊòØÊØî &lt;code>simple RNN&lt;/code> Ë¶ÅÂ•ΩÔºåÊâÄ‰ª•ÂΩìÊàë‰ª¨ÊÉ≥‰ΩøÁî® &lt;code>RNN&lt;/code> ÁöÑÊó∂ÂÄôÂ∞±Áî® üôã‚Äç‚ôÇÔ∏è &lt;code>LSTM&lt;/code> Ê®°ÂûãÔºåËÄå‰∏çË¶ÅÁî® üôÖ‚Äç‚ôÇÔ∏è &lt;code>simple RNN&lt;/code> Ê®°Âûã„ÄÇ&lt;/p>
&lt;p>&lt;code>LSTM&lt;/code> ÊúâÂõõ‰∏™ÁªÑ‰ª∂ÔºåÂàÜÂà´ÊòØÔºö&lt;/p>
&lt;ul>
&lt;li>üö™ &lt;code>Forget Gate&lt;/code> ÈÅóÂøòÈó®&lt;/li>
&lt;li>üö™ &lt;code>Input Gate&lt;/code> ËæìÂÖ•Èó®&lt;/li>
&lt;li>üÜï &lt;code>New Value&lt;/code> Êñ∞ÁöÑËæìÂÖ•&lt;/li>
&lt;li>üö™ &lt;code>Output Gate&lt;/code> ËæìÂá∫Èó®&lt;/li>
&lt;/ul>
&lt;p>ËøôÂõõ‰∏™ÁªÑ‰ª∂ÂêÑËá™Êúâ‰∏Ä‰∏™ÂèÇÊï∞Áü©ÈòµÔºåÊâÄ‰ª•‰∏ÄÂÖ±ÊúâÂõõ‰∏™ÂèÇÊï∞Áü©ÈòµÔºå&lt;code>LSTM&lt;/code> ÂèÇÊï∞ÁöÑÊï∞ÈáèÊòØÔºö&lt;/p>
&lt;p>$4 * shape(h) * [ shape(h) + shape(x)]$&lt;/p>
&lt;p>‰∏ã‰∏ÄËäÇÂ∞Ü‰ªãÁªçÔºö&lt;/p>
&lt;ul>
&lt;li>&lt;code>stacked RNN&lt;/code>&lt;/li>
&lt;li>&lt;code>bi-directional RNN&lt;/code>&lt;/li>
&lt;li>È¢ÑËÆ≠ÁªÉ&lt;/li>
&lt;/ul>
&lt;h2 id="-ÂèÇËÄÉ">‚õì ÂèÇËÄÉ&lt;/h2>
&lt;ul>
&lt;li>üîó &lt;a class="link" href="https://github.com/wangshusen/DeepLearning/blob/master/Slides/9_RNN_3.pdf" target="_blank" rel="noopener"
>https://github.com/wangshusen/DeepLearning/blob/master/Slides/9_RNN_3.pdf&lt;/a>&lt;/li>
&lt;li>üîó &lt;a class="link" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" target="_blank" rel="noopener"
>https://colah.github.io/posts/2015-08-Understanding-LSTMs/&lt;/a>&lt;/li>
&lt;li>üîó &lt;a class="link" href="https://www.youtube.com/watch?v=vTouAvxlphc" target="_blank" rel="noopener"
>https://www.youtube.com/watch?v=vTouAvxlphc&lt;/a>&lt;/li>
&lt;li>üîó &lt;a class="link" href="https://www.bilibili.com/video/BV1UK4y1d7xa" target="_blank" rel="noopener"
>https://www.bilibili.com/video/BV1UK4y1d7xa&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>ÊñáÊú¨Â§ÑÁêÜ‰∏éËØçÂµåÂÖ•</title><link>https://blog.letout.cn/p/nlp-in-action/text-processing-and-word-embedding/</link><pubDate>Fri, 11 Mar 2022 21:14:45 +0800</pubDate><guid>https://blog.letout.cn/p/nlp-in-action/text-processing-and-word-embedding/</guid><description>&lt;img src="https://nlp.letout.cn/img/banner.png" alt="Featured image of post ÊñáÊú¨Â§ÑÁêÜ‰∏éËØçÂµåÂÖ•" />&lt;p>Êú¨ËäÇ‰∏ªË¶ÅÂÜÖÂÆπ‰∏∫ &lt;strong>ÊñáÊú¨Â§ÑÁêÜ&lt;/strong> &lt;code>Text Processing&lt;/code> Âíå &lt;strong>ËØçÂµåÂÖ•&lt;/strong> &lt;code>Word Embedding&lt;/code>„ÄÇÊú¨ËäÇÂíå‰∏ãÈù¢‰∏§ËäÇÂÜÖÂÆπÈÉΩ‰ºö‰ΩøÁî® IMDb ÁîµÂΩ±ËØÑËÆ∫ÁöÑÊï∞ÊçÆÔºåÁî®Êù•Êê≠Âª∫Êú∫Âô®Â≠¶‰π†Ê®°ÂûãÂàÜÊûêÁîµÂΩ±ËØÑËÆ∫„ÄÇ&lt;/p>
&lt;h2 id="-imdb">üå± IMDb&lt;/h2>
&lt;p>&lt;a class="link" href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E7%94%B5%E5%BD%B1%E8%B5%84%E6%96%99%E5%BA%93" target="_blank" rel="noopener"
>IMDb&lt;/a> ÊòØÊúÄÊúâÂêçÁöÑÁîµÂΩ±ËØÑËÆ∫ÁΩëÁ´ôÔºåÁî®Êà∑ÂèØ‰ª•Âú® IMDb ‰∏äÁªôÁîµÂΩ±ÊâìÂàÜÔºå1 ÂàÜÊòØÈùûÂ∏∏ËÆ®ÂéåÔºå10 ÂàÜÊòØÈùûÂ∏∏ÂñúÊ¨¢ÔºåÂ¶ÇÊûú‰πêÊÑèÔºåËøòÂèØ‰ª•ÂÜô‰∏ÄÊÆµÁîµÂΩ±ËØÑËÆ∫„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/imdb.png"
loading="lazy"
alt="IMDb"
>&lt;/p>
&lt;p>Â¶ÇÊûú‰∏çÁªô‰Ω†ÁúãÂàÜÊï∞ÔºåÂè™Áªô‰Ω†ÁúãËØÑËÆ∫Ôºå‰Ω†Â§ßÊ¶ÇËÉΩÁåúÂà∞Áî®Êà∑ÊâìÁöÑÂàÜÊï∞Ôºå‰ΩÜ‰Ω†ÁöÑÁåúÊµãÂèØËÉΩ‰∏çÂ§™ÂáÜÁ°Æ„ÄÇÂ¶ÇÊûúÊç¢ÁßçÊñπÂºèÔºåËÆ©‰Ω†Âà§Êñ≠ÁîµÂΩ±ËØÑËÆ∫ÊòØ &lt;strong>Ê≠£Èù¢&lt;/strong> &lt;code>positive&lt;/code> ÁöÑËøòÊòØ &lt;strong>Ë¥üÈù¢&lt;/strong> &lt;code>negative&lt;/code> ÁöÑÔºå‰Ω†Â∫îËØ•‰ºöÊúâÂæàÈ´òÁöÑÂáÜÁ°ÆÁéá„ÄÇÊúâ‰∫∫‰ªé IMDb ‰∏äÁà¨‰∫Ü 5 ‰∏áÊù°ÁîµÂΩ±ËØÑËÆ∫ÔºåËøô‰∫õËØÑËÆ∫ÈÉΩÊòØÂæàÊûÅÁ´ØÁöÑÔºåÈÉΩÊòØÂº∫ÁÉàÁöÑÂñúÊ¨¢ÔºåÊàñËÄÖÂº∫ÁÉàÂèçÊÑü„ÄÇËøô‰∏™‰∫åÂàÜÁ±ªÈóÆÈ¢òÂØπ‰∫é‰∫∫Êù•ËØ¥ÂæàÁÆÄÂçïÔºå‰∫∫ËØª‰∏Ä‰∏ãÁîµÂΩ±ËØÑËÆ∫Â∞±ËÉΩËΩªÊòìÁü•ÈÅìËøôÊòØÊ≠£Èù¢ËØÑ‰ª∑ËøòÊòØË¥üÈù¢ËØÑ‰ª∑Ôºå‰∫∫Â∫îËØ•ËÉΩÊúâ 100% ÁöÑÂáÜÁ°ÆÁéáÔºåËøô‰∏™Êï∞ÊçÆÈõÜË¢´ÂàÜÊàê‰∏§ÂçäÔºå2 ‰∏á 5 ÂçÉÊù°‰Ωú‰∏∫ËÆ≠ÁªÉÊï∞ÊçÆ &lt;code>Train&lt;/code>ÔºåÂè¶Â§ñ 2 ‰∏á 5 ÂçÉÊù°‰Ωú‰∏∫ÊµãËØïÊï∞ÊçÆ &lt;code>Test&lt;/code>„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>‰Ω†ÂèØ‰ª•Âú®‰∏ãÈù¢ÁöÑÈìæÊé•‰∏≠Ëé∑ÂèñÂà∞Êï∞ÊçÆÈõÜÔºö&lt;a class="link" href="https://ai.stanford.edu/~amaas/data/sentiment/" target="_blank" rel="noopener"
>https://ai.stanford.edu/~amaas/data/sentiment/&lt;/a>&lt;/p>
&lt;h2 id="-ÊñáÊú¨Â§ÑÁêÜÊñáÊú¨Â§ÑÁêÜ">üîñ ÊñáÊú¨Â§ÑÁêÜÊñáÊú¨Â§ÑÁêÜ&lt;/h2>
&lt;p>Âú®ËØçÂµåÂÖ• &lt;code>Word Embedding&lt;/code> ÂíåÊê≠Âª∫Êú∫Âô®Â≠¶‰π†Ê®°Âûã‰πãÂâçÔºåÈ¶ñÂÖàË¶ÅËøõË°åÊñáÊú¨Â§ÑÁêÜÔºåÂ∞ÜÊñáÊú¨ÂèòÊàêÂ∫èÂàó &lt;code>Sequence&lt;/code>ÔºåÊñáÊú¨Â§ÑÁêÜÂæàÊó†ËÅäÔºå‰ΩÜÊàë‰ª¨Â∫îËØ•ÈáçËßÜÂÆÉÔºåÊñáÊú¨Â§ÑÁêÜÁöÑÂ•ΩÂùèÔºå‰ºöÁõ¥Êé•ÂΩ±ÂìçÊú∫Âô®Â≠¶‰π†Ê®°ÂûãÁöÑÂáÜÁ°ÆÁéá„ÄÇ&lt;/p>
&lt;h3 id="-tokenization">üöÄ Tokenization&lt;/h3>
&lt;p>ÊñáÊú¨Â§ÑÁêÜÁöÑÁ¨¨‰∏ÄÊ≠•ÊòØ &lt;code>Tokenization&lt;/code>ÔºåÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂæàÂ§ö &lt;code>tokens&lt;/code>ÔºåËøôÈáåÊàë‰ª¨ÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂæàÂ§öÂçïËØçÔºå‰∏Ä‰∏™ &lt;code>token&lt;/code> Â∞±ÊòØ‰∏Ä‰∏™ÂçïËØçÔºàÂÅáÂ¶Ç‰Ω†ÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂ≠óÁ¨¶ÔºåÈÇ£‰πà‰∏Ä‰∏™ &lt;code>token&lt;/code> Â∞±ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶ÔºâÔºåÂÅöÂÆå &lt;code>Tokenization&lt;/code>Ôºå‰∏Ä‰∏™ÂæàÈïøÁöÑÂ≠óÁ¨¶‰∏≤Â∞±Ë¢´ÂàÜÂâ≤Êàê‰∏Ä‰∏™ÂæàÂ§öÂçïËØçÁöÑÂàóË°®„ÄÇ&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/1.png"
loading="lazy"
alt="1"
>&lt;/p>
&lt;p>&lt;code>Tokenization&lt;/code> ÁúãËµ∑Êù•ÂæàÁÆÄÂçïÔºå‰ΩÜÊòØËÆ≤Á©∂ÂæàÂ§ö„ÄÇÊØîÂ¶ÇÔºö&lt;/p>
&lt;ul>
&lt;li>üå∞ ÊòØÂê¶Â∫îËØ•ÊääÂ§ßÂÜôÂèòÊàêÂ∞èÂÜôÔºü&lt;/li>
&lt;/ul>
&lt;p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÂ∫îËØ•ÊääÂ§ßÂÜôÂèòÊàêÂ∞èÂÜôÔºåÂ§ßÂ∞èÂÜôÂçïËØçÈÄöÂ∏∏ÊòØ‰∏Ä‰∏™ÊÑèÊÄùÔºõ‰ΩÜÊúâÊó∂ÂÄô‰ºöÊ∑∑Ê∑ÜÂçïËØçÔºàApple -&amp;gt; appleÔºâÔºåÊØîÂ¶Ç Apple ÊòØËãπÊûúÂÖ¨Âè∏Ôºåapple ÊòØÊ∞¥ÊûúÔºåÂ§ßÂ∞èÂÜôÁöÑ apple Âπ∂‰∏çÊòØÁõ∏ÂêåÁöÑÂçïËØç„ÄÇ&lt;/p>
&lt;ul>
&lt;li>üå∞ ÂéªÈô§ÂÅúÁî®ËØç„ÄÇ&lt;code>stop word&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Êúâ‰∫õÂ∫îÁî®‰ºöÂéªÈô§ stop wordÔºåÂÆÉÊòØ the„ÄÅa„ÄÅof Á≠âÊúÄÈ´òÈ¢ëÁöÑÂçïËØçÔºåËøô‰∫õËØçÂá†‰πéÂá∫Áé∞Âú®ÊâÄÊúâÁöÑÂè•Â≠êÈáåÔºåÂØπËøô‰∏™‰∫åÂàÜÁ±ªÈóÆÈ¢òÂá†‰πéÊòØÊ≤°ÊúâÂ∏ÆÂä©„ÄÇ&lt;/p>
&lt;ul>
&lt;li>üå∞ ÊãºÂÜôÁ∫†Èîô„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>Áî®Êà∑ÂèëÁîµÂΩ±ËØÑËÆ∫ÁöÑÊó∂ÂÄôÔºåÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÂπ∂‰∏ç‰ºö‰ªîÁªÜÊ£ÄÊü•ÔºåÊâÄ‰ª•ÂÜôÁöÑ‰∏úË•øÈöæÂÖç‰ºöÊúâÊãºÂÜôÈîôËØØÔºåÊâÄ‰ª•ÂÅöÊãºÂÜôÁ∫†ÈîôÈÄöÂ∏∏ÊòØÊúâÁî®ÁöÑ„ÄÇ&lt;/p>
&lt;p>ËøôÈáåÂè™ÊòØ‰∏æ‰∫ÜÂá†‰∏™‰æãÂ≠êÔºåÂÆûÈôÖ‰∏äÂÅö &lt;code>Tokenization&lt;/code> ÁöÑÊó∂ÂÄôÈúÄË¶ÅÂÅöÂ§ßÈáèÁöÑÂ∑•‰ΩúÔºå&lt;code>Tokenization&lt;/code> Áúã‰ººÁÆÄÂçïÔºå‰ΩÜÂÆûÈôÖ‰∏äÂπ∂‰∏çÂÆπÊòì„ÄÇ&lt;/p>
&lt;h3 id="-build-dictionary">üß∞ Build Dictionary&lt;/h3>
&lt;p>Á¨¨‰∫åÊ≠•ÊòØÂª∫Á´ã‰∏Ä‰∏™Â≠óÂÖ∏„ÄÇÂèØ‰ª•ÂÖàÁªüËÆ°ËØçÈ¢ëÔºåÂéªÊéâ‰∏Ä‰∫õ‰ΩéÈ¢ëËØçÔºåËÆ©ÂêéËÆ©ÊØè‰∏™ÂçïËØçÂØπÂ∫î‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÔºåÊØîÂ¶ÇËÆ© &lt;code>the -&amp;gt; 1; cat -&amp;gt; 2; sat -&amp;gt; 3&lt;/code>„ÄÇÊúâ‰∫ÜËøô‰∏™Â≠óÂÖ∏ÔºåÂ∞±ÂèØ‰ª•ÊääÊØè‰∏™ÂçïËØçÂØπÂ∫îÂà∞‰∏Ä‰∏™Êï¥Êï∞ÔºåËøôÊ†∑‰∏ÄÊù•Ôºå‰∏ÄÂè•ËØùÂ∞±ÂèØ‰ª•Áî®Ê≠£Êï¥Êï∞ÁöÑÂàóË°®Ë°®Á§∫ÔºåËøô‰∏™ÂàóË°®Ë¢´Áß∞‰∏∫Â∫èÂàó &lt;code>Sequences&lt;/code>„ÄÇ&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/2.png"
loading="lazy"
alt="2"
>&lt;/p>
&lt;p>Â¶ÇÊûúÊúâÂøÖË¶ÅÁöÑËØùÔºåËøòÂæóËøõ‰∏ÄÊ≠•ÂÅö &lt;code>one-hot encoding&lt;/code>ÔºåÊääÂçïËØçË°®Á§∫Êàê &lt;code>one-hot&lt;/code> ÂêëÈáè„ÄÇ&lt;/p>
&lt;p>Âú®ÁîµÂΩ±ËØÑËÆ∫ÁöÑ‰æãÂ≠êÈáåÔºåÊï∞ÊçÆÊòØ 5 ‰∏áÊù°ÁîµÂΩ±ËØÑËÆ∫ÔºåÊØèÊù°ÁîµÂΩ±ËØÑËÆ∫ÂèØ‰ª•Ë°®Á§∫Êàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤„ÄÇÂÅöÂÆå &lt;code>Tokenization&lt;/code> Âíå &lt;code>Encoding&lt;/code> ÂêéÔºåÊØèÊù°ÁîµÂΩ±ËØÑËÆ∫ÈÉΩ‰ºöËΩ¨Êç¢Êàê‰∏Ä‰∏™ &lt;code>Sequences&lt;/code>Ôºå‰πüÂ∞±ÊòØ‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÁöÑÂàóË°®„ÄÇ&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/3.png"
loading="lazy"
alt="3"
>&lt;/p>
&lt;p>ÁîµÂΩ±ËØÑËÆ∫ÊúâÈïøÊúâÁü≠ÔºåÊúâ‰∫∫Âè™ËÉΩÂÜôÂá†‰∏™Â≠óÁöÑËØÑËÆ∫ÔºåÊúâ‰∫∫ËÉΩÊ¥ãÊ¥ãÊ¥íÊ¥íÂÜôÂá†ÂçÉÂ≠óÔºåÊâÄ‰ª•ÂæóÂà∞ÁöÑËøô‰∫õ &lt;code>Sequences&lt;/code> ÁöÑÈïøÂ∫¶‰πüÂêÑ‰∏çÁõ∏Âêå„ÄÇÊØîÂ¶ÇËøô‰∏§Êù° &lt;code>Sequences&lt;/code> ÁöÑÈïøÂ∫¶ÂàÜÂà´ÊòØ 52 Âíå 90„ÄÇ&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/4.png"
loading="lazy"
alt="4"
>&lt;/p>
&lt;p>ËøôÂ∞±ÈÄ†Êàê‰∫Ü‰∏Ä‰∏™ÈóÆÈ¢òÔºåËÆ≠ÁªÉÊï∞ÊçÆÊ≤°ÊúâÂØπÈΩêÔºåÊØèÊù° &lt;code>Sequences&lt;/code> ÈÉΩÊúâ‰∏çÂêåÁöÑÈïøÂ∫¶„ÄÇÂÅöÊú∫Âô®Â≠¶‰π†ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅÊääÊï∞ÊçÆÂ≠òÂÇ®Âà∞Áü©ÈòµÊàñËÄÖÂº†ÈáèÈáåÔºåÊØèÊù°Â∫èÂàóÈÉΩÂæóÊúâÁõ∏ÂêåÁöÑÈïøÂ∫¶ÔºåÈúÄË¶ÅÊääÂ∫èÂàóÂØπÈΩê„ÄÇ&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/5.png"
loading="lazy"
alt="5"
>&lt;/p>
&lt;p>Ëß£ÂÜ≥ÊñπÊ°àÊòØËøôÊ†∑ÁöÑÔºöÊàë‰ª¨ÂèØ‰ª•Âõ∫ÂÆöÈïøÂ∫¶‰∏∫ $w$„ÄÇÂÅáÂ¶Ç‰∏Ä‰∏™Â∫èÂàóÈïøÂ∫¶Â§™ÈïøÔºåË∂ÖËøá‰∫Ü $w$ ‰∏™ËØçÔºåÂ∞±Á†çÊéâÂâçÈù¢ÁöÑËØçÔºåÂè™‰øùÁïôÊúÄÂêéÈù¢ $w$‰∏™ËØçÔºàÂΩìÁÑ∂‰øùÁïôÊúÄÂâçÈù¢ $w$ ‰∏™ËØç‰πüÂêåÊ†∑ÂèØ‰ª•ÔºâÔºõÂÅáÂ¶Ç‰∏Ä‰∏™Â∫èÂàóÂ§™Áü≠Ôºå‰∏çÂà∞ $w$ ‰∏™ËØçÔºåÈÇ£‰πàÂ∞±ÂÅö &lt;code>zero padding&lt;/code> Áî® 0 Êù•Ë°•ÈΩêÔºåÊääÈïøÂ∫¶Â¢ûÂä†Âà∞ $w$„ÄÇ&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/6.png"
loading="lazy"
alt="6"
>&lt;/p>
&lt;p>ËøôÊ†∑‰∏ÄÊù•ÔºåÊâÄÊúâÂ∫èÂàóÁöÑÈïøÂ∫¶ÈÉΩÊòØ $w$ÔºåÂèØ‰ª•Â≠òÂÇ®Âà∞‰∏Ä‰∏™Áü©ÈòµÈáå„ÄÇ&lt;/p>
&lt;h2 id="-ËØçÂµåÂÖ•">üçÄÔ∏è ËØçÂµåÂÖ•&lt;/h2>
&lt;p>ÊñáÊú¨Â§ÑÁêÜÂ∑≤ÁªèÂÆåÊàê‰∫ÜÔºåÁé∞Âú®ÊØè‰∏™ËØçÈÉΩÁî®‰∏Ä‰∏™Ê≠£Êï¥Êï∞Êù•Ë°®Á§∫Ôºå‰∏ã‰∏ÄÊ≠•ÊòØ &lt;code>Word Embedding&lt;/code>ÔºåÊääÊØè‰∏™ËØçÈÉΩË°®Á§∫‰∏∫‰∏Ä‰∏™‰∏ÄÁª¥ÂêëÈáè„ÄÇ&lt;/p>
&lt;p>Áé∞Âú®ÊØè‰∏™ÂçïËØçÈÉΩÁî®‰∏Ä‰∏™Êï∞Â≠óÊù•Ë°®Á§∫ÔºåËØ•ÊÄé‰πàÊääËøô‰∫õ &lt;code>Categorical&lt;/code> ÁâπÂæÅË°®Á§∫‰∏∫Êï∞ÂÄºÂêëÈáèÂë¢Ôºü&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>ÊòæÁÑ∂ÂèØ‰ª•ÂÅö &lt;code>one-hot encoding&lt;/code>ÔºåÁî®‰∏Ä‰∏™ &lt;code>one-hot&lt;/code> ÂêëÈáèÊù•Ë°®Á§∫‰∏Ä‰∏™ÂçïËØç„ÄÇ&lt;!-- raw HTML omitted -->
ÊØîÂ¶Ç &lt;code>good: index = 2&lt;/code>Ôºå‰∫éÊòØ‰ΩøÁî®Ê†áÂáÜÊ≠£‰∫§ÁßØ $e_2$ Êù•Ë°®Á§∫ÔºåÂÆÉÁöÑÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÊòØ 1ÔºåÂÖ∂‰ΩôÂÖÉÁ¥†ÈÉΩÊòØ 0Ôºå$e_2=[0, 1, 0, 0, &amp;hellip;, 0]$&lt;/p>
&lt;p>ÂÅáÂ¶Ç &lt;code>vocabulary = v&lt;/code>Ôºå‰πüÂ∞±ÊòØËØ¥Â≠óÂÖ∏Èáå‰∏ÄÂÖ±Êúâ $v$ ‰∏™ÂçïËØçÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÁª¥Â∫¶ &lt;code>dimension = v&lt;/code> ÁöÑ &lt;code>one-hot&lt;/code> ÂêëÈáèÔºåË¶ÅÊòØÂ≠óÂÖ∏ÈáåÊúâ 1 ‰∏á‰∏™ÂçïËØçÔºåÈÇ£‰πàËøô‰∫õ &lt;code>one-hot&lt;/code> ÂêëÈáèÈÉΩÊòØ 1 ‰∏áÁª¥ÁöÑÔºåËøôÊ†∑ÁöÑÂêëÈáèÁª¥Â∫¶ÊòØÂú®Â§™È´ò‰∫Ü„ÄÇ‰∏ã‰∏ÄËäÇ‰ªãÁªç RNN ÁöÑÊó∂ÂÄô‰Ω†‰ºöÁúãÂà∞ÔºåRNN ÁöÑÂèÇÊï∞Êï∞ÈáèÊ≠£ÊØî‰∫éËæìÂÖ•ÂêëÈáèÁöÑÁª¥Â∫¶ÔºåÊàë‰ª¨ËÇØÂÆö‰∏çÊÉ≥ËÆ©ËæìÂÖ•ÁöÑÂêëÈáèÊòØ 1 ‰∏áÁª¥ÁöÑÔºåÂê¶Âàô‰∏ÄÂ±Ç RNN Â∞Ü‰ºöÊúâÂ•ΩÂá†ÂçÅ‰∏á‰∏™ÂèÇÊï∞„ÄÇÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÂÅö &lt;code>Word Embedding&lt;/code>ÔºåÊääËøô‰∫õÈ´òÁª¥ &lt;code>one-hot&lt;/code> ÂêëÈáèÊò†Â∞ÑÂà∞‰ΩéÁª¥ÂêëÈáè„ÄÇ&lt;/p>
&lt;p>ÂÖ∑‰ΩìÂÅöÊ≥ïÊòØÂêß &lt;code>one-hot&lt;/code> ÂêëÈáè $e_i$ ‰πòÂà∞ÂèÇÊï∞Áü©Èòµ $P^T$ ‰∏äÔºåÁü©Èòµ $P^T$ ÁöÑÂ§ßÂ∞èÊòØ $d*v$„ÄÇÂÖ∂‰∏≠ $d$ ÊòØËØçÂêëÈáèÁöÑÁª¥Â∫¶ÔºåÁî±Áî®Êà∑Ëá™Â∑±ÂÜ≥ÂÆöÔºõ$v$ ÊòØ &lt;code>vocabulary&lt;/code>ÔºåË°®Á§∫Â≠óÂÖ∏ÈáåÂçïËØçÁöÑÊï∞Èáè„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/7.png"
loading="lazy"
alt="7"
>&lt;/p>
&lt;p>Áü©ÈòµÁöÑ‰πòÊ≥ïÁöÑÁªìÊûúËÆ∞ÂÅöÂêëÈáè $x_i$Ôºå$x_i$ Â∞±ÊòØ‰∏Ä‰∏™ËØçÂêëÈáèÔºåÁª¥Â∫¶ÊòØ $d*1$ÔºåÂ¶ÇÊûú &lt;code>one-hot&lt;/code> ÂêëÈáè $e$ ÁöÑÁ¨¨‰∏â‰∏™ÂÖÉÁ¥†ÊòØ 1ÔºåÈÇ£‰πà $x_i$ Â∞±ÊòØ $P^T$ Áü©ÈòµÁöÑÁ¨¨‰∏âÂàóÔºåÂèØ‰ª•ÁúãÂá∫Ôºå$P^T$ Áü©ÈòµÊØè‰∏ÄÂàóÈÉΩÊòØ‰∏Ä‰∏™ËØçÂêëÈáè„ÄÇ&lt;/p>
&lt;p>ÂêåÁêÜÔºå‰∏ãÈù¢Ëøô‰∏™ÂèÇÊï∞Áü©Èòµ $P$ ÁöÑÊØè‰∏ÄË°åÈÉΩÊòØ‰∏Ä‰∏™ËØçÂêëÈáè„ÄÇËøô‰∏™Áü©ÈòµÁöÑË°åÊï∞ÊòØ $v$Ôºå‰πüÂ∞±ÊòØ &lt;code>vocabulary&lt;/code>ÔºõÊØè‰∏ÄË°åÂØπÂ∫î‰∏Ä‰∏™ÂçïËØçÔºåÁü©ÈòµÁöÑÂàóÊï∞ÊòØ $d$Ôºå$d$ ÊòØÁî®Êà∑ÂÜ≥ÂÆöÁöÑÔºå$d$ ÁöÑÂ§ßÂ∞è‰ºöÂΩ±ÂìçÊú∫Âô®Â≠¶‰π†Ê®°ÂûãÁöÑË°®Áé∞ÔºåÂ∫îËØ•Áî® ‰∫§ÂèâÈ™åËØÅ &lt;code>Cross Validation&lt;/code> Áî®Êù•ÈÄâÊã©‰∏Ä‰∏™ÊØîËæÉÂ•ΩÁöÑ $d$„ÄÇ&lt;/p>
&lt;p>Â≠óÂÖ∏ÈáåÁöÑÁ¨¨‰∏Ä‰∏™ËØçÁöÑÊòØ &lt;code>movie&lt;/code>ÔºåÈÇ£‰πàÁ¨¨‰∏ÄË°åÂ∞±ÊòØ &lt;code>movie&lt;/code> ÁöÑËØçÂêëÈáèÔºõÂ≠óÂÖ∏ÈáåÁöÑÁ¨¨‰∫å‰∏™ËØçÊòØ &lt;code>good&lt;/code>ÔºåÈÇ£‰πàÁ¨¨‰∫åË°åÂ∞±ÊòØ &lt;code>good&lt;/code> ÁöÑËØçÂêëÈáè„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/8.png"
loading="lazy"
alt="8"
>&lt;/p>
&lt;p>Êàë‰ª¨ÁöÑ‰ªªÂä°ÊòØÂà§Êñ≠ÁîµÂΩ±ËØÑËÆ∫ÊòØÊ≠£Èù¢ÁöÑËøòÊòØË¥üÈù¢ÁöÑÔºåËøô‰∏™ÂèÇÊï∞Áü©ÈòµÊòØ‰ªéËÆ≠ÁªÉÊï∞ÊçÆ‰∏≠Â≠¶‰π†Âá∫Êù•ÁöÑÔºåÊâÄ‰ª•Ëøô‰∫õËØçÂêëÈáèÈÉΩÂ∏¶ÊúâÊÑüÊÉÖËâ≤ÂΩ©ÔºåÂÅáÂ¶ÇËøô‰∫õËØçÂêëÈáèÈÉΩÊòØ‰∫åÁª¥ÁöÑÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âú®Âπ≥Èù¢ÂùêÊ†áÁ≥ª‰∏≠Ê†áÂá∫Ëøô‰∫õËØçÂêëÈáè„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/02/9.png"
loading="lazy"
alt="9"
>&lt;/p>
&lt;p>&lt;code>fantastic; good; fun&lt;/code> Ëøô‰∫õËØçÂêëÈáèÈÉΩÂ∏¶ÊúâÊ≠£Èù¢ÊÉÖÊÑüÔºåÊâÄ‰ª•Ëøô‰∏â‰∏™ËØçÁöÑËØçÂêëÈáèÂ≠¶Âá∫Êù•ÈÉΩÊØîËæÉÊé•ËøëÔºõÂêåÁêÜÔºå&lt;code>poor; boring; mediocre&lt;/code> Ëøô‰∫õËØçÂ∏¶ÊúâË¥üÈù¢ÊÉÖÊÑüÔºåÊâÄ‰ª•Â≠¶Âá∫Êù•ÁöÑËØçÂêåÊ†∑‰πüÂ∫îËØ•ÊØîËæÉÊé•ËøëÔºå‰ΩÜÊòØËøô‰∫õËØçÁöÑËØçÂêëÈáèÂ∫îËØ•ËøúÁ¶ªÊ≠£Èù¢Ëâ≤ÂΩ©ÁöÑËØçÂêëÈáè„ÄÇÂÉè &lt;code>movie; is&lt;/code> ËøôÊ†∑ÁöÑ‰∏≠ÊÄßËØçÔºåÊ≤°ÊúâÊÑüÊÉÖËâ≤ÂΩ©ÔºåÂÆÉ‰ª¨Â∫îËØ•Âú®‰∏≠Èó¥„ÄÇ&lt;/p>
&lt;h2 id="-ÊÄªÁªì">üéê ÊÄªÁªì&lt;/h2>
&lt;p>ÊúÄÂêéÊÄªÁªì‰∏Ä‰∏ãËøô‰∏ÄÁ´†ÁöÑÂÜÖÂÆπ„ÄÇ&lt;/p>
&lt;p>Ëøô‰∏ÄËäÇ‰∏äÂçäÈÉ®ÂàÜÔºåËØ¥Êòé‰∫ÜÊñáÊú¨Â§ÑÁêÜÊòØ‰ªÄ‰πàÊ†∑ÁöÑ„ÄÇÁªôÊàë‰ª¨‰∏ÄÊù°ÁîµÂΩ±ËØÑËÆ∫ÔºåÈ¶ñÂÖàÂÅö &lt;code>Tokenization&lt;/code>ÔºåÊääÁîµÂΩ±ËØÑËÆ∫ÂàÜÂâ≤ÊàêÂæàÂ§öÂçïËØçÔºåÁÑ∂ÂêéÊääÂæàÂ§öÂçïËØçÁºñÁ†ÅÊàêÊï∞Â≠óÔºåËøôÊ†∑‰∏ÄÊï¥Êù°ÁîµÂΩ±ËØÑËÆ∫Â∞±ÂèØ‰ª•ÂæàÂ§öÊ≠£Êï¥Êï∞Êù•Ë°®Á§∫ÔºåÊàë‰ª¨ÊääËøô‰∏™Ê≠£Êï¥Êï∞Â∫èÂàóÂè´ÂÅö &lt;code>Sequences&lt;/code>ÔºåÂ∞±ÊòØÁ•ûÁªèÁΩëÁªú‰∏≠ &lt;code>Embedding&lt;/code> Â±ÇÁöÑËæìÂÖ•„ÄÇÁî±‰∫éÁîµÂΩ±ËØÑËÆ∫ÁöÑÈïøÁü≠‰∏ç‰∏ÄÔºåÂæóÂà∞ÁöÑ &lt;code>Sequence&lt;/code> ÁöÑÈïøÁü≠‰πü‰∏ç‰∏ÄÊ†∑ÔºåÊ≤°ÂäûÊ≥ïÂ≠òÂÇ®Âú®‰∏Ä‰∏™Áü©ÈòµÈáåÔºåËß£ÂÜ≥ÊñπÊ°àÊòØ &lt;code>Alignment&lt;/code> ÂØπÈΩê„ÄÇÂÅáËÆæÊúÄÂ§ßÈïøÂ∫¶‰∏∫ &lt;code>20&lt;/code>ÔºåÂ¶ÇÊûúÈïøÂ∫¶Â§ß‰∫é&lt;code>20&lt;/code>ÔºåÂ∞±Âè™‰øùÁïôÊúÄÂêé &lt;code>20&lt;/code> ‰∏™ÂçïËØçÔºõÂ¶ÇÊûúÈïøÂ∫¶‰∏çÂà∞ &lt;code>20&lt;/code>ÔºåÂ∞±Áî® &lt;code>0&lt;/code> Ë°•ÈΩêÔºåÊääÈïøÂ∫¶Â¢ûÂä†Âà∞ &lt;code>20&lt;/code>„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÊØè‰∏™ &lt;code>Sequences&lt;/code> ÈïøÂ∫¶ÈÉΩÁõ∏Âêå„ÄÇ&lt;/p></description></item><item><title>RNN</title><link>https://blog.letout.cn/p/nlp-in-action/simple-rnn/</link><pubDate>Tue, 08 Mar 2022 20:36:14 +0800</pubDate><guid>https://blog.letout.cn/p/nlp-in-action/simple-rnn/</guid><description>&lt;img src="https://nlp.letout.cn/img/banner.png" alt="Featured image of post RNN" />&lt;p>Ëøô‰∏ÄËäÇÊàë‰ª¨Êù•Â≠¶‰π†&lt;strong>Âæ™ÁéØÁ•ûÁªèÁΩëÁªú&lt;/strong>&lt;code>Recurrent Neural Networks&lt;/code>„ÄÇÊú¨ËäÇÁöÑÂÜÖÂÆπÊòØ &lt;code>Simple RNN&lt;/code>Ôºå‰ª•ÂèäÁî® &lt;code>Pytorch&lt;/code> ÁºñÁ®ãÂÆûÁé∞ &lt;code>Simple RNN&lt;/code>„ÄÇ&lt;/p>
&lt;h2 id="-ÁÆÄ‰ªã">üå± ÁÆÄ‰ªã&lt;/h2>
&lt;p>Áé∞Âú® &lt;code>RNN&lt;/code> Ê≤°Êúâ‰ª•ÂâçÊµÅË°åÔºåÂ∞§ÂÖ∂ÊòØÂú®Ëá™ÁÑ∂ËØ≠Ë®ÄÂ§ÑÁêÜ‰∏äÔºå&lt;code>RNN&lt;/code> Â∑≤ÁªèÊúâ‰∏Ä‰∫õËøáÊó∂‰∫ÜÔºåÂ¶ÇÊûúËÆ≠ÁªÉÁöÑÊï∞ÊçÆË∂≥Â§üÂ§öÔºå&lt;code>RNN&lt;/code> ÁöÑÊïàÊûú‰∏çÂ¶Ç &lt;code>Transformer&lt;/code> Ê®°ÂûãÔºå‰ΩÜÊòØÂú®Â∞èËßÑÊ®°ÁöÑÈóÆÈ¢ò‰∏äÔºå&lt;code>RNN&lt;/code> ËøòÊòØÂæàÊúâÁî®ÁöÑ„ÄÇ&lt;/p>
&lt;h2 id="-Â¶Ç‰ΩïÂª∫Ê®°Êó∂Â∫èÊï∞ÊçÆ">üîñ Â¶Ç‰ΩïÂª∫Ê®°Êó∂Â∫èÊï∞ÊçÆÔºü&lt;/h2>
&lt;p>Êú∫Âô®Â≠¶‰π†‰∏≠ÁªèÂ∏∏Áî®Âà∞ÊñáÊú¨„ÄÅËØ≠Èü≥Á≠â &lt;strong>Êó∂Â∫èÊï∞ÊçÆ&lt;/strong>&lt;code>sequential data&lt;/code>ÔºàÊåâÊó∂Èó¥È°∫Â∫èËÆ∞ÂΩïÁöÑÊï∞ÊçÆÂàóÔºåÊúâÈïøÂ∫¶‰∏çÂõ∫ÂÆöÁöÑÁâπÁÇπÔºâ„ÄÇ&lt;/p>
&lt;p>È¶ñÂÖàÊÄùËÄÉ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÊÄé‰πàÂØπËøôÊ†∑ÁöÑÊó∂Â∫èÊï∞ÊçÆËøõË°åÂª∫Ê®°Ôºü
Âú®‰∏ä‰∏ÄÂ∞èËäÇ‰∏≠ÔºåÊàë‰ª¨Â∞Ü‰∏ÄÊÆµÊñáÂ≠óÊï¥‰ΩìËæìÂÖ•Âà∞‰∏Ä‰∏™ÈÄªËæëÂõûÂΩí &lt;code>Logistic Regression&lt;/code> Ê®°Âûã‰∏≠ÔºåËÆ©Ê®°ÂûãÊù•ÂÅö‰∫åÂàÜÁ±ªÔºåËøôÂ±û‰∫é‰∏Ä‰∏™ &lt;code>one-to-one&lt;/code> Ê®°ÂûãÔºå‰∏Ä‰∏™ËæìÂÖ•ÂØπÂ∫î‰∏Ä‰∏™ËæìÂá∫„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/1.png"
loading="lazy"
alt="1"
>&lt;/p>
&lt;p>ÂÖ®ËøûÊé•Á•ûÁªèÁΩëÁªúÂíåÂç∑ÁßØÁ•ûÁªèÁΩëÁªúÈÉΩÂ±û‰∫é &lt;code>one-to-one&lt;/code> Ê®°Âûã„ÄÇ&lt;/p>
&lt;p>‰∫∫ËÑëÂπ∂‰∏ç‰ºö‰ΩøÁî® &lt;code>one-to-one&lt;/code> Ê®°ÂûãÂ§ÑÁêÜÊó∂Â∫èÊï∞ÊçÆÔºå‰∏ç‰ºöÊää‰∏ÄÊï¥ÊÆµÊñáÂ≠óÂÖ®ÈÉ®ËæìÂÖ•Âà∞Â§ßËÑëÔºåÊàë‰ª¨Âú®ÈòÖËØªÁöÑÊó∂ÂÄôÔºå‰ºö‰ªéÂ∑¶Âà∞Âè≥ÈòÖËØª‰∏ÄÊÆµÊñáÂ≠óÔºå‰∏çÊñ≠Âú∞Âú®Â§ßËÑëÈáåÁßØÁ¥Ø‰ø°ÊÅØÔºåÈòÖËØª‰∏ÄÊÆµËØù‰πãÂêéÔºå‰Ω†ËÑëÂ≠êÈáåÂ∞±ÁßØÁ¥Ø‰∫Ü‰∏ÄÊÆµÊñáÂ≠óÁöÑÂ§ßÊÑè„ÄÇ&lt;/p>
&lt;p>&lt;code>one-to-one&lt;/code> Ê®°ÂûãË¶ÅÊ±Ç‰∏Ä‰∏™ËæìÂÖ•ÂØπÂ∫î‰∏Ä‰∏™ËæìÂá∫ÔºåÊØîÂ¶ÇÔºöËæìÂÖ•‰∏ÄÂº†ÂõæÁâáÔºåËæìÂá∫ÊØè‰∏ÄÁ±ªÁöÑÊ¶ÇÁéáÂÄºÔºå&lt;code>one-to-one&lt;/code> ÁöÑÊ®°ÂûãÊØîËæÉÈÄÇÂêàËøôÁ±ªÂõæÁâáÈóÆÈ¢òÔºå‰ΩÜÊòØ‰∏çÂ§™ÈÄÇÂêàÊñáÊú¨ÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;p>ÂØπ‰∫éÊñáÊú¨ÈóÆÈ¢òÔºåËæìÂÖ•ÂíåËæìÂá∫ÁöÑÈïøÂ∫¶Âπ∂‰∏çÂõ∫ÂÆöÔºå‰∏ÄÊÆµËØùÂèØÈïøÂèØÁü≠ÔºåÊâÄ‰ª•ËæìÂÖ•ÁöÑÈïøÂ∫¶Âπ∂‰∏çÂõ∫ÂÆöÔºõËæìÂá∫ÁöÑÈïøÂ∫¶‰πü‰∏çÂõ∫ÂÆöÔºåÊØîÂ¶ÇÂ∞ÜËã±ËØ≠ÁøªËØëÊàêÊ±âËØ≠Ôºå‰∏ÄÂè•Ëã±ËØ≠ÊúâÂçÅ‰∏™ÂçïËØçÔºåÁøªËØëÊàêÊ±âËØ≠ÂèØËÉΩÊúâÂçÅ‰∏™Â≠óÔºåÂèØËÉΩÊúâÂÖ´‰∏™Â≠óÔºå‰πüÂèØËÉΩÊòØÂõõ‰∏™Â≠óÁöÑÊàêËØ≠ÔºåËæìÂá∫Ê±âËØ≠ÁöÑÂ≠óÊï∞Âπ∂‰∏çÂõ∫ÂÆöÔºåÁî±‰∫éËæìÂÖ•ÂíåËæìÂá∫ÁöÑÈïøÂ∫¶‰∏çÂõ∫ÂÆöÔºå&lt;code>one-to-one&lt;/code> Ê®°ÂûãÂ∞±‰∏çÂ§™ÈÄÇÂêà‰∫Ü„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/translation.png"
loading="lazy"
alt="translation"
>&lt;/p>
&lt;p>ÂØπ‰∫éÊó∂Â∫èÊï∞ÊçÆÔºåÊõ¥Â•ΩÁöÑÊòØ &lt;code>many-to-one&lt;/code> ÊàñËÄÖÊòØ &lt;code>many-to-many&lt;/code> Ê®°ÂûãÔºå&lt;code>RNN&lt;/code> Â∞±ÊòØËøôÊ†∑ÁöÑÊ®°ÂûãÔºåËæìÂÖ•ÂíåËæìÂá∫ÁöÑÈïøÂ∫¶ÈÉΩ‰∏çÂõ∫ÂÆö„ÄÇÊâÄ‰ª• &lt;code>RNN&lt;/code> ÂæàÈÄÇÂêàËØ≠Èü≥ÔºåÊñáÊú¨Á≠âÊó∂Â∫èÂ∫èÂàóÊï∞ÊçÆ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/2.png"
loading="lazy"
alt="2"
>&lt;/p>
&lt;h2 id="-rnn">üçÄÔ∏è RNN&lt;/h2>
&lt;p>&lt;code>RNN&lt;/code> ÂíåË∑ü‰∫∫ÁöÑÈòÖËØª‰π†ÊÉØÂæàÁ±ª‰ººÔºö‰∫∫ÊØèÊ¨°Áúã‰∏Ä‰∏™ËØçÔºå‰ºöÈÄêÊ∏êÂú®Â§ßËÑëÈáåÁßØÁ¥Ø‰ø°ÊÅØÔºõ&lt;code>RNN&lt;/code> ÊØèÁúã‰∏Ä‰∏™ËØçÔºå‰ºöÁî®Áä∂ÊÄÅÂêëÈáè $h$ Êù•ÁßØÁ¥ØÈòÖËØªËøáÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/p>
&lt;p>È¶ñÂÖàÔºåÊàë‰ª¨Â∞ÜËæìÂÖ•ÁöÑÊØè‰∏™ËØçÁî® ËØçÂµåÂÖ•&lt;code>word embedding&lt;/code> ÂèòÊàê‰∏Ä‰∏™ËØçÂêëÈáè $x$„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/3.png"
loading="lazy"
alt="3"
>&lt;/p>
&lt;p>ÊØèÊ¨°Êää‰∏Ä‰∏™ËØçÂêëÈáèËæìÂÖ• &lt;code>RNN&lt;/code>ÔºåÂ∞±‰ºöÊõ¥Êñ∞Áä∂ÊÄÅ $h$ ÔºåÊääÊñ∞ÁöÑËæìÂÖ•ÁßØÁ¥ØÂà∞Áä∂ÊÄÅ $h$ ÈáåÈù¢„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/4.png"
loading="lazy"
alt="4"
>&lt;/p>
&lt;p>Âú® $h_0$‰∏≠ÔºåÂåÖÂê´‰∫ÜÁ¨¨‰∏Ä‰∏™ËØç &lt;code>the&lt;/code> ÁöÑ‰ø°ÊÅØÔºåÂú® $h_1$ ÈáåÈù¢ÔºåÂåÖÂê´‰∫ÜÂâç‰∏§‰∏™ &lt;code>the cat&lt;/code> ÁöÑ‰ø°ÊÅØÔºõ‰ª•Ê≠§Á±ªÊé®ÔºåÁä∂ÊÄÅ $h_2$ ÂåÖÂê´ ‰∫ÜÂâç‰∏â‰∏™ËØç &lt;code>the cat sat&lt;/code> ÁöÑ‰ø°ÊÅØÔºåÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅ $h_t$ ÂåÖÂê´‰∫ÜÊï¥Âè•ËØùÁöÑ‰ø°ÊÅØÔºåÂèØ‰ª•Êää $h_t$ ÁúãÂÅö &lt;code>RNN&lt;/code> ‰ªéÊï¥Âè•ËØù &lt;code>the cat sat on the mat&lt;/code> ÊäΩÂèñÁöÑÁâπÂæÅÂêëÈáèÔºåÂú®Êõ¥Êñ∞Áä∂ÊÄÅ $h$ ÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÁî®Âà∞ÂèÇÊï∞Áü©Èòµ $A$„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/5.png"
loading="lazy"
alt="5"
>&lt;/p>
&lt;p>&lt;strong>Ê≥®ÊÑèÔºöÊï¥‰∏™ RNN Âè™Êúâ‰∏Ä‰∏™ÂèÇÊï∞Áü©Èòµ&lt;/strong> $A$„ÄÇÊó†ËÆ∫ËøôÊù°ÈìæÊúâÂ§öÈïøÔºåÂèÇÊï∞ $A$ Âè™Êúâ‰∏Ä‰∏™Ôºå$A$ ÈöèÊú∫ÂàùÂßãÂåñÔºåÁÑ∂ÂêéÂà©Áî®ËÆ≠ÁªÉÊï∞ÊçÆÊù•Â≠¶‰π† $A$„ÄÇ‰∏ãÈù¢È¶ñÂÖàËÆ≤Ëß£ &lt;code>Simple RNN Model&lt;/code>„ÄÇ&lt;/p>
&lt;h2 id="-simple-rnn">üöÄ Simple RNN&lt;/h2>
&lt;p>Êàë‰ª¨ÂÖ∑‰ΩìÁúãÁúãÔºå&lt;code>Simple RNN&lt;/code> ÁÆÄÂçïÂæ™ÁéØÁ•ûÁªèÁΩëÁªúÊòØÊÄé‰πàÊääËæìÂÖ•ÁöÑËØçÂêëÈáè $x$ÔºåÁªìÂêàÂà∞Áä∂ÊÄÅ $h$ ‰∏≠ÁöÑ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/6.png"
loading="lazy"
alt="6"
>&lt;/p>
&lt;p>Êàë‰ª¨Â∞Ü‰∏ä‰∏Ä‰∏™Áä∂ÊÄÅËÆ∞ÂÅö $h_t-1$ÔºåÊñ∞ËæìÂÖ•ËØçÂêëÈáèËÆ∞ÂÅö $x_t$ÔºåÂ∞ÜËøô‰∏§‰∏™ÂêëÈáèÂÅöÊãºÊé• &lt;code>concatenation&lt;/code>ÔºåÂæóÂà∞‰∏Ä‰∏™Êõ¥È´òÁª¥ÁöÑÂêëÈáè„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/8.png"
loading="lazy"
alt="8"
>&lt;/p>
&lt;p>Âõæ‰∏≠Ëøô‰∏™Áü©Èòµ $A$ ÊòØ &lt;code>RNN&lt;/code> ÁöÑÊ®°ÂûãÂèÇÊï∞ÔºåËøôÈáåËÆ°ÁÆóÁü©Èòµ $A$ ÂíåËøô‰∏™ÂêëÈáèÁöÑ‰πòÁßØÔºàÊãºÊé•ÂêéÁöÑÂêëÈáèÔºâÔºåÁü©ÈòµÂíåÂêëÈáèÁöÑ‰πòÁßØÊòØ‰∏Ä‰∏™ÂêëÈáèÔºåÁÑ∂Âêé‰ΩøÁî®ÊøÄÊ¥ªÂáΩÊï∞ &lt;code>tanh&lt;/code> ‰ΩúÁî®Âú®ÂêëÈáèÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†‰∏äÔºåÊúÄÂêéÊääÊøÄÊ¥ªÂáΩÊï∞ÁöÑËæìÂá∫ËÆ∞ÂÅöÊñ∞ÁöÑÁä∂ÊÄÅ $h_t$„ÄÇ&lt;/p>
&lt;p>Ëøô‰∏™ÊøÄÊ¥ªÂáΩÊï∞Âºè ÂèåÊõ≤Ê≠£ÂàáÂáΩÊï∞ &lt;code>hyperbolic tangent function&lt;/code>ÔºåËæìÂÖ•ÊòØ‰ªªÊÑèÂÆûÊï∞ÔºåËæìÂá∫Âú® $(-1, +1)$ ‰πãÈó¥„ÄÇÁî±‰∫éÁî®‰∫ÜÂèåÊõ≤Ê≠£ÂàáÊøÄÊ¥ªÂáΩÊï∞ÔºåÂêëÈáè $h_t$ ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩÂú® $(-1, +1)$ ‰πãÈó¥„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/7.png"
loading="lazy"
alt="hyperbolic tangent function"
>&lt;/p>
&lt;p>Ëøô‰∏™Á•ûÁªèÁΩëÁªúÁöÑÁªìÊûÑÂõæÂèØ‰ª•ËøôÊ†∑ÁêÜËß£ÔºöÊñ∞ÁöÑÁä∂ÊÄÅ $h_t$ÔºåÊòØÊóßÁä∂ÊÄÅ $h_{t-1}$ ÂíåÊñ∞ÁöÑËæìÂÖ• $x_t$ ÁöÑÂáΩÊï∞ÔºåÁ•ûÁªèÁΩëÁªúÊ®°ÂûãÁöÑÂèÇÊï∞ÊòØ $A$ÔºöÊñ∞ÁöÑÁä∂ÊÄÅ $h_t$Ôºå‰æùËµñ‰∫éÂêëÈáè $h_{t-1}$, ÂêëÈáè $x_t$ ‰ª•ÂèäÁü©Èòµ $A$„ÄÇ&lt;/p>
&lt;h3 id="-‰∏∫‰ªÄ‰πàÈúÄË¶Å‰ΩøÁî®-tanh-‰Ωú‰∏∫ÊøÄÊ¥ªÂáΩÊï∞">üé® ‰∏∫‰ªÄ‰πàÈúÄË¶Å‰ΩøÁî® &lt;code>tanh&lt;/code> ‰Ωú‰∏∫ÊøÄÊ¥ªÂáΩÊï∞Ôºü&lt;/h3>
&lt;p>Êàë‰ª¨ÊÄùËÄÉËøôÊ†∑‰∏Ä‰∏™ÈóÆÈ¢òÔºö‰∏∫‰ªÄ‰πàÈúÄË¶Å‰ΩøÁî® &lt;code>tanh&lt;/code> ‰Ωú‰∏∫ÊøÄÊ¥ªÂáΩÊï∞ÔºüËÉΩÂê¶Â∞ÜËøô‰∏™ÊøÄÊ¥ªÂáΩÊï∞ÂéªÊéâÔºåÂéªÊéâ‰πãÂêé‰ºöÂèëÁîü‰ªÄ‰πàÂë¢Ôºü&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/9.png"
loading="lazy"
alt="9"
>&lt;/p>
&lt;p>È¶ñÂÖàÊàë‰ª¨ÂÅö‰∏™ÁÆÄÂåñÔºåÂÅáËÆæËæìÂÖ•ÁöÑËØçÂêëÈáèÁöÑÂÖÉÁ¥†ÈÉΩÊòØ $0$„ÄÇÂ¶ÇÂõæÔºåËøôÁ≠âÂêå‰∫éËæìÂÖ•ÁöÑËØçÂêëÈáè $x_t$ ÈÉΩÂéªÊéâÔºåÊääÁü©Èòµ $A$ Âè≥Ëæπ‰∏ÄÂçä‰πüÂéªÊéâ„ÄÇ&lt;/p>
&lt;p>$x_0 = x_1 = &amp;hellip; = x_{100} = 0$&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/10.png"
loading="lazy"
alt="10"
>&lt;/p>
&lt;p>Ëøô‰πà‰∏ÄÊù•ÔºåÁ¨¨ &lt;code>100&lt;/code> Áª¥ÁöÑÁâπÂæÅÂêëÈáè $h_{100} = Ah_{99} = A^2h_{98} = &amp;hellip; = A^{100}h_0$„ÄÇ&lt;/p>
&lt;ul>
&lt;li>üå∞ ÂÅáËÆæÁü©Èòµ $A$ ÊúÄÂ§ßÁöÑÁâπÂæÅÂÄºÁï•Â∞è‰∫é &lt;code>1&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ÊØîÂ¶ÇÔºåÊúÄÂ§ßÁöÑÁâπÂæÅÂÄºÁ≠â‰∫é &lt;code>0.9&lt;/code>„ÄÇÈÇ£‰πà‰ºöÂèëÁîü‰ªÄ‰πàÂë¢Ôºü&lt;/p>
&lt;p>$0.9^{100}$ ÈùûÂ∏∏Êé•Ëøë‰∫é &lt;code>0&lt;/code> ‰∫ÜÔºåÊâÄ‰ª•Áü©Èòµ $A^{100}$ ÈùûÂ∏∏Êé•Ëøë‰∫é &lt;code>0&lt;/code>ÔºåÈÇ£‰πàÊñ∞ÁöÑÁâπÂæÅÂêëÈáè $h_{100}$ ‰πüÂá†‰πé‰πüÊòØ‰∏Ä‰∏™ÂÖ®Èõ∂ÁöÑÂêëÈáè„ÄÇ&lt;/p>
&lt;ul>
&lt;li>üå∞ ÂÅáËÆæÁü©Èòµ $A$ ÊúÄÂ§ßÁöÑÁâπÂæÅÂÄºÁï•Â§ß‰∫é &lt;code>1&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ÊØîÂ¶ÇÔºåÊúÄÂ§ßÁöÑÁâπÂæÅÂÄºÁ≠â‰∫é &lt;code>1.2&lt;/code>„ÄÇ&lt;/p>
&lt;p>$1.2^{100}=82817974.522$ÔºåÊâÄ‰ª•Áü©Èòµ $A^{100}$ ÁöÑÂÖÉÁ¥†ÈÉΩË∂ÖÁ∫ßÂ§ßÔºå$A^{100}$ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÂæàÂ§ßÔºåÂÅáÂ¶ÇÂæ™ÁéØÁöÑÊ¨°Êï∞Êõ¥Â§ö‰∏Ä‰∫õÔºåÊàñËÄÖ $A$ ÁöÑÁâπÂæÅÂÄºÂÜçÂ§ß‰∏Ä‰∫õÔºåÁä∂ÊÄÅÂêëÈáèÁöÑÂÄºÂ∞±‰ºöÁàÜÁÇ∏„ÄÇ&lt;/p>
&lt;p>ÂÅáÂ¶ÇÊ≤°ÊúâËøô‰∏™ÊøÄÊ¥ªÂáΩÊï∞ &lt;code>tanh&lt;/code>ÔºåÊï∞ÂÄºËÆ°ÁÆóÁöÑÊó∂ÂÄôÂæàÊúâÂèØËÉΩ‰ºöÂá∫ÈóÆÈ¢òÔºåË¶Å‰πàËÆ°ÁÆóÂá∫ÁöÑÁªìÊûúÂÖ®ÈÉ®Á≠â‰∫é &lt;code>0&lt;/code>ÔºåË¶Å‰πàÁàÜÁÇ∏‰∫ÜÂÖ®ÈÉ®ÊòØ &lt;code>NaN: Not a Number&lt;/code>„ÄÇÈÄöËøá‰ΩøÁî®Ëøô‰∏™ÊøÄÊ¥ªÂáΩÊï∞ÔºåÊØèÊ¨°Êõ¥Êñ∞Áä∂ÊÄÅ $h$ ÂêéÔºåÈÉΩ‰ºöÂÅö‰∏Ä‰∏™Ê†áÂáÜÂåñÊìç‰Ωú &lt;code>normalization&lt;/code>ÔºåËÆ© $h$ ÊÅ¢Â§çÂà∞ $(-1, +1)$ Ëøô‰∏™ÂêàÈÄÇÁöÑÂå∫Èó¥Èáå„ÄÇ&lt;/p>
&lt;h3 id="-simple-rnn-Ê®°ÂûãÂèÇÊï∞Êï∞Èáè">üèùÔ∏è Simple RNN Ê®°ÂûãÂèÇÊï∞Êï∞Èáè&lt;/h3>
&lt;p>Êàë‰ª¨Êù•Êï∞‰∏Ä‰∏ã &lt;code>Simple RNN&lt;/code> ÊúâÂ§öÂ∞ë‰∏™Ê®°ÂûãÂèÇÊï∞„ÄÇ&lt;/p>
&lt;p>Â¶ÇÂõæÔºåÂÖàÁúã‰∏Ä‰∏ãËøô‰∏™ÊãºÊé•ÂêéÂêëÈáèÔºåËøô‰∏™ÂêëÈáèÁöÑÁª¥Â∫¶ÊòØ $h_{t-1}$ ÁöÑÁª¥Â∫¶Âä†‰∏ä $x_t$ ÁöÑÁª¥Â∫¶Ôºö&lt;/p>
&lt;p>ÊâÄ‰ª• $A$ ‰∏ÄÂÆöË¶ÅÊúâ $shape(h)+shape(x)$ Áª¥Â∫¶Ëøô‰πàÂ§öÂàóÔºö&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/11.png"
loading="lazy"
alt="11"
>&lt;/p>
&lt;p>$A$ ÁöÑË°åÊï∞Á≠â‰∫é $h$ ÁöÑÁª¥Â∫¶Ôºö&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/12.png"
loading="lazy"
alt="12"
>&lt;/p>
&lt;p>ÊâÄ‰ª•ÔºåÊúÄÁªàÁü©Èòµ $A$ ÁöÑÂ§ßÂ∞èÁ≠â‰∫éÔºö&lt;/p>
&lt;p>$parameter(A) = shape(h) * [shape(h) + shape(x)]$&lt;/p>
&lt;p>Ëøô‰∏™‰πòÁßØ $parameter(A)$ Â∞±ÊòØ &lt;code>simple RNN&lt;/code> ÁöÑÊúÄÁªàÁöÑÂèÇÊï∞Êï∞Èáè„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨Êù•Êê≠‰∏Ä‰∏™ÁÆÄÂçïÁöÑÁΩëÁªú„ÄÇÊúÄÂ∫ïÂ±ÇÊòØ‰∏Ä‰∏™ËØçÂµåÂÖ•Â±Ç &lt;code>Word Embedding Layer&lt;/code>ÔºåÂÆÉÂèØ‰ª•ÊääËØçÊò†Â∞Ñ‰∏∫ËØçÂêëÈáè„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/13.png"
loading="lazy"
alt="13"
>&lt;/p>
&lt;p>ËØçÂêëÈáèÁöÑÁª¥Â∫¶Áî±Ëá™Â∑±ËÆæÁΩÆÔºàËøôÊòØ‰∏Ä‰∏™Ë∂ÖÂèÇÊï∞ÔºåÊàë‰ª¨Â∫îËØ•‰ΩøÁî®‰∫§ÂèâÈ™åËØÅ &lt;code>cross validation&lt;/code> ÈÄâÊã©ÊúÄ‰Ω≥ÁöÑÁª¥Â∫¶ÔºâÔºåËøôÈáåËÆæÁΩÆ $x$ ÁöÑÁª¥Â∫¶ÊòØ $32$„ÄÇ&lt;/p>
&lt;p>ÁÑ∂Âêé‰∏ã‰∏ÄÂ±ÇÊòØ &lt;code>Simple RNN Layer&lt;/code>ÔºåËæìÂÖ•ÁöÑÊòØËØçÂêëÈáè $x_i$ÔºåËæìÂá∫ÁöÑÊòØÁä∂ÊÄÅ $h_i$„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/14.png"
loading="lazy"
alt="14"
>&lt;/p>
&lt;p>$h$ ÁöÑÁª¥Â∫¶‰πüÊòØÁî±Ëá™Â∑±ËÆæÁΩÆÔºåÊàë‰ª¨ËÆæÁΩÆ $h$ Áª¥Â∫¶‰∏∫ $32$„ÄÇËøôÈáå $x$ Âíå $h$ ÁöÑÁª¥Â∫¶ÈÉΩÊòØ $32$ÔºåËøôÂè™ÊòØ‰∏Ä‰∏™Â∑ßÂêàËÄåÂ∑≤Ôºå$h$ Âíå $x$ ÁöÑÁª¥Â∫¶ÈÄöÂ∏∏‰∏ç‰∏ÄÊ†∑„ÄÇ&lt;/p>
&lt;p>ÂâçÈù¢ËØ¥ËøáÔºåÁä∂ÊÄÅÂêëÈáè $h$ ‰ºöÁßØÁ¥ØËæìÂÖ•ÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶ÇÔºö$h_0$ ÂåÖÂê´Á¨¨‰∏Ä‰∏™ÂçïËØç &lt;code>I&lt;/code> ÁöÑ‰ø°ÊÅØÔºå$h_1$ ÂåÖÂê´Ââç‰∏§‰∏™ËØç &lt;code>I love&lt;/code> ÁöÑ‰ø°ÊÅØÔºåÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅ $h_t$ ÂåÖÂê´Êï¥Âè•ËØù &lt;code>I love the movice so much&lt;/code> ÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨ÂèØ‰ª•‰ªé &lt;code>PyTorch&lt;/code> ‰∏≠Ëé∑ÂèñÊâÄÊúâÁöÑÁä∂ÊÄÅ $h={h_1, h_2, &amp;hellip;, h_t}$Ôºå‰πüÂèØ‰ª•Âè™Ëé∑ÂæóÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅÂêëÈáè $h_t$ ÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/p>
&lt;p>$h_t$ ÁßØÁ¥Ø‰∫ÜÊï¥Âè•ËØùÁöÑ‰ø°ÊÅØÔºåÊâÄÊúâÈÄöÂ∏∏‰ΩøÁî® $h_t$ Ëøô‰∏Ä‰∏™ÂêëÈáèÂ∞±Â§ü‰∫ÜÔºåËøôÈáåÊàë‰ª¨Âè™‰ΩøÁî® $h_t$ÔºåÊääÂâçÈù¢ÁöÑÊâÄÊúâÁä∂ÊÄÅ ${h_1, h_2, &amp;hellip;, h_{t-1}}$ ÂÖ®ÈÉ®ÈÉΩ‰∏¢Êéâ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/15.png"
loading="lazy"
alt="15"
>&lt;/p>
&lt;p>$h_t$ Áõ∏ÂΩì‰∫é‰ªéÊñáÊú¨‰∏≠ÊèêÂèñÁöÑÁâπÂæÅÂêëÈáèÔºåÊää $h_t$ ËæìÂÖ•Ëøô‰∏™ÂàÜÁ±ªÂô® $sigmoid(v^T h_t)$ÔºåÂàÜÁ±ªÂô®Â∞±‰ºöËæìÂá∫‰∏Ä‰∏™ &lt;code>0&lt;/code> Êàñ &lt;code>1&lt;/code> ‰πãÈó¥ÁöÑÊï∞ÂÄºÔºå&lt;code>0&lt;/code> ‰ª£Ë°®‰∫ÜË¥üÈù¢ÁîµÂΩ±ËØÑ‰ª∑Ôºå&lt;code>1&lt;/code> ‰ª£Ë°®Ê≠£Èù¢ÁîµÂΩ±ËØÑ‰ª∑„ÄÇ&lt;/p>
&lt;p>ÁÑ∂ÂêéÊàë‰ª¨ËÆæÁΩÆË∂ÖÂèÇÊï∞Ôºö&lt;/p>
&lt;ul>
&lt;li>ËÆæÁΩÆ &lt;code>vocabulary = 1000&lt;/code>ÔºåÊÑèÊÄùÊòØËØçÂÖ∏ÈáåÊúâ &lt;code>10000&lt;/code> ‰∏™ËØçÊ±áÔºõ&lt;/li>
&lt;li>&lt;code>embedding_dim = 32&lt;/code>ÔºåÊÑèÊÄùÊòØËØçÂêëÈáè $x$ ÁöÑÁª¥Â∫¶ÊòØ $32$Ôºõ&lt;/li>
&lt;li>&lt;code>word_num = 500&lt;/code>ÔºåÊÑèÊÄùÊòØÊØèÊù°ÁîµÂΩ±ËØÑ‰ª∑Êúâ &lt;code>500&lt;/code> ‰∏™ÂçïËØçÔºåÂ¶ÇÊûúË∂ÖËøá &lt;code>500&lt;/code> ‰∏™ÂçïËØçÔºåÂ∞±‰ºöË¢´Êà™ÊéâÔºåÂè™‰øùÁïô &lt;code>500&lt;/code> ‰∏™ÔºåÂ¶ÇÊûú‰∏çÂ§ü &lt;code>500&lt;/code>ÔºåÂ∞±Áî® &lt;code>zero_padding&lt;/code> Â∞ÜÂè•Â≠êË°•ÊàêÈïøÂ∫¶‰∏∫ &lt;code>500&lt;/code>Ôºõ&lt;/li>
&lt;li>&lt;code>state_dim = 32&lt;/code>ÔºåÊÑèÊÄùÊòØÁä∂ÊÄÅ $h$ ÁöÑÁª¥Â∫¶Á≠â‰∫é $32$„ÄÇ&lt;/li>
&lt;/ul>
&lt;h3 id="-pytorch-ÂÆûÁé∞">üë©‚Äçüöí PyTorch ÂÆûÁé∞&lt;/h3>
&lt;p>Êé•‰∏ãÊù•ÂºÄÂßãÊê≠ÁΩëÁªúÔºåÈ¶ñÂÖàÊàë‰ª¨ÂÆö‰πâ‰∏Ä‰∏™Á±ª &lt;code>Model&lt;/code>ÔºåÊàë‰ª¨ËÆ©ÂÆÉÁªßÊâø &lt;code>nn.Model&lt;/code> Áà∂Á±ª„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">torch&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">torch.nn&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">nn&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Model&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">nn&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Module&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">vocabulary_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">embedding_dim&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">state_dim&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">super&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="fm">__init__&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vocabulary_size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">vocabulary_size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">embedding_dim&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">embedding_dim&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">state_dim&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">state_dim&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Embedding&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">nn&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Embedding&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vocabulary_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">embedding_dim&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RNN&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">nn&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RNN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">embedding_dim&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">state_dim&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">nn&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Linear&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">state_dim&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sigmoid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">nn&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Sigmoid&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">forward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">transpose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">embedded&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Embedding&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">output&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h_n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RNN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">embedded&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h_n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">torch&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">squeeze&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">h_n&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">dim&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">h_n&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sigmoid&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Âú®ÊûÑÈÄ†ÂáΩÊï∞ &lt;code>__init__&lt;/code> ‰∏≠ÂÆö‰πâÊàë‰ª¨ÁöÑÊ®°ÂûãÁªìÊûÑÔºåÂπ∂ÈáçËΩΩ &lt;code>forword&lt;/code> ÊñπÊ≥ï„ÄÇ&lt;/p>
&lt;p>È¶ñÂÖàÊòØËØçÂµåÂÖ•Â±Ç &lt;code>nn.Embedding()&lt;/code>ÔºåÂÆÉÊòØÊääËØçÊò†Â∞ÑÊàêÂêëÈáè„ÄÇ&lt;/p>
&lt;p>ÁÑ∂ÂêéÊòØ simple RNN Â±Ç &lt;code>nn.RNN()&lt;/code>ÔºåÈúÄË¶ÅÊåáÂÆöËØçÂêëÈáèÁöÑÁª¥Â∫¶ &lt;code>embedding_dim&lt;/code> ÂíåÁä∂ÊÄÅÂêëÈáè $h$ ÁöÑÁª¥Â∫¶ &lt;code>state_dim&lt;/code>Ôºõ&lt;/p>
&lt;p>ÊúÄÂêéÊòØ‰∏Ä‰∏™ÂÖ®ËøûÊé•Â±Ç &lt;code>nn.Linear()&lt;/code>ÔºåÂπ∂‰∏î‰ºö‰ΩøÁî® &lt;code>nn.Sigmoid()&lt;/code> ‰ΩúÁî®‰∫éÂÆÉÁöÑÁªìÊûúÔºåËæìÂÖ•ÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅÂêëÈáè $h$ÔºåËæìÂá∫‰∏Ä‰∏™ &lt;code>0„ÄÅ1&lt;/code> ‰πãÈó¥ÁöÑÊï∞„ÄÇ&lt;/p>
&lt;p>&lt;code>PyTorch&lt;/code> ‰∏≠ÁöÑ &lt;code>RNN&lt;/code> ‰ºöÊúâ‰∏§‰∏™ËøîÂõûÂÄºÔºö&lt;code>output&lt;/code>Ôºå&lt;code>h_n&lt;/code>„ÄÇ&lt;/p>
&lt;ul>
&lt;li>&lt;code>output&lt;/code> ÊòØ &lt;code>RNN&lt;/code> ÊâÄÊúâÊó∂ÂàªÁöÑÁä∂ÊÄÅÂêëÈáèÈõÜÂêàÔºàÁü©ÈòµÔºâÔºõ&lt;/li>
&lt;li>&lt;code>h_n&lt;/code> ÊòØ &lt;code>RNN&lt;/code> ‰∏≠ÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅÂêëÈáè„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>ËøôÊòØÊ®°ÂûãÁöÑ‰∏Ä‰∏™Ê¶ÇË¶ÅÔºå ËØçÂµåÂÖ•Â±Ç &lt;code>Embedding&lt;/code> ÁöÑËæìÂá∫ÊòØ‰∏Ä‰∏™ $500*32$ ÁöÑÁü©ÈòµÔºå&lt;code>500&lt;/code> ÁöÑÊÑèÊÄùÊòØÊØè‰∏™Âè•Â≠êÊúâ $500$ ‰∏™ËØçÔºå&lt;code>32&lt;/code> ÁöÑÊÑèÊÄùÊòØÊØè‰∏™ËØçÁî® $32$ Áª¥ÁöÑËØçÂêëÈáèË°®Á§∫„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">==========================================================================================
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Layer (type:depth-idx) Output Shape Param #
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">==========================================================================================
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Model -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">‚îú‚îÄEmbedding: 1-1 [500, 1, 32] 320,000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">‚îú‚îÄRNN: 1-2 [500, 1, 32] 2,112
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">‚îú‚îÄLinear: 1-3 [1, 1] 33
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">‚îú‚îÄSigmoid: 1-4 [1, 1] --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">==========================================================================================
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Total params: 322,145
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Trainable params: 322,145
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>Simple RNN&lt;/code> ÊØè‰∏™Áä∂ÊÄÅÁöÑËæìÂá∫ $h_t$ ÈÉΩÊòØ‰∏Ä‰∏™ &lt;code>32&lt;/code> Áª¥ÁöÑÂêëÈáè„ÄÇÊàë‰ª¨Áúã‰∏Ä‰∏ã RNN ÁöÑÂèÇÊï∞Ôºå‰ªñÊúâ &lt;code>2080&lt;/code> ‰∏™ÂèÇÊï∞ÔºåÂÆÉÊòØËøôÊ†∑ÁÆóÂá∫Êù•ÁöÑÔºö&lt;/p>
&lt;p>$shape(h) * (shape(h)+shape(x)) = 32*(32+32)+32 = 2080$&lt;/p>
&lt;p>ËøôÊòØÁü©Èòµ $A$ ÁöÑÂ§ßÂ∞èÔºåÂêéÈù¢ÁöÑ $32$ ÁöÑÁª¥Â∫¶Êù•Ëá™ &lt;code>intercept&lt;/code>Ôºå‰πüÂè´ &lt;code>bias&lt;/code>ÔºåÂÅèÁßªÈáè„ÄÇRNN ‰ºöÈªòËÆ§‰ΩøÁî® &lt;code>intercept&lt;/code>Ôºå‰ΩÜËøô‰∏™‰∏çÈáçË¶ÅÔºåËøôÈáåÊöÇÊó∂‰∏çÁÆ°ÂÆÉ„ÄÇ&lt;/p>
&lt;p>Ââ©‰∏ãÁöÑ &lt;code>32&lt;/code> ‰∏™ÂèÇÊï∞Êù•Ëá™‰∫éÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅÔºåÂõ†‰∏∫ &lt;code>PyTorch&lt;/code> ‰∏≠ÁöÑ &lt;code>RNN&lt;/code> ‰ºöÂêåÊó∂ËæìÂá∫ÊâÄÊúâÊó∂ÂàªÁöÑÁä∂ÊÄÅÂêëÈáèÈõÜÂêàÂíåÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅÂêëÈáè„ÄÇ&lt;/p>
&lt;h3 id="-ËøêË°åÊ®°Âûã">üßë‚Äçüîß ËøêË°åÊ®°Âûã&lt;/h3>
&lt;p>Êê≠Â•ΩÊ®°Âûã‰πãÂêéÔºåÂàùÂßãÂåñÊ®°ÂûãÔºåÁÑ∂ÂêéÁî®ËÆ≠ÁªÉÊï∞ÊçÆÊãüÂêàÊ®°Âûã„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨ÊåáÂÆöÁÆóÊ≥ïÊòØ &lt;code>optim.Adam&lt;/code>ÔºåÊçüÂ§±ÂáΩÊï∞ÊòØ &lt;code>nn.BCELoss()&lt;/code>ÔºåËØÑ‰ª∑Ê†áÂáÜÊòØÂáÜÁ°ÆÁéá &lt;code>accuracy&lt;/code>„ÄÇ&lt;/p>
&lt;p>ÁÑ∂ÂêéÁî®ËÆ≠ÁªÉÊï∞ÊçÆÊãüÂêàÊ®°ÂûãÔºåÊàëËÆ©ÁÆóÊ≥ïËÆ≠ÁªÉ &lt;code>3&lt;/code> ‰∏™ &lt;code>epochs&lt;/code>ÔºåÂè™ËÆ©ÁÆóÊ≥ïËøêË°å &lt;code>3&lt;/code> ‰∏™ epochsÔºåÊòØÂá∫Áé∞‰∫ÜËøáÊãüÂêàÔºå&lt;code>3&lt;/code> ‰∏™ &lt;code>epochs&lt;/code> ‰πãÂêéÔºå&lt;code>validate accuracy&lt;/code> ‰ºöÂèòÂ∑Æ„ÄÇÊèêÂâçËÆ©ÁÆóÊ≥ïÂÅúÊ≠¢ËøêË°åÁß∞‰∏∫ &lt;code>early stoping&lt;/code> ÊèêÂâçÁªàÊ≠¢ËÆ≠ÁªÉÔºå‰Ωø &lt;code>validate accuracy&lt;/code> ÂèòÂ∑Æ‰πãÂâçÂ∞±ÂÅúÊ≠¢„ÄÇ&lt;/p>
&lt;p>ÊúÄÂêéÔºåÁî®ÊµãËØïÊï∞ÊçÆËØÑ‰ª∑Ê®°ÂûãÁöÑË°®Áé∞ÔºåÊääÊµãËØïÊï∞ÊçÆ‰Ωú‰∏∫ËæìÂÖ•ÔºåË∞ÉÁî® &lt;code>model.evaluate()&lt;/code>ÔºåËøîÂõû loss Âíå accuracyÔºåÊµãËØïÁöÑ accuracyÔºåÊµãËØïÁöÑ accuracy ÊòØ 84.36%ÔºåÊØî‰∏ä‰∏ÄËäÇ‰∏≠ÁöÑ ÈÄªËæëÂõûÂΩíÂ•ΩÂæàÂ§öÔºà75%Ôºâ„ÄÇ&lt;/p>
&lt;p>ÂàöÊâçÊê≠Ê®°ÂûãÁöÑÊó∂ÂÄôÔºåÂè™‰ΩøÁî®‰∫ÜRNNÊúÄÂêé‰∏Ä‰∏™Áä∂ÊÄÅ $h_t$ÔºåÊää‰πãÂâçÁöÑÁä∂ÊÄÅÈÉΩ‰∏¢Êéâ‰∫ÜÔºåÊÉ≥Áî® $h_0$ Âà∞ $h_t$ ÊâÄÊúâÁä∂ÊÄÅ‰πüÂèØ‰ª•Ôºå‰ΩÜÂπ∂Ê≤°ÊúâÂ§™Â§ßÂå∫Âà´„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨ËÆ© &lt;code>RNN&lt;/code> ÁöÑÁ¨¨‰∏Ä‰∏™ËæìÂá∫ &lt;code>output&lt;/code>ÔºåÂÆÉÊòØ‰∏Ä‰∏™Áü©ÈòµÔºåÁü©ÈòµÊØè‰∏ÄË°åÂ∞±ÊòØ‰∏Ä‰∏™Áä∂ÊÄÅÂêëÈáè $h$„ÄÇ&lt;/p>
&lt;p>Â¶ÇÊûúÁî®ÊâÄÊúâÁä∂ÊÄÅÔºåÂ∞±Ë¶ÅÂä†‰∏Ä‰∏™ &lt;code>flatten&lt;/code> Â±ÇÔºåÂ∞ÜÁä∂ÊÄÅÁü©ÈòµÂèòÊàê‰∏Ä‰∏™ÂêëÈáèÔºåÁÑ∂ÂêéÊääËøô‰∏™ÂêëÈáè‰Ωú‰∏∫ÂàÜÁ±ªÂô®ÁöÑËæìÂÖ•ÔºåÊù•Âà§Êñ≠ÁîµÂΩ±ÊòØÊ≠£Èù¢ÁöÑÔºåËøòÊòØË¥üÈù¢ÁöÑ„ÄÇÂè™Ë¶ÅÊääÁΩëÁªúÁ®ç‰ΩúÊîπÂä®Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">torch&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">flatten&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_dim&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_dim&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="-simple-rnn-ÁöÑÁº∫Èô∑">üß∞ simple RNN ÁöÑÁº∫Èô∑&lt;/h2>
&lt;p>‰∏ãÈù¢Áúã‰∏Ä‰∏ã &lt;code>simple RNN&lt;/code> ËøôÁßçÁÆÄÂçïÁöÑÊ®°ÂûãÊúâ‰ªÄ‰πàÁº∫Èô∑„ÄÇ&lt;/p>
&lt;p>‰∏æ‰∏™Ê†óÂ≠ê üå∞ ÔºåÁé∞Âú®ÊúâËøôÊ†∑‰∏Ä‰∏™ÈóÆÈ¢òÔºåÁªôÂÆöÂçäÂè•ËØùÔºåË¶ÅÊ±ÇÈ¢ÑÊµã‰∏ã‰∏Ä‰∏™ÂçïËØç„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/16.png"
loading="lazy"
alt="16"
>&lt;/p>
&lt;p>ËæìÂÖ•ÊòØ &lt;code>clouds are in the&lt;/code>ÔºåÊ≠£Á°ÆÁöÑËæìÂá∫Â∫îËØ•ÊòØ &lt;code>sky&lt;/code>ÔºåÂ¶ÇÊûúÂú®Â§ßÈáèÊñáÊú¨‰∏≠È¢ÑÊµã RNNÔºåÂ∫îËØ•ÊòØÊúâËÉΩÂäõÂÅöÂá∫ËøôÊ†∑ÁöÑÈ¢ÑÊµãÁöÑ„ÄÇÂú®Ëøô‰∏™‰æãÂ≠êÈáåÔºå&lt;code>RNN&lt;/code> Âè™ÈúÄË¶ÅÁúãÊúÄËøëÁöÑÂá†‰∏™ËØçÔºåÂ∞§ÂÖ∂ÊòØ &lt;code>clouds are&lt;/code>ÔºåÂπ∂‰∏çÈúÄË¶ÅÊõ¥Â§öÁöÑ‰∏ä‰∏ãÊñáÁúãÁöÑÊõ¥Ëøú„ÄÇ&lt;/p>
&lt;p>Ëøô‰∏™‰æãÂ≠êÊòØÂØπ &lt;code>simple RNN&lt;/code> ÂçÅÂàÜÊúâÂà©Ôºå&lt;code>simple RNN&lt;/code> ÁâπÂà´ÊìÖÈïøËøôÁßç &lt;code>short-term dependence&lt;/code>Ôºå&lt;code>simple RNN&lt;/code> ‰∏çÊìÖÈïøÁöÑÊòØ &lt;code>long-term dependence&lt;/code>„ÄÇ&lt;/p>
&lt;p>&lt;code>RNN&lt;/code> ÁöÑÁä∂ÊÄÅ $h$ÔºåÂíå‰πãÂâçÊâÄÊúâÁöÑËæìÂÖ• $x$ ÈÉΩÊúâÂáΩÊï∞‰æùËµñÂÖ≥Á≥ªÔºåÁÖßÁêÜÊù•ËØ¥ÔºåÂ¶ÇÊûúÊîπÂèòËæìÂÖ•ÁöÑÂçïËØç $x_1$ÔºåÊâÄÊúâÁöÑÁä∂ÊÄÅ $h$ ÈÉΩ‰ºöÂèëÁîüÂèòÂåñÔºå‰ΩÜÂÆûÈôÖ‰∏äÔºå&lt;code>simple RNN&lt;/code> Âπ∂Ê≤°ÊúâËøôÁßçÊÄßË¥®ÔºåÊâÄ‰ª•Âæà‰∏çÂêàÁêÜ„ÄÇÂ¶ÇÊûúÊääÁ¨¨ &lt;code>100&lt;/code> ‰∏™Áä∂ÊÄÅÂêëÈáè $h_{100}$ÔºåÂÖ≥‰∫éËæìÂÖ• $x_1$ Ê±ÇÂØºÔºå‰Ω†‰ºöÂèëÁé∞ÂØºÊï∞Âá†‰πéÁ≠â‰∫é &lt;code>0&lt;/code>„ÄÇ&lt;/p>
&lt;p>$\frac{\partial h_{100}}{\partial x_1} \approx 0$&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/17.png"
loading="lazy"
alt="17"
>&lt;/p>
&lt;p>ÂØºÊï∞Âá†‰πéÁ≠â‰∫é &lt;code>0&lt;/code> ËØ¥Êòé‰ªÄ‰πàÂë¢ÔºüËØ¥ÊòéÂΩìÊàë‰ª¨ÊîπÂèò $x_1$Êó∂Ôºå$h_{100}$ Âá†‰πé‰∏ç‰ºöÂèëÁîü‰ªª‰ΩïÂèòÂåñÔºå‰πüÂ∞±ÊòØËØ¥Áä∂ÊÄÅ $h_{100}$ Âíå &lt;code>100&lt;/code> Ê≠•‰πãÂâçÁöÑËæìÂÖ• $x_1$ Âá†‰πéÊ≤°ÊúâÂÖ≥Á≥ªÔºåËøôÊòæÁÑ∂‰∏çÂêàÁêÜÔºåËØ¥ÊòéÁä∂ÊÄÅ $h_{100}$ Âá†‰πéÊääÂæàÂ§öÊ≠•‰πãÂâçÁöÑËæìÂÖ•ÈÉΩÁªôÂøòËÆ∞‰∫ÜÔºå&lt;code>simple RNN&lt;/code> ÁöÑËøôÁßçÈÅóÂøò‰ºöÁªôÂêéÁª≠Êìç‰ΩúÈÄ†ÊàêÂæàÂ§öÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;p>ÂÜç‰∏æ‰∏™Ê†óÂ≠ê üå∞ ÔºåËøôÊòØÂæàÈïøÁöÑ‰∏ÄÊÆµËØùÔºå‰∏ÄÂºÄÂßãÊòØ &lt;code>I grow up in China when I was a child, ... ...&lt;/code> Âà∞‰∫ÜÂæàÂ§öÂè•ËØù‰πãÂêéÔºåÊúâËøôÊ†∑‰∏ÄÂè•Ôºå&lt;code>I speak fluent ...&lt;/code>„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/18.png"
loading="lazy"
alt="18"
>&lt;/p>
&lt;p>‰∏ã‰∏Ä‰∏™ËØçÂ∫îËØ•ÊòØ &lt;code>Chinese&lt;/code>ÔºåÊàëÂ∞èÊó∂ÂÄôÂú®‰∏≠ÂõΩÔºåÊâÄÊúâ‰ºöËØ¥ÊµÅÂà©ÁöÑ‰∏≠ÊñáÔºåÁÑ∂ËÄå &lt;code>simple RNN&lt;/code> ‰∏çÂ§™ÂèØËÉΩ‰ºöÂÅöÂá∫ &lt;code>Chinese&lt;/code> Ëøô‰∏™Ê≠£Á°ÆÁöÑÈ¢ÑÊµãÔºåÂõ†‰∏∫ RNN Â∑≤ÁªèÊääÂâçÊñáÁªôÂøòËÆ∞‰∫Ü„ÄÇ&lt;code>simple RNN&lt;/code> ÊìÖÈïøÁöÑÊòØ &lt;code>short-term dependence&lt;/code>ÔºåRNN ÁúãÂà∞ÊúÄËøëÁöÑÂçïËØçÊòØ &lt;code>speak fluent&lt;/code>ÔºåÊâÄ‰ª• RNN Áü•ÈÅì‰∏ã‰∏Ä‰∏™ÂçïËØçÂèØËÉΩÊòØÊüêÁßçËØ≠Ë®ÄÔºåÂèØËÉΩÊòØ &lt;code>Chinese„ÄÅEnglish„ÄÅFrench„ÄÅJapanese&lt;/code> Á≠âÁ≠âÔºå‰ΩÜÊ≠£Á°ÆÁ≠îÊ°àÊòØ &lt;code>Chinese&lt;/code>ÔºåÂõ†‰∏∫‰∏äÊñáÊúâ &lt;code>I grow up in china when i was child&lt;/code>Ôºåsimple RNN Â∞±ÂÉèÈáëÈ±º‰∏ÄÊ†∑ËÆ∞ÂøÜÂäõÂè™Êúâ &lt;code>7&lt;/code> ÁßíÔºå&lt;code>RNN&lt;/code> Ê†πÊú¨Â∞±‰∏çËÆ∞Âæó‰∏äÊñáÊúâËøôÂè•ËØùÔºåÊâÄ‰ª• &lt;code>I speak fluent ...&lt;/code> È¢ÑÊµãÂçïËØçÂèØËÉΩÊòØ &lt;code>English , French&lt;/code> Á≠â‰ªª‰Ωï‰∏ÄÁßçËØ≠Ë®ÄÔºåÊú™ÂøÖÊòØ &lt;code>Chinese&lt;/code>„ÄÇ&lt;/p>
&lt;h2 id="-ÊÄªÁªì">üéê ÊÄªÁªì&lt;/h2>
&lt;p>ÊúÄÂêéÊÄªÁªì‰∏Ä‰∏ãËøô‰∏ÄËäÇÁöÑÂÜÖÂÆπÔºö&lt;/p>
&lt;p>&lt;code>RNN&lt;/code> ÊòØ‰∏ÄÁßçÁ•ûÁªèÁΩëÁªúÔºå‰ΩÜÊòØ‰ªñÁöÑÁªìÊûÑ‰∏çÂêå‰∫éÂÖ®ËøûÊé•ÁΩëÁªúÂíåÂç∑ÁßØÁΩëÁªúÔºå&lt;code>RNN&lt;/code> ÈÄÇÁî®‰∫éÊñáÊú¨ÔºåËØ≠Èü≥Á≠âÊó∂Â∫èÂ∫èÂàóÊï∞ÊçÆÔºå&lt;code>RNN&lt;/code> ÊåâÁÖßÈ°∫Â∫èËØªÂèñÊØè‰∏Ä‰∏™ËØçÂêëÈáèÔºåÂπ∂‰∏îÂú®Áä∂ÊÄÅÂêëÈáè $h$ ‰∏≠ÁßØÁ¥ØÁúãÂà∞ËøáÂæó‰ø°ÊÅØÔºå$h_0$ ‰∏≠ÂåÖÂê´‰∫Ü $x_0$ ÁöÑ‰ø°ÊÅØÔºå$h_1$ ‰∏≠ÂåÖÂê´‰∫Ü $x_0$ Âíå $x_1$ ÁöÑ‰ø°ÊÅØÔºå$h_t$ ‰∏≠ÁßØÁ¥Ø‰∫Ü‰πãÂâçÊâÄÊúâ $x={x_0, x_1, &amp;hellip;, x_t}$ ÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/03/19.png"
loading="lazy"
alt="19"
>&lt;/p>
&lt;p>Êúâ‰∏ÄÁßçÈîôËØØÁöÑÁúãÊ≥ïÊòØ $h_t$ ‰∏≠Âè™ÂåÖÂê´‰∫Ü $x_t$ ÁöÑ‰ø°ÊÅØÔºåËøôÊòØ‰∏çÂØπÁöÑÔºå$h_t$ ‰∏≠ÂåÖÂê´‰∫Ü‰πãÂâçÊâÄÊúâËæìÂÖ•ÁöÑ‰ø°ÊÅØÔºåÂèØ‰ª•ËÆ§‰∏∫ $h_t$ ‰ª£Ë°®‰∫Ü &lt;code>RNN&lt;/code> ‰ªéÊï¥‰∏™Â∫èÂàó‰∏≠ÊäΩÂèñÁöÑÁâπÂæÅÂêëÈáèÔºåÊâÄÊúâÊàë‰ª¨Âè™ÈúÄË¶Å $h_t$ Â∞±ÂèØ‰ª•Âà§Êñ≠ÁîµÂΩ±ËØÑ‰ª∑ÊòØÊ≠£Èù¢ÁöÑËøòÊòØË¥üÈù¢ÁöÑ„ÄÇ&lt;/p>
&lt;p>&lt;code>simple RNN&lt;/code> Êúâ‰∏Ä‰∏™ÂèÇÊï∞Áü©Èòµ $A$ÔºåÂÆÉÂèØËÉΩËøò‰ºö‰∏Ä‰∏™ &lt;code>intercept&lt;/code> ÂèÇÊï∞ÂêëÈáè $b$Ôºå‰∏äÈù¢ÁöÑ‰ªãÁªç‰∏≠ÂøΩÁï•‰∫ÜËøô‰∏™ÂèÇÊï∞ÂêëÈáè $b$ÔºåËøô‰∏™ÂèÇÊï∞Áü©Èòµ $A$ ÁöÑÁª¥Â∫¶ÊòØÔºö&lt;/p>
&lt;p>$shape(h) * [shape(h) + shape(x)]$&lt;/p>
&lt;p>ÂèÇÊï∞Áü©Èòµ $A$ ‰∏ÄÂºÄÂßãÈöèÊú∫ÂàùÂßãÂåñÔºåÁÑ∂Âêé‰ªéËÆ≠ÁªÉÊï∞ÊçÆ‰∏äÂ≠¶‰π†„ÄÇÊ≥®ÊÑèÔºö&lt;code>simple RNN&lt;/code> Âè™Êúâ‰∏Ä‰∏™ÂèÇÊï∞Áü©ÈòµÔºå‰∏çÁÆ°Ëøô‰∏™Â∫èÂàóÊúâÂ§öÈïøÔºåÂèÇÊï∞Áü©ÈòµÂè™Êúâ‰∏Ä‰∏™ÔºåÊâÄÊúâÊ®°ÂùóÈáåÁöÑÂèÇÊï∞ÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ&lt;/p>
&lt;p>&lt;code>RNN&lt;/code> Êúâ‰∏Ä‰∏™Áº∫ÁÇπÔºå&lt;code>RNN&lt;/code> ÁöÑËÆ∞ÂøÜÊØîËæÉÁü≠Ôºå‰ºöÈÅóÂøòÂæà‰πÖ‰πãÂâçÁöÑËæìÂÖ• $x$ÔºåÂ¶ÇÊûúËøô‰∏™Êó∂Èó¥Â∫èÂàóÂæàÈïøÔºåÊúâÂ•ΩÂá†ÂçÅÊ≠•ÔºåÊúÄÁªà &lt;code>RNN&lt;/code> Â∞±‰ºöÂøòËÆ∞‰∫Ü‰πãÂâçÁöÑËæìÂÖ•„ÄÇ‰∏ã‰∏ÄËäÇÂ∞Ü‰ªãÁªç &lt;code>LSTM&lt;/code>Ôºå&lt;code>LSTM&lt;/code> ÁöÑËÆ∞ÂøÜ‰ºöÊØî &lt;code>simple RNN&lt;/code> ÈïøÂæàÂ§öÔºå‰ΩÜÊòØ &lt;code>RNN&lt;/code> ‰πüËøòÊòØ‰ºöÊúâÈÅóÂøòÁöÑÈóÆÈ¢ò„ÄÇ&lt;/p></description></item><item><title>Êï∞ÊçÆÂ§ÑÁêÜÂü∫Á°Ä</title><link>https://blog.letout.cn/p/nlp-in-action/data-processing/</link><pubDate>Tue, 01 Mar 2022 02:02:02 +0800</pubDate><guid>https://blog.letout.cn/p/nlp-in-action/data-processing/</guid><description>&lt;img src="https://nlp.letout.cn/img/banner.png" alt="Featured image of post Êï∞ÊçÆÂ§ÑÁêÜÂü∫Á°Ä" />&lt;h2 id="-Á±ªÂà´ÁâπÂæÅ">üå± Á±ªÂà´ÁâπÂæÅ&lt;/h2>
&lt;p>Êú∫Âô®Â≠¶‰π†ÁöÑÊï∞ÊçÆÈÄöÂ∏∏Êúâ &lt;strong>Á±ªÂà´ÁâπÂæÅ&lt;/strong> &lt;code>Categorical Features&lt;/code> ÔºåÊàë‰ª¨ÈúÄË¶ÅÊääÁ±ªÂà´ÁâπÂæÅ &lt;code>Categorical Features&lt;/code> ËΩ¨ÂåñÊàêÊú∫Âô®Â≠¶‰π†Ê®°ÂûãËÉΩÁêÜËß£ÁöÑÊï∞ÂÄºÁâπÂæÅÔºå‰∏ãÈù¢‰ΩøÁî®‰∏Ä‰∏™‰æãÂ≠êÊù•ÂÖ∑‰ΩìËÆ≤Ëß£Á±ªÂà´ÁâπÂæÅÊï∞ÊçÆÁöÑÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;p>ËøôÂº†Ë°®ÁöÑÊØè‰∏ÄË°åÊòØ‰∏Ä‰∏™‰∫∫ÁöÑÊï∞ÊçÆÔºåÂåÖÊã¨ÔºöÂπ¥ÈæÑ„ÄÅÊÄßÂà´„ÄÅÂõΩÁ±çÔºåÊàë‰ª¨ÈúÄË¶ÅÊääËøô‰∫õÊï∞ÊçÆÂèòÊàêÊú∫Âô®Â≠¶‰π†Ê®°ÂûãÂèØ‰ª•ÁêÜËß£ÁöÑÊï∞ÂÄºÁâπÂæÅ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/table.png"
loading="lazy"
alt="table"
>&lt;/p>
&lt;p>Ë°®Ê†ºÁöÑÁ¨¨‰∏ÄÂàóÊòØÂπ¥ÈæÑÔºåÂπ¥ÈæÑÊú¨Ë∫´Â∞±ÊòØÊï∞ÂÄºÁâπÂæÅÔºåÊâÄ‰ª•ÂèØ‰ª•‰∏çÁî®ÂÅöÂ§ÑÁêÜÔºåÊï∞ÂÄºÁâπÂæÅÁöÑÁâπÁÇπÊòØÂèØ‰ª•ÊØîËæÉÂ§ßÂ∞èÔºåÊØîÂ¶Ç &lt;code>35&lt;/code> Â≤ÅÁöÑ‰∫∫ÊØî &lt;code>31&lt;/code> Â≤ÅÁöÑÂπ¥ÈæÑÂ§ß„ÄÇ&lt;/p>
&lt;p>Á¨¨‰∫åÂàóÊòØÊÄßÂà´ÔºåÊÄßÂà´ÊòØ‰∫åÂÖÉÁâπÂæÅÔºåÊàë‰ª¨ÂèØ‰ª•Áî®‰∏Ä‰∏™Êï∞Êù•Ë°®Á§∫ÊÄßÂà´„ÄÇÁî® &lt;code>0&lt;/code> Ë°®Á§∫Â•≥ÊÄßÔºåÁî® &lt;code>1&lt;/code> Ë°®Á§∫Áî∑ÊÄß„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÊÄßÂà´Â∞±Ë°®Á§∫‰∏∫‰∏Ä‰∏™Ê†áÈáèÔºö&lt;code>0&lt;/code> / &lt;code>1&lt;/code>„ÄÇ&lt;/p>
&lt;p>Á¨¨‰∏âÂàóÊòØÂõΩÁ±çÔºåÊØîÂ¶Ç‰∏≠ÂõΩÔºåÁæéÂõΩÔºåÂç∞Â∫¶„ÄÇÂõΩÁ±çÊòØÁ±ªÂà´ÁâπÂæÅÔºåÊú∫Âô®Â≠¶‰π†Âπ∂‰∏çÁêÜËß£ÂõΩÁ±çÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÊääÂõΩÁ±çÁºñÁ†ÅÊàêÊï∞ÂÄºÂêëÈáè„ÄÇ‰∏ñÁïå‰∏äÁ∫¶Êúâ &lt;code>197&lt;/code> ‰∏™ÂõΩÂÆ∂ÔºåÊàë‰ª¨ÂÖàÁî®‰∏Ä‰∏™ &lt;code>[1 - 197]&lt;/code> ÁöÑÊï¥Êï∞Ë°®Á§∫‰∏Ä‰∏™ÂõΩÂÆ∂„ÄÇÂèØ‰ª•Âª∫Á´ã‰∏Ä‰∏™Â≠óÂÖ∏ÔºåÊääÂõΩÁ±çÊò†Â∞ÑÊàê‰∏Ä‰∏™ &lt;code>[1 - 197]&lt;/code> ÁöÑÊï¥Êï∞„ÄÇÊØîÂ¶ÇÔºö&lt;code>China:1; US:2; India:3; Japan:4; Germany:5&lt;/code>„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>&lt;strong>Êàë‰ª¨Ë¶Å‰ªé 1 ÂºÄÂßãËÆ°ÁÆóÔºåËÄå‰∏çËÉΩ‰ªé 0 ÂºÄÂßãËÆ°ÁÆó„ÄÇ&lt;/strong>&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>ÂÅöËøôÁßçÊò†Â∞ÑÔºåÂõΩÁ±çÂ∞±Ë°®Á§∫Êàê &lt;code>[1 - 197]&lt;/code> ‰πãÈó¥ÁöÑÊï¥Êï∞„ÄÇ‰ªÖ‰ªÖÊääÂõΩÁ±çË°®Á§∫Êàê &lt;code>[1 - 197]&lt;/code> ÁöÑÊï¥Êï∞ËøòÊòØ‰∏çË°åÔºå‰∏Ä‰∏™Êï¥Êï∞Âè™ÊòØ‰∏ÄÁßçÁ±ªÂà´ÔºåÂÆÉ‰ª¨‰πãÈó¥‰∏çËÉΩÊØîËæÉÂ§ßÂ∞è„ÄÇ&lt;code>US:2; India:3&lt;/code> Ëøô‰∏™Êï∞Â≠óÂπ∂‰∏çË°®Á§∫Âç∞Â∫¶Â§ß‰∫éÁæéÂõΩÔºåËøô‰∫õÊï¥Êï∞Âè™ÊòØÁ±ªÂà´ËÄåÂ∑≤ÔºåÂπ∂‰∏çÊòØÁúüÊ≠£ÁöÑÊï∞ÂÄºÁâπÂæÅ„ÄÇ&lt;/p>
&lt;p>ÊâÄ‰ª•Ë¶ÅËøõ‰∏ÄÊ≠•ÂØπÂõΩÁ±çÂÅö &lt;code>one-hot encoding&lt;/code> ÔºåÁî® &lt;code>one-hot&lt;/code> ÂêëÈáèÊù•Ë°®Á§∫ÂõΩÁ±çÔºö&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">China -&amp;gt; 1 -&amp;gt; [1,0,0,0,...,0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">US -&amp;gt; 2 -&amp;gt; [0,1,0,0,...,0]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÊØîÂ¶ÇÔºå‰∏≠ÂõΩÂØπÂ∫î 1ÔºåÊâÄ‰ª•Áî® 197 Áª¥ÁöÑ &lt;code>one-hot&lt;/code> ÂêëÈáè &lt;code>[1,0,0,0...,0]&lt;/code> Êù•Ë°®Á§∫ÔºåÂÖ∂‰∏≠Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†‰∏∫ 1ÔºåÂÖ∂‰ΩôÂÖÉÁ¥†ÈÉΩÊòØ 0ÔºõÁæéÂõΩÂØπÂ∫î 2ÔºåËøô‰∏™ 197 Áª¥ÁöÑÂêëÈáè &lt;code>[0,1,0,0...,0]&lt;/code> Á¨¨‰∫å‰∏™ÂÖÉÁ¥†ÊòØ 1ÔºåÂÖ∂‰ΩôÂÖÉÁ¥†ÈÉΩÊòØ 0„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÊØè‰∏™ÂõΩÁ±çÂ∞±Áî±‰∏Ä‰∏™ &lt;code>one-hot&lt;/code> ÂêëÈáèË°®Á§∫Ôºå‰∏ÄÂÖ±Êúâ 197 ‰∏™ÂõΩÂÆ∂ÔºåÊâÄ‰ª•ÊØè‰∏™ÂêëÈáèÈÉΩÊòØ 197 Áª¥ÁöÑ„ÄÇ&lt;/p>
&lt;p>&lt;!-- raw HTML omitted -->Êàë‰ª¨Ë¶Å‰ªé 1 ÂºÄÂßãËÆ°ÁÆóÔºåËÄå‰∏çËÉΩ‰ªé 0 ÂºÄÂßãËÆ°ÁÆó„ÄÇ&lt;!-- raw HTML omitted -->
Âõ†‰∏∫Êàë‰ª¨Ë¶ÅÊää 0 ‰øùÁïôÔºåÁî®Êù•Ë°®Á§∫Êú™Áü•ÊàñËÄÖÁº∫Â§±ÁöÑÂõΩÁ±ç„ÄÇÊï∞ÊçÆÂ∫ìÈáåÈù¢ÁªèÂ∏∏‰ºöÊúâÁº∫Â§±ÁöÑÊï∞ÊçÆÔºàÊØîÂ¶ÇÁî®Êà∑Ê≤°ÊúâÂ°´ÂÜôÂõΩÁ±çÔºâÔºåËøôÊ†∑Áº∫Â§±ÁöÑÂõΩÁ±çÂ∞±Áî® 0 Êù•Ë°®Á§∫ÔºåÂÆÉÁöÑ &lt;code>one-hot&lt;/code> ÂêëÈáèÂ∞±ÊòØ‰∏Ä‰∏™ÂÖ® 0 ÁöÑÂêëÈáè&lt;code>[0,0,0,0...,0]&lt;/code>„ÄÇ&lt;/p>
&lt;p>‰∏ãÈù¢Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÊàë‰ª¨Áî®‰∏Ä‰∏™ 199 Áª¥Ë°®Á§∫‰∏Ä‰∏™‰∫∫ÁöÑÁâπÂæÅ„ÄÇÊØîÂ¶ÇËøô‰∏™‰∫∫ 28 Â≤ÅÔºåÂ•≥ÊÄßÔºåÂõΩÁ±çÊòØ‰∏≠ÂõΩ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/1.png"
loading="lazy"
alt="1"
>&lt;/p>
&lt;p>ÂÖ∂‰∏≠Ôºå‰∏Ä‰∏™Áª¥Â∫¶Ë°®Á§∫Âπ¥ÈæÑÔºå‰∏Ä‰∏™Áª¥Â∫¶Ë°®Á§∫ÊÄßÂà´Ôºå‰∏Ä‰∏™ 197 Áª¥ÁöÑ &lt;code>one-hot&lt;/code> ÂêëÈáèË°®Á§∫ÂõΩÁ±ç„ÄÇ&lt;/p>
&lt;p>Ëøô‰∏™‰æãÂ≠êÈáåÔºåËøô‰∏™ 36 Â≤ÅÔºåÁî∑ÊÄßÔºåÂõΩÁ±çÊú™Áü•ÁöÑ‰∫∫ÁöÑÁâπÂæÅÊòØËøô‰∏™ 199 Áª¥ÁöÑÂêëÈáèÔºåÊàë‰ª¨Áî®‰∏Ä‰∏™ 197 Áª¥ÁöÑÂÖ® 0 ÂêëÈáèË°®Á§∫Êú™Áü•ÂõΩÁ±ç„ÄÇ&lt;/p>
&lt;h2 id="-‰∏∫‰ªÄ‰πàË¶ÅÁî®-one-hot-ÂêëÈáèË°®Á§∫ÁâπÂæÅ">üîñ ‰∏∫‰ªÄ‰πàË¶ÅÁî® one-hot ÂêëÈáèË°®Á§∫ÁâπÂæÅ&lt;/h2>
&lt;p>Âú®Â§ÑÁêÜÁ±ªÂà´ÁâπÂæÅÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰ΩøÁî® &lt;code>one-hot&lt;/code> ÂêëÈáèË°®Á§∫ÂõΩÁ±çÔºåÊØè‰∏™ÂõΩÁ±çÈÉΩÁî® 197 Áª¥ÁöÑÂêëÈáèË°®Á§∫„ÄÇ‰∏∫‰ªÄ‰πàË¶ÅÁî® &lt;code>one-hot&lt;/code> ÂêëÈáèËÄå‰∏çÁî®‰∏Ä‰∏™Êï∞Â≠óË°®Á§∫Âë¢ÔºüÊØîÂ¶ÇÁî® 1 Ë°®Á§∫‰∏≠ÂõΩÔºå2 Ë°®Á§∫ÁæéÂõΩÔºå3 Ë°®Á§∫Âç∞Â∫¶„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÂêçÂ≠óÂ∞±ÂèòÊàê‰∫ÜÊï∞Â≠óÔºåÂèØ‰ª•ÂÅöÊï∞ÂÄºËÆ°ÁÆóÔºåËÄå‰∏îÁî®‰∏Ä‰∏™Êï∞Â≠óË°®Á§∫ÁöÑËØùÔºåÂèØ‰ª•ËäÇÁúÅ 197 ÂÄçÁöÑÂ≠òÂÇ®Á©∫Èó¥„ÄÇÂΩìÁÑ∂ËøôÊòØ‰∏çË°åÁöÑ„ÄÇÂê¶ÂàôÊàë‰ª¨Â∞±‰∏çÈúÄË¶Å &lt;code>one-hot encoding&lt;/code> ‰∫Ü„ÄÇ&lt;/p>
&lt;p>ÂÅáËÆæÊàë‰ª¨‰ΩøÁî® &lt;code>1 -&amp;gt; China; 2 -&amp;gt; US; 3 -&amp;gt; India&lt;/code>„ÄÇÈÇ£‰πàÂ∞Ü‰∏≠ÂõΩ &lt;code>1&lt;/code> ÂíåÁæéÂõΩ &lt;code>2&lt;/code> ÁöÑÁâπÂæÅÂä†Ëµ∑Êù•Ôºö&lt;code>1+2=3&lt;/code> ÔºåÁõ∏ÂΩì‰∫é ‚Äú‰∏≠ÂõΩ + ÁæéÂõΩ = Âç∞Â∫¶‚Äù„ÄÇËøôÊ†∑ÁöÑÁâπÂæÅÂÆåÂÖ®‰∏çÂêàÁêÜ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/2.png"
loading="lazy"
alt="2"
>&lt;/p>
&lt;p>‰ΩøÁî® &lt;code>one-hot&lt;/code> ÁâπÂæÅÂêëÈáèÊõ¥ÂêàÁêÜ„ÄÇÂ∞Ü China Âíå US ÁöÑ &lt;code>one-hot&lt;/code> ÂêëÈáèÂä†Ëµ∑Êù•ÔºåÂæóÂà∞ &lt;code>[1,1,0,0,...,0]&lt;/code>ÔºåÁ¨¨‰∏Ä‰∏™ÂíåÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÈÉΩÊòØ 1ÔºåÂÖ∂‰ΩôÂÖÉÁ¥†ÈÉΩÊòØ 0ÔºåËøô‰∏™ÁâπÂæÅÂêëÈáèÁöÑËß£ÈáäÊòØÔºöÊó¢Êúâ‰∏≠ÂõΩÂõΩÁ±çÔºåÂèàÊúâÁæéÂõΩÂõΩÁ±ç„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/3.png"
loading="lazy"
alt="3"
>&lt;/p>
&lt;p>ÊâÄ‰ª•ÂÅöÊú∫Âô®Â≠¶‰π†ÁöÑÊó∂ÂÄôÔºå‰∏çËÉΩÁî®‰∏Ä‰∏™Ê†áÈáèÊù•Ë°®Á§∫‰∏Ä‰∏™Á±ªÂà´ÁâπÂæÅÔºåËøôÁßçÁâπÂæÅÂÅöÊ≥ïÊ±ÇÂíåÁ≠âÊï∞ÂÄºËÆ°ÁÆóÊòØÊ≤°ÊúâÊÑè‰πâÁöÑ„ÄÇÊ≠£Á°ÆÁöÑÂÅöÊ≥ïÊòØ‰ΩøÁî® &lt;code>one-hot&lt;/code> ÂêëÈáèÊù•Ë°®Á§∫Á±ªÂà´ÁâπÂæÅ„ÄÇ&lt;/p>
&lt;h2 id="-Â§ÑÁêÜÊñáÊú¨Êï∞ÊçÆÁöÑÊµÅÁ®ã">üöÄ Â§ÑÁêÜÊñáÊú¨Êï∞ÊçÆÁöÑÊµÅÁ®ã&lt;/h2>
&lt;p>Âú®Ëá™ÁÑ∂ËØ≠Ë®ÄÂ§ÑÁêÜÁöÑÂ∫îÁî®‰∏≠ÔºåÊï∞ÊçÆÂ∞±ÊòØÊñáÊú¨ &lt;code>document&lt;/code>ÔºåÊñáÊú¨ÂèØ‰ª•ÂàÜÂâ≤ÊàêÂæàÂ§öÂçïËØçÔºåÊàë‰ª¨ÈúÄË¶ÅÊääÂçïËØçË°®Á§∫ÊàêÊï∞ÂÄºÂêëÈáè„ÄÇÂÖ∂‰∏≠ÊØè‰∏™ÂçïËØçÈÉΩÊòØ‰∏Ä‰∏™Á±ªÂà´ÔºåÂ¶ÇÊûúÂ≠óÂÖ∏ÈáåÊúâ‰∏Ä‰∏á‰∏™ÂçïËØçÔºåÈÇ£‰πàÂ∞±Êúâ‰∏Ä‰∏áÁöÑÁ±ªÂà´ÔºåÊòæÁÑ∂ÂçïËØçÂ∞±ÊòØÁ±ªÂà´ÁâπÂæÅ„ÄÇÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®Â§ÑÁêÜÁ±ªÂà´ÁâπÂæÅÁöÑÊñπÊ≥ïÔºåÊääÂçïËØçÂèòÊàêÊï∞ÂÄºÂêëÈáè„ÄÇ&lt;/p>
&lt;p>ÊñáÊú¨Â§ÑÁêÜ‰∏ªË¶ÅÂàÜ‰∏∫‰∏â‰∏™Ê≠•È™§Ôºö&lt;/p>
&lt;ul>
&lt;li>üîî ÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂçïËØç&lt;/li>
&lt;li>üîî ËÆ°ÁÆóÊØè‰∏™ÂçïËØçÂá∫Áé∞ÁöÑÊ¨°Êï∞&lt;/li>
&lt;li>üîî ËøõË°å one-hot ÁºñÁ†Å&lt;/li>
&lt;/ul>
&lt;p>ÊñáÊú¨Â§ÑÁêÜÁöÑÁ¨¨‰∏ÄÊ≠•ÊòØÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂçïËØç„ÄÇ‰∏ÄÊÆµËØùÔºå‰∏ÄÁØáÊñáÁ´†ÊàñËÄÖ‰∏ÄÊú¨‰π¶ÂèØ‰ª•Ë°®Á§∫‰∏∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂèØ‰ª•ÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂæàÂ§öÂçïËØçÔºåËøô‰∏™Ê≠•È™§Áß∞‰∏∫ &lt;code>Tokenization&lt;/code>„ÄÇ&lt;/p>
&lt;p>ÊØîÂ¶ÇËØ¥ËøôÂè•ËØù &lt;code>... to be or not to be ...&lt;/code>Ôºå ÂèØ‰ª•ÂàÜÂâ≤ÊàêËøô‰∫õÂçïËØç &lt;code>[to, be, or, not, to, be]&lt;/code>„ÄÇTokenization Â∞±ÊòØÊääÊñáÊú¨ÂèòÊàêÂçïËØçÁöÑÂàóË°®„ÄÇ&lt;/p>
&lt;p>ÊñáÊú¨Â§ÑÁêÜÁöÑÁ¨¨‰∫åÊ≠•ÊòØËÆ°ÁÆóËØçÈ¢ëÔºå‰πüÂ∞±ÊòØÊØè‰∏™ÂçïËØçÂá∫Áé∞ÁöÑÊ¨°Êï∞„ÄÇÊàë‰ª¨ÂèØ‰ª•Áî®‰∏Ä‰∏™ÂìàÂ∏åË°® &lt;code>hash Map&lt;/code> Êù•ËÆ°ÁÆóÔºåËÆ°ÁÆóÂºÄÂßã‰πãÂâçÔºåÂìàÂ∏åË°®ÊòØÁ©∫ÁöÑÔºåÊàë‰ª¨Ê†πÊçÆ‰ª•‰∏ãÊñπÂºèÊõ¥Êñ∞ÂìàÂ∏åË°®ÔºöÂ¶ÇÊûúÂçïËØç &lt;code>w&lt;/code> ‰∏çÂú®Ë°®ÈáåÈù¢ÔºåËØ¥ÊòéÂà∞ÁõÆÂâç‰∏∫Ê≠¢Ôºå&lt;code>w&lt;/code> ËøòÊ≤°ÊúâÂá∫Áé∞Âú®ÊñáÊú¨ÈáåÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÊää &lt;code>w&lt;/code> Âä†ÂÖ•ÂìàÂ∏åË°®ÔºåÂπ∂ËÆ©ÂÆÉÁöÑËØçÈ¢ëÁ≠â‰∫é 1ÔºõÂ¶ÇÊûú &lt;code>w&lt;/code> Âú®ÂìàÂ∏åË°®ÈáåÈù¢ÔºåËØ¥Êòé &lt;code>w&lt;/code> ‰πãÂâçÂú®ÊñáÊú¨ÈáåÂá∫Áé∞ËøáÔºåÂè™ÈúÄË¶ÅÊää &lt;code>w&lt;/code> ÁöÑËØçÈ¢ëÂä† 1 Âç≥ÂèØ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/4.png"
loading="lazy"
alt="4"
>&lt;/p>
&lt;p>Êé•‰∏ãÊù•‰∏æ‰∏™‰æãÂ≠êÔºåÊàë‰ª¨Â∞ÜÊå®‰∏™Â§ÑÁêÜËøô‰∏™ÂàóË°®ÈáåÁöÑÂçïËØç„ÄÇÂΩìÂ§ÑÁêÜÂà∞ÂçïËØç &lt;code>to&lt;/code> ÁöÑÊó∂ÂÄôÔºåÈ¶ñÂÖàÊü•‰∏Ä‰∏ãÂìàÂ∏åË°®ÔºåÂèëÁé∞ÂìàÂ∏åË°®ÈáåÈù¢Êúâ &lt;code>to&lt;/code>ÔºåÂÆÉÁöÑËØçÈ¢ëÊòØ 398ÔºåËØ¥Êòé to Âú®ÊñáÁ´†ÈáåÂ∑≤ÁªèÂá∫Áé∞Ëøá 398 Ê¨°‰∫ÜÔºåÁé∞Âú®Ëøô‰∏™ÂçïËØçÂèàÂá∫Áé∞‰∫Ü‰∏ÄÊ¨°Ôºå‰∫éÊòØÊääË°®ÈáåÁöÑËØçÈ¢ëÂä† 1ÔºåÂèòÊàê‰∫Ü 399ÔºõÂΩìÂ§ÑÁêÜÂà∞ÂçïËØç &lt;code>or&lt;/code>ÁöÑÊó∂ÂÄôÔºåÂú®Ë°®ÈáåÊâæ‰∏çÂà∞ÔºåËøôËØ¥ÊòéÊñáÁ´†ÈáåËøòÊ≤°ÊúâÂá∫Áé∞Ëøá &lt;code>or&lt;/code> Ëøô‰∏™ÂçïËØçÔºåÁ¨¨‰∏ÄÊ¨°Âá∫Áé∞Âú®ÊñáÁ´†ÈáåÔºå‰∫éÊòØÊàë‰ª¨Êää &lt;code>or&lt;/code> ÊèíÂÖ•Ë°®ÈáåÔºåÂ∞ÜËØçÈ¢ëËÆæÁΩÆ‰∏∫ 1„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/5.png"
loading="lazy"
alt="5"
>&lt;/p>
&lt;p>ÂÆåÊàêÁªüËÆ°ËØçÈ¢ë‰πãÂêéÔºåÈúÄË¶ÅÊääÂìàÂ∏åË°®ÂÅö‰∏Ä‰∏™ÊéíÂ∫èÔºåÊåâÁÖßËØçÈ¢ëÈÄíÂáèÁöÑÈ°∫Â∫èËøõË°åÊéíÂàóÔºåË°®ÁöÑÊúÄÂâçÈù¢ÊòØËØçÈ¢ëÊúÄÈ´òÁöÑÔºåË°®ÊúÄÂêéÊòØËØçÈ¢ëÊúÄ‰ΩéÁöÑ„ÄÇÁÑ∂ÂêéÂ∞±ÊääËØçÈ¢ëÊç¢Êàê‰∏ãÊ†á &lt;code>index&lt;/code>Ôºå‰ªé 1 ÂºÄÂßãÊï∞ËÆ°Êï∞ÔºåËØçÈ¢ëÊúÄÈ´òÁöÑËØçÁöÑ &lt;code>index&lt;/code> ÊòØ 1„ÄÇËøô‰∏™‰æãÂ≠êÈáåÔºå‰∏ÄÂÖ±Êúâ 8 ‰∏™ÂçïËØçÔºåÊØè‰∏™ËØçÂØπÂ∫î‰∏Ä‰∏™ [1, 8] ‰πãÈó¥ÁöÑÊ≠£Êï¥Êï∞„ÄÇËøô‰∏™Ë°®Áß∞‰∏∫Â≠óÂÖ∏ ÔºåÂèØ‰ª•ÊääÂçïËØçÊò†Â∞Ñ‰∏∫‰∏Ä‰∏™Êï∞Â≠ó„ÄÇ&lt;/p>
&lt;p>Â≠óÂÖ∏ÈáåÂçïËØçÁöÑ‰∏™Êï∞Áß∞‰∏∫ËØçÊ±áÈáè &lt;code>vocabulary&lt;/code>„ÄÇËøô‰æãÂ≠êÈáåËØçÊ±áÈáèÁ≠â‰∫é 8„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/6.png"
loading="lazy"
alt="6"
>&lt;/p>
&lt;p>Ëã±ËØ≠ÈáåÂ§ßÊ¶ÇÊúâ 1 ‰∏á‰∏™Â∏∏Áî®ËØçÔºå‰ΩÜÊòØÁªüËÆ°ËØçÈ¢ë‰πãÂêéÔºå‰Ω†‰ºöÂèëÁé∞Â≠óÂÖ∏‰ºöÊúâÂá†ÂçÅ‰∏áÁîöËá≥‰∏äÁôæ‰∏á‰∏™ÂçïËØç„ÄÇÁªüËÆ°ËØçÈ¢ëÁöÑÁõÆÁöÑÂ∞±ÊòØ‰øùÁïôÂ∏∏Áî®ËØçÔºåÂéªÊéâ‰ΩéÈ¢ëËØç„ÄÇÊØîÂ¶ÇÔºåÊàë‰ª¨ÂèØ‰ª•‰øùÁïôËØçÈ¢ëÊúÄÈ´òÁöÑ 1 ‰∏á‰∏™ÂçïËØçÔºåÂà†ÊéâÂÖ∂‰ΩôÂçïËØç„ÄÇ&lt;/p>
&lt;p>&lt;strong>‰∏∫‰ªÄ‰πàË¶ÅÂà†Êéâ‰ΩéÈ¢ëËØçÂë¢Ôºü&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>üå∞ ‰ΩéÈ¢ëËØçÈÄöÂ∏∏Ê≤°ÊúâÊÑè‰πâ&lt;/li>
&lt;/ul>
&lt;p>ÂæàÂ§ö‰ΩéÈ¢ëËØçÈÉΩÊòØÂêçÂ≠óÂÆû‰Ωì &lt;code>name entities&lt;/code>ÔºåÊØîÂ¶ÇÊàë‰ª¨ÁöÑÂêçÂ≠óÂ∞±ÊòØ‰∏™ÂêçÂ≠óÂÆû‰ΩìÔºåÂÅáÂ¶ÇÊàë‰ª¨ÁöÑÂêçÂ≠óÂá∫Áé∞Âú®‰∏Ä‰∏™Êï∞ÊçÆÈõÜÈáåÈù¢Ôºå‰ªñÁöÑÈ¢ëÁéáËÇØÂÆö‰ºöÂæà‰ΩéÔºåÂú®Â§ßÂ§öÊï∞ÁöÑÂ∫îÁî®ÈáåÂêçÂ≠óÂÆû‰ΩìÊ≤°ÊúâÊÑè‰πâ„ÄÇ&lt;/p>
&lt;p>‰ΩéÈ¢ëËØçÂæàÂ§öÈÉΩÊòØÊãºÂÜôÈîôËØØÈÄ†ÊàêÁöÑÔºåÂ¶ÇÊûúÊää prince ÁöÑ c ËØØÂÜôÊàê sÔºåprinseÔºåÈÇ£‰πàÂ∞±ÂàõÈÄ†‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂçïËØçÔºåËøôÁßçËØçÁöÑÈ¢ëÁéá‰πüÂæà‰ΩéÔºåÂú®ÂæàÂ§öÂ∫îÁî®ÈáåÔºåÂéªÊéâËøôÁßçËØçÊ≤°ÊúâÂç±ÂÆ≥„ÄÇ&lt;/p>
&lt;ul>
&lt;li>üå∞ ÂéªÊéâ‰ΩéÈ¢ëËØçÁöÑÂè¶‰∏Ä‰∏™ÂéüÂõ†ÊòØÊàë‰ª¨‰∏çÂ∏åÊúõ &lt;code>vocabulary&lt;/code> Â§™Â§ß„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>‰∏ã‰∏Ä‰∏™Ê≠•È™§ÂÅö &lt;code>one-hot encoding&lt;/code> ÁöÑÊó∂ÂÄôÔºåÂêëÈáèÁöÑÁª¥Â∫¶Â∞±ÊòØÂ≠óÂÖ∏ÁöÑÂ§ßÂ∞è„ÄÇÂ≠óÂÖ∏Ë∂äÂ§ßÔºåÂêëÈáèÁöÑÁª¥Â∫¶Â∞±Ë∂äÈ´òÔºåËøô‰ºöËÆ©ËÆ°ÁÆóÂèòÊÖ¢„ÄÇ‰∏ã‰∏ÄËäÇËØ¶ÁªÜËØ¥ÊòéËØçÂµåÂÖ• &lt;code>Word Embedding&lt;/code> ÁöÑÊó∂ÂÄôÂ∞±‰ºöÁúãÂà∞ÔºåÂ≠óÂÖ∏Ë∂äÂ§ßÔºåÊ®°ÂûãÁöÑÂèÇÊï∞Â∞±Ë∂ä‰ºöË∂äÂ§öÔºåÂ∞±‰ºöÂÆπÊòìÈÄ†ÊàêËøáÊãüÂêà &lt;code>overfitting&lt;/code>ÔºåÂà†Êéâ‰ΩéÈ¢ëËØçÂ∞±‰ºöÂ§ßÂπÖÂáèÂ∞è &lt;code>vocabulary&lt;/code>„ÄÇ&lt;/p>
&lt;p>ÊñáÊú¨Â§ÑÁêÜÁöÑÁ¨¨‰∏âÊ≠•Â∞±ÊòØÂØπÂçïËØçÂÅö &lt;code>one-hot encoding&lt;/code>ÔºåÈÄöËøáÊü•Â≠óÂÖ∏ÔºåÊääÂçïËØçÊò†Â∞ÑÊàê‰∏Ä‰∏™Ê≠£Êï¥Êï∞Ôºå‰∏Ä‰∏™ÂçïËØçÁöÑÂàóË°®Â∞±Êò†Â∞ÑÊàê‰∫Ü‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÁöÑÂàóË°®ÔºõÂ¶ÇÊûúÊúâÂøÖË¶ÅÂ∞±ÁªßÁª≠ÊääËøô‰∫õÊ≠£Êï¥Êï∞ÂèòÊàê &lt;code>one-hot&lt;/code> ÂêëÈáè„ÄÇËøô‰∫õ &lt;code>one-hot&lt;/code> ÂêëÈáèÁöÑÁª¥Â∫¶Ê≠£Â•ΩÁ≠â‰∫é &lt;code>vocabulary&lt;/code>ÔºåÂú®Ëøô‰∏™‰æãÂ≠êÈáåÈù¢ÔºåÂ≠óÂÖ∏ÁöÑÈïøÂ∫¶ÊòØ 8ÔºåÊâÄ‰ª• &lt;code>one-hot&lt;/code> Áª¥Â∫¶Â∞±Á≠â‰∫é 8„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://nlp.letout.cn/img/nlp/01/7.png"
loading="lazy"
alt="7"
>&lt;/p>
&lt;p>‰∏äÈù¢ËØ¥ËøáÔºåÂ≠óÂÖ∏ÈáåÁöÑ‰ΩéÈ¢ëËØçÂèØËÉΩ‰ºöË¢´Âà†ÊéâÔºåÊâÄ‰ª•Êúâ‰∫õËØçÂú®Â≠óÂÖ∏ÈáåÊâæ‰∏çÂà∞Ôºå‰æãÂ¶ÇÊää be ÈîôËØØÊãºÂÜôÊàêÂçïËØç biÔºåËøô‰∏™ËØçÂú®Â≠óÂÖ∏ÈáåÊâæ‰∏çÂà∞Ôºå&lt;code>one-hot encoding&lt;/code> Êó∂ÔºåÂèØ‰ª•ÂøΩÁï•Ëøô‰∏™ËØçÔºå‰πüÂèØ‰ª•ÊääÂÆÉÁºñÁ†ÅÊàêÂÖ® 0 ÂêëÈáè„ÄÇ&lt;/p>
&lt;h2 id="-ÊÄªÁªì">üéê ÊÄªÁªì&lt;/h2>
&lt;p>ÊúÄÂêéÊÄªÁªì‰∏Ä‰∏ãËøô‰∏ÄËäÇÁöÑÂÜÖÂÆπ„ÄÇ&lt;/p>
&lt;p>ÈÉ®ÂàÜÊú∫Âô®Â≠¶‰π†ÁöÑÊï∞ÊçÆ‰ºöÂÖ∑Â§áÁ±ªÂà´ÁâπÂæÅ &lt;code>Categorical Features&lt;/code>ÔºåÊú∫Âô®Â≠¶‰π†Ê®°ÂûãÊó†Ê≥ïÁêÜËß£ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂ËΩ¨Êç¢ÊàêÊï∞ÂÄºÁâπÂæÅ„ÄÇÁ±ªÂà´ÁâπÂæÅÁöÑÁ±ªÂà´‰ºöË¢´Êò†Â∞ÑÊàê‰∏Ä‰∏™‰ªé &lt;code>1&lt;/code> ÂºÄÂßãËÆ°ÁÆóÁöÑÊï¥Êï∞Ôºå&lt;code>0&lt;/code> Ë¢´Áî®Êù•Ë°®Á§∫Áº∫Â§±ÊàñËÄÖÊú™Áü•ÁöÑÁ±ªÂà´ÔºåÂπ∂‰∏î‰ΩøÁî® &lt;code>one-hot&lt;/code> ÂêëÈáèÔºåËÉΩÂæàÂ•ΩÁöÑË°®Á§∫Á±ªÂà´ÁâπÂæÅÁöÑÊÑè‰πâ„ÄÇ&lt;/p>
&lt;p>ÊñáÊú¨Â§ÑÁêÜ‰∏ªË¶ÅÊúâ‰∏â‰∏™Ê≠•È™§ÔºåÁ¨¨‰∏ÄÊ≠• &lt;code>tokenization&lt;/code> ÊääÊñáÊú¨ÂàÜÂâ≤ÊàêÂçïËØçÁöÑÂàóË°®ÔºõÁ¨¨‰∫åÊ≠•Âª∫Á´ã‰∫Ü‰∏Ä‰∏™Â≠óÂÖ∏&lt;code>vocabulary&lt;/code>ÔºåÊääÂçïËØçÊò†Â∞ÑÊàê‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÔºõÁ¨¨‰∏âÊ≠•ËøõË°å &lt;code>one-hot encoding&lt;/code>ÔºåÂ∞ÜÂàÜÂâ≤ÂêéÁöÑÂçïËØçÂàóË°®Êò†Â∞ÑÊàêÊ≠£Êï¥Êï∞ÁöÑÂàóË°®ÊàñÂèòÊàê &lt;code>one-hot&lt;/code> ÂêëÈáè„ÄÇ&lt;/p></description></item></channel></rss>